<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Migueloo-cvs] migueloo/modules/filemanager/model/classes miguel_mfilemanager.class.php,1.2,1.3
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/migueloo-cvs/2004-August/index.html" >
   <LINK REL="made" HREF="mailto:migueloo-cvs%40lists.berlios.de?Subject=Re%3A%20%5BMigueloo-cvs%5D%20migueloo/modules/filemanager/model/classes%20miguel_mfilemanager.class.php%2C1.2%2C1.3&In-Reply-To=%3C200408131804.i7DI4u611621%40bat.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000007.html">
   <LINK REL="Next"  HREF="000009.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Migueloo-cvs] migueloo/modules/filemanager/model/classes miguel_mfilemanager.class.php,1.2,1.3</H1>
    <B>antoniofcano</B> 
    <A HREF="mailto:migueloo-cvs%40lists.berlios.de?Subject=Re%3A%20%5BMigueloo-cvs%5D%20migueloo/modules/filemanager/model/classes%20miguel_mfilemanager.class.php%2C1.2%2C1.3&In-Reply-To=%3C200408131804.i7DI4u611621%40bat.berlios.de%3E"
       TITLE="[Migueloo-cvs] migueloo/modules/filemanager/model/classes miguel_mfilemanager.class.php,1.2,1.3">nobody at sheep.berlios.de
       </A><BR>
    <I>Fri Aug 13 20:04:56 CEST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000007.html">[Migueloo-cvs] migueloo/modules/admin/view/classes miguel_vadmin.class.php,1.3,1.4
</A></li>
        <LI>Next message: <A HREF="000009.html">[Migueloo-cvs] migueloo/modules/filemanager/control/classes miguel_cfilemanager.class.php,1.2,1.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11">[ date ]</a>
              <a href="thread.html#11">[ thread ]</a>
              <a href="subject.html#11">[ subject ]</a>
              <a href="author.html#11">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Update of /cvsroot/migueloo/migueloo/modules/filemanager/model/classes
In directory sheep:/tmp/cvs-serv21897/model/classes

Modified Files:
	miguel_mfilemanager.class.php 
Log Message:
Improved view restriction (visibility, lock, ...) tests


Index: miguel_mfilemanager.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/filemanager/model/classes/miguel_mfilemanager.class.php,v
retrieving revision 1.2
retrieving revision 1.3
diff -C2 -d -r1.2 -r1.3
*** miguel_mfilemanager.class.php	12 Aug 2004 11:33:55 -0000	1.2
--- miguel_mfilemanager.class.php	13 Aug 2004 18:04:54 -0000	1.3
***************
*** 22,26 ****
        |   the world-wide-web at <A HREF="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</A>         |
        +----------------------------------------------------------------------+
!       | Authors: Antonio F. Cano Damas &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/migueloo-cvs">antoniofcano at telefonica.net</A>&gt;         |
        |          miguel Development Team                                     |
        |                       &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/migueloo-cvs">e-learning-desarrollo at listas.hispalinux.es</A>&gt;   |
--- 22,26 ----
        |   the world-wide-web at <A HREF="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</A>         |
        +----------------------------------------------------------------------+
!       | Authors: Antonio F. Cano Damas &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/migueloo-cvs">antonio at igestec.com</A>&gt;                 |
        |          miguel Development Team                                     |
        |                       &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/migueloo-cvs">e-learning-desarrollo at listas.hispalinux.es</A>&gt;   |
***************
*** 30,34 ****
   * Define la clase base de miguel.
   *
!  * @author Antonio F. Cano Damas &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/migueloo-cvs">antoniofcano at telefonica.net</A>&gt;
   * @author miguel development team &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/migueloo-cvs">e-learning-desarrollo at listas.hispalinux.es</A>&gt;
   * @package miguel base
--- 30,34 ----
   * Define la clase base de miguel.
   *
!  * @author Antonio F. Cano Damas &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/migueloo-cvs">antonio at igestec.com</A>&gt;
   * @author miguel development team &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/migueloo-cvs">e-learning-desarrollo at listas.hispalinux.es</A>&gt;
   * @package miguel base
***************
*** 59,62 ****
--- 59,63 ----
                                    'document_date' =&gt; $document[$i]['fm_document.date_publish'],
                                    'document_autor' =&gt; $this-&gt;_getNameFromUser($document[$i]['fm_document.user_id']),
+                                   'document_user_id' =&gt; $document[$i]['fm_document.user_id'],
                                    'document_visible' =&gt; $document[$i]['fm_document.document_visible'],
                                    'document_lock' =&gt; $document[$i]['fm_document.document_lock'],
***************
*** 111,114 ****
--- 112,116 ----
                                    'folder_count_element' =&gt; $fileCount + $currentFolderCount,
                                    'folder_autor' =&gt; $this-&gt;_getNameFromUser($folder[$i]['fm_folder.user_id']),
+                                   'folder_user_id' =&gt; $folder[$i]['fm_folder.user_id'],
                                    'folder_visible' =&gt; $folder[$i]['fm_folder.folder_visible']
                                  );
***************
*** 118,121 ****
--- 120,139 ----
      }
  
+     function getFolderTree( $current_course, $current_folder_id = 0 )
+     {
+         $folderList = $this-&gt;getFolderList($current_course, $current_folder_id);
+ 
+         // recursive operation if subdirectories exist
+         $folderCount = sizeof($folderList);
+         if ( $folderCount &gt; 0 ) {
+             for ($i = 0 ; $i &lt; $folderCount ; $i++ ) {
+ //                $subFolderList = $this-&gt;getFolderTree( $current_course, $folderList[$i]['folder_id'] ) ;             // function recursivity
+ //                $folderList  =  array_merge( $folderList , $subFolderList ) ; // data merge
+                   Debug::oneVar( $folderList[$i]['folder_id'] );
+             }
+         }
+         return $folderList;
+     }
+ 
      //Maqueta
      function getFolderId( $course_id )
***************
*** 177,181 ****
          $documentID = $this-&gt;Insert('fm_document',
                                   'document_mime, document_name, user_id, document_size, date_publish, document_visible, document_lock, document_share',
!                                  &quot;$document_mime, $document_name, $user_id, $size, $now,0,0,0&quot;);
  
          if ($this-&gt;hasError()) {
--- 195,199 ----
          $documentID = $this-&gt;Insert('fm_document',
                                   'document_mime, document_name, user_id, document_size, date_publish, document_visible, document_lock, document_share',
!                                  &quot;$document_mime, $document_name, $user_id, $size, $now,0,1,0&quot;);
  
          if ($this-&gt;hasError()) {


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000007.html">[Migueloo-cvs] migueloo/modules/admin/view/classes miguel_vadmin.class.php,1.3,1.4
</A></li>
	<LI>Next message: <A HREF="000009.html">[Migueloo-cvs] migueloo/modules/filemanager/control/classes miguel_cfilemanager.class.php,1.2,1.3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11">[ date ]</a>
              <a href="thread.html#11">[ thread ]</a>
              <a href="subject.html#11">[ subject ]</a>
              <a href="author.html#11">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/migueloo-cvs">More information about the Migueloo-cvs
mailing list</a><br>
</body></html>
