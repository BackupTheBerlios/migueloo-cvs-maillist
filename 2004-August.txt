From nobody at sheep.berlios.de  Thu Aug 12 13:33:57 2004
From: nobody at sheep.berlios.de (antoniofcano)
Date: Thu, 12 Aug 2004 13:33:57 +0200
Subject: [Migueloo-cvs] migueloo/modules/filemanager/model/classes miguel_mfilemanager.class.php,1.1,1.2
Message-ID: <200408121133.i7CBXv630962@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/filemanager/model/classes
In directory sheep:/tmp/cvs-serv27819/model/classes

Modified Files:
	miguel_mfilemanager.class.php 
Log Message:
Added first version of Rename, Visible, Lock and Share operations


Index: miguel_mfilemanager.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/filemanager/model/classes/miguel_mfilemanager.class.php,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** miguel_mfilemanager.class.php	9 Aug 2004 21:45:36 -0000	1.1
--- miguel_mfilemanager.class.php	12 Aug 2004 11:33:55 -0000	1.2
***************
*** 47,51 ****
      {
          $document = $this->SelectMultiTable('fm_course_document_folder, fm_document',
!                                            "fm_course_document_folder.document_id, fm_document.document_name, fm_document.document_size, fm_document.user_id,  fm_document.date_publish",
                                             'fm_course_document_folder.course_id = ' . $current_course . ' AND fm_course_document_folder.folder_id = ' . $current_folder_id . ' AND fm_course_document_folder.document_id = fm_document.document_id');
              if ($this->hasError()) {
--- 47,51 ----
      {
          $document = $this->SelectMultiTable('fm_course_document_folder, fm_document',
!                                            "fm_course_document_folder.document_id, fm_document.document_name, fm_document.document_size, fm_document.user_id,  fm_document.date_publish, fm_document.document_visible, fm_document.document_lock, fm_document.document_share",
                                             'fm_course_document_folder.course_id = ' . $current_course . ' AND fm_course_document_folder.folder_id = ' . $current_folder_id . ' AND fm_course_document_folder.document_id = fm_document.document_id');
              if ($this->hasError()) {
***************
*** 58,62 ****
                                    'document_size' => $document[$i]['fm_document.document_size'],
                                    'document_date' => $document[$i]['fm_document.date_publish'],
!                                   'document_autor' => $this->_getNameFromUser($document[$i]['fm_document.user_id'])
                                  );
          }
--- 58,65 ----
                                    'document_size' => $document[$i]['fm_document.document_size'],
                                    'document_date' => $document[$i]['fm_document.date_publish'],
!                                   'document_autor' => $this->_getNameFromUser($document[$i]['fm_document.user_id']),
!                                   'document_visible' => $document[$i]['fm_document.document_visible'],
!                                   'document_lock' => $document[$i]['fm_document.document_lock'],
!                                   'document_share' => $document[$i]['fm_document.document_share']
                                  );
          }
***************
*** 90,94 ****
      {
          //$current_course = 0;
!         $folder = $this->Select("fm_folder", "folder_id, folder_name, folder_parent_id, folder_date, user_id",
                                  "course_id = $current_course AND folder_parent_id = $current_folder_id");
  
--- 93,97 ----
      {
          //$current_course = 0;
!         $folder = $this->Select("fm_folder", "folder_id, folder_name, folder_parent_id, folder_date, user_id, folder_visible",
                                  "course_id = $current_course AND folder_parent_id = $current_folder_id");
  
***************
*** 107,111 ****
                                    'folder_date' => $folder[$i]['fm_folder.folder_date'],
                                    'folder_count_element' => $fileCount + $currentFolderCount,
!                                   'folder_autor' => $this->_getNameFromUser($folder[$i]['fm_folder.user_id'])
                                  );
          }
--- 110,115 ----
                                    'folder_date' => $folder[$i]['fm_folder.folder_date'],
                                    'folder_count_element' => $fileCount + $currentFolderCount,
!                                   'folder_autor' => $this->_getNameFromUser($folder[$i]['fm_folder.user_id']),
!                                   'folder_visible' => $folder[$i]['fm_folder.folder_visible']
                                  );
          }
***************
*** 114,119 ****
      }
  
!         //Maqueta
!         function getFolderId( $course_id )
      {
          $folder = $this->Select("fm_folder", "folder_id",
--- 118,123 ----
      }
  
!     //Maqueta
!     function getFolderId( $course_id )
      {
          $folder = $this->Select("fm_folder", "folder_id",
***************
*** 129,134 ****
  
      }
-         //Maqueta
  
      function getFolderName( $folder_id )
      {
--- 133,138 ----
  
      }
  
+     //Maqueta
      function getFolderName( $folder_id )
      {
***************
*** 155,160 ****
  
  		$ret_val = $this->Insert('fm_folder',
! 									'folder_parent_id, course_id, folder_name, user_id, folder_date',
! 									"$parent_folder_id,$course_id,$folder_name, $user_id, $now");
  		
  		
--- 159,164 ----
  
  		$ret_val = $this->Insert('fm_folder',
! 					'folder_parent_id, course_id, folder_name, user_id, folder_date, folder_visible',
! 					"$parent_folder_id,$course_id,$folder_name, $user_id, $now, 1");
  		
  		
***************
*** 172,177 ****
  
          $documentID = $this->Insert('fm_document',
!                                  'document_mime, document_name, user_id, document_size, date_publish',
!                                  "$document_mime, $document_name, $user_id, $size, $now");
  
          if ($this->hasError()) {
--- 176,181 ----
  
          $documentID = $this->Insert('fm_document',
!                                  'document_mime, document_name, user_id, document_size, date_publish, document_visible, document_lock, document_share',
!                                  "$document_mime, $document_name, $user_id, $size, $now,0,0,0");
  
          if ($this->hasError()) {
***************
*** 189,193 ****
--- 193,275 ----
  
      }
+ 
+     function visibleElement($id, $status, $type='document') {
+         if ($type='document') {
+             $ret_val = $this->Update('fm_document', 'document_visible', $status, 'document_id = '.$id);
+         } else {
+             $ret_val = $this->Update('fm_folder', 'folder_visible', $status, 'folder_id = '.$id);
+         }
+         if ($this->hasError() ) {
+             $ret_val = null;
+         }
+         return ($ret_val);
+     }
  	
+     function lockDocument($id, $status) {
+         $ret_val = $this->Update('fm_document', 'document_lock', $status, 'document_id = '.$id);
+         if ($this->hasError() ) {
+             $ret_val = null;
+         }
+ 
+         return ($ret_val);
+     }
+ 
+     function shareDocument($id, $status) {
+         $ret_val = $this->Update('fm_document', 'document_share', $status, 'document_id = '.$id);
+         
+         if ($this->hasError() ) {
+             $ret_val = null;
+         }
+         
+         return ($ret_val);
+     }
+ 
+     //Maqueta
+     function _getFileName( $document_id )
+     {
+         $document = $this->Select("fm_document", "document_name",
+                                 "document_id = $document_id");
+ 
+         if ($this->hasError()) {
+                 $ret_val = null;
+         }
+ 
+         $countDocument = count($document);
+         for ($i=0; $i < $countDocument; $i++) {
+              $ret_val[] = array ( 'document_name' => $document[$i]['fm_document.document_name']);
+         }
+ 
+         return ($ret_val);
+ 
+     }
+ 
+     function renameFile( $_id, $_newName ) {
+         $oldName = $this->_getFileName( $_id ); 
+         $ret_val = $this->Update('fm_document', 'document_name', $_newName, 'document_id = '.$_id);
+         
+         if ($this->hasError() ) {
+             $ret_val = null;
+         } else {
+             //user can't give the old name for security reasons
+             $file = Util::main_Path('var/data/' . $oldName[0]['document_name']);
+             $newFile = Util::main_Path('var/data/' . $_newName);
+             if(file_exists($file)){
+                 rename($file, $newFile);
+             }
+         } 
+         
+         return ($ret_val);
+     }
+ 
+     function renameFolder( $_id, $_newName ) {
+         $ret_val = $this->Update('fm_folder', 'folder_name', $_newName, 'folder_id = '.$_id);
+   
+         if ($this->hasError() ) {
+             $ret_val = null;
+         }
+ 
+         return ($ret_val);
+     }
+ 
  	function deleteFile($_id)
  	{
***************
*** 246,248 ****
      }
  }
! ?>
\ No newline at end of file
--- 328,330 ----
      }
  }
! ?>



From nobody at sheep.berlios.de  Thu Aug 12 13:33:57 2004
From: nobody at sheep.berlios.de (antoniofcano)
Date: Thu, 12 Aug 2004 13:33:57 +0200
Subject: [Migueloo-cvs] migueloo/modules/filemanager/control/classes miguel_cfilemanager.class.php,1.1,1.2
Message-ID: <200408121133.i7CBXv630961@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/filemanager/control/classes
In directory sheep:/tmp/cvs-serv27819/control/classes

Modified Files:
	miguel_cfilemanager.class.php 
Log Message:
Added first version of Rename, Visible, Lock and Share operations


Index: miguel_cfilemanager.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/filemanager/control/classes/miguel_cfilemanager.class.php,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** miguel_cfilemanager.class.php	9 Aug 2004 21:45:36 -0000	1.1
--- miguel_cfilemanager.class.php	12 Aug 2004 11:33:54 -0000	1.2
***************
*** 108,119 ****
  				}
  	
! 				/* ------------ OTRAS OPERACIONES ARCHIVOS Y DIRECTORIOS -------------- */
  				/* Eliminar, Renombrar, Comentar, Mover, Hacer visible, Bloquear, Compartir, ?Actualizar y guardar un log de cambios o control de versiones? */
! 	
  				/* Deber?a retornar un valor error o estado de la operaci?n y notificarlo en la carga del m?dulo */
  			}
! 			
  			if ( $this->issetViewVariable('status') ) {
! 				if($this->getViewVariable('status') == 'del'){
  					if($this->getViewVariable('tp') == 'f'){
  						$this->obj_data->deleteFolder($this->getViewVariable('id'));
--- 108,135 ----
  				}
  	
! 				/* ------------ OTRAS OPERACIONES ARCHIVOS Y DIRECTORIOS CON FORMULARIO INTERMEDIO-------------- */
  				/* Eliminar, Renombrar, Comentar, Mover, Hacer visible, Bloquear, Compartir, ?Actualizar y guardar un log de cambios o control de versiones? */
!                                 if ( $this->issetViewVariable('status') ) {
!                                     $status = $this->getViewVariable('status');
!                                     switch ( $status ) {
!                                         case 'rename':
!                                             if($this->getViewVariable('tp') == 'f'){
!                                                     $this->obj_data->renameFolder($this->getViewVariable('id'), $this->getViewVariable('newname'));
!                                             } else {
!                                                     $this->obj_data->renameFile($this->getViewVariable('id'), $this->getViewVariable('newname'));
!                                             }
!                                             break;
!                                     }
!                                     $status = null;
!                                     unset( $status );
!                                 }
  				/* Deber?a retornar un valor error o estado de la operaci?n y notificarlo en la carga del m?dulo */
  			}
! 
! 			/* ------------------ OPERACIONES REALIZADAS DIRECTAMENTE ---------*/
  			if ( $this->issetViewVariable('status') ) {
!                             $status = $this->getViewVariable('status');
!                             switch ( $status ) {
! 				case 'del':
  					if($this->getViewVariable('tp') == 'f'){
  						$this->obj_data->deleteFolder($this->getViewVariable('id'));
***************
*** 121,138 ****
  						$this->obj_data->deleteFile($this->getViewVariable('id'));
  					}
! 				}
! 			}
! 	
! 			/* -------------------- CARGA EL MODULO Y LO MUESTRA POR PANTALLA -------------------- */
! 			$this->setViewClass("miguel_VMain");                    
! 			$this->setPageTitle("miguel_institutionList");
! 			//$this->addNavElement(Util::format_URLPath('main/index.php','id=institution'), agt("miguel_Center") );
! 
  			if ( $this->issetViewVariable("folder_id") != "" ) {
  				$current_folder_id = $this->getViewVariable("folder_id");
  			} else {
! 				$current_folder_id = $this->obj_data->getFolderId($course_id);//0;
  			}
- 			
  			$current_folder_info = $this->obj_data->getFolderName( $current_folder_id );
  				
--- 137,175 ----
  						$this->obj_data->deleteFile($this->getViewVariable('id'));
  					}
!                                         break;
!                                 case 'visible':
!                                         if($this->getViewVariable('tp') == 'f'){
!                                                 $this->obj_data->visibleElement($this->getViewVariable('id'), 1, 'folder');
!                                         } else {
!                                                 $this->obj_data->visibleElement($this->getViewVariable('id'), 1, 'document');
!                                         }
!                                         break;
!                                 case 'invisible':
!                                         if($this->getViewVariable('tp') == 'f'){
!                                                 $this->obj_data->visibleElement($this->getViewVariable('id'), 0, 'folder');
!                                         } else {
!                                                 $this->obj_data->visibleElement($this->getViewVariable('id'), 0, 'document');
!                                         }       
!                                         break;
!                                 case 'lock':
!                                         $this->obj_data->lockDocument($this->getViewVariable('id'), 1);
!                                         break;
!                                 case 'unlock':
!                                         $this->obj_data->lockDocument($this->getViewVariable('id'), 0);
!                                         break;
!                                 case 'share':
!                                         $this->obj_data->shareDocument($this->getViewVariable('id'), 1);
!                                         break;
!                                 case 'unshare':
!                                         $this->obj_data->shareDocument($this->getViewVariable('id'), 0);
!                                         break;
!                             }
!                         }
  			if ( $this->issetViewVariable("folder_id") != "" ) {
  				$current_folder_id = $this->getViewVariable("folder_id");
  			} else {
! 				//$current_folder_id = $this->obj_data->getFolderId($course_id);//0;
!                                 $current_folder_id = 0;
  			}
  			$current_folder_info = $this->obj_data->getFolderName( $current_folder_id );
  				
***************
*** 158,160 ****
      }
  }
! ?>
\ No newline at end of file
--- 195,197 ----
      }
  }
! ?>



From nobody at sheep.berlios.de  Thu Aug 12 13:33:57 2004
From: nobody at sheep.berlios.de (antoniofcano)
Date: Thu, 12 Aug 2004 13:33:57 +0200
Subject: [Migueloo-cvs] migueloo/modules/filemanager/view/classes miguel_renameform.class.php,NONE,1.1 miguel_vfilemanager.class.php,1.1,1.2
Message-ID: <200408121133.i7CBXv630966@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/filemanager/view/classes
In directory sheep:/tmp/cvs-serv27819/view/classes

Modified Files:
	miguel_vfilemanager.class.php 
Added Files:
	miguel_renameform.class.php 
Log Message:
Added first version of Rename, Visible, Lock and Share operations


--- NEW FILE: miguel_renameform.class.php ---
<?php
/*
      +----------------------------------------------------------------------+
      | miguel base                                                          |
      +----------------------------------------------------------------------+
      | Copyright (c) 2003, miguel Development Team                          |
      +----------------------------------------------------------------------+
      |   This program is free software; you can redistribute it and/or      |
      |   modify it under the terms of the GNU General Public License        |
      |   as published by the Free Software Foundation; either version 2     |
      |   of the License, or (at your option) any later version.             |
      |                                                                      |
      |   This program is distributed in the hope that it will be useful,    |
      |   but WITHOUT ANY WARRANTY; without even the implied warranty of     |
      |   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      |
      |   GNU General Public License for more details.                       |
      |                                                                      |
      |   You should have received a copy of the GNU General Public License  |
      |   along with this program; if not, write to the Free Software        |
      |   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA          |
      |   02111-1307, USA. The GNU GPL license is also available through     |
      |   the world-wide-web at http://www.gnu.org/copyleft/gpl.html         |
      +----------------------------------------------------------------------+
      | Authors: Antonio F. Cano Damas  <antonio at igestec.com  >              |
      |          miguel Development Team                                     |
      |                       <e-learning-desarrollo at listas.hispalinux.es>   |      
      +----------------------------------------------------------------------+
*/
/**
 * Esta clase se encarga de gestionar el formulario para accesos
 * de usuarios a la plataforma miguel
 *
 * @author  Antonio F. Cano Damas  <antonio at igestec.com>
 * @author miguel development team <e-learning-desarrollo at listas.hispalinux.es>     
 * @package miguel filemanager
 * @version 1.0.0
 */
include_once (Util::app_Path("common/view/classes/miguel_formcontent.class.php"));

class miguel_renameForm extends miguel_FormContent
{
    function form_init_elements() 
    {
        $this->add_element($this->_formatElem("FEText", agt("Nuevo nombre"), "newName", FALSE, "100"));

	$submit = $this->_formatElem("base_SubmitButton", "Aceptar", "submit", agt("Aceptar"));
	$submit->set_attribute('class','p'); 
	$submit->set_attribute('accesskey','e');               
	$this->add_element($submit);
	
	$this->add_hidden_element("id"); 
        $this->add_hidden_element("tp");
        $this->add_hidden_element("status");
    }

    function form_init_data() 
    {
        $this->set_hidden_element_value("id", $this->getViewVariable('id') );
        $this->set_hidden_element_value("tp", $this->getViewVariable('tp') );
        $this->set_hidden_element_value("status", 'rename' );
        $this->set_element_value("Nuevo nombre", $this->getViewVariable('oldName'));
		return;
    }

    function form() 
    {
        $table = &html_table($this->_width,0,3);
        $table->set_class("mainInterfaceWidth");
        //$table->set_style("border: 1px solid");
        
        $table->add_row($this->_tableRow("Nuevo nombre"));

        $elem = html_td('ptabla03', '', container($this->element_form("Aceptar")));
	$elem->set_tag_attribute('colspan','9');
        $table->add_row($elem);      

        return $table;
    }
}

?>

Index: miguel_vfilemanager.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/filemanager/view/classes/miguel_vfilemanager.class.php,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** miguel_vfilemanager.class.php	9 Aug 2004 21:45:36 -0000	1.1
--- miguel_vfilemanager.class.php	12 Aug 2004 11:33:55 -0000	1.2
***************
*** 78,87 ****
                                  //Debug::oneVar($arr_data[$i], __FILE__, __LINE__);
                                  $table->add($this->addDocumentInfo($arr_data[$i]['folder_id'],
!                                                                                         $arr_data[$i]['folder_name'],
!                                                                                         $arr_data[$i]['folder_date'],
!                                                                                         $arr_data[$i]['folder_autor'],
!                                                                                         0,
!                                                                                         $arr_data[$i]['folder_count_element'],
!                                                                                         true));
                          }
                          //$bol_hasFolders = true;
--- 78,89 ----
                                  //Debug::oneVar($arr_data[$i], __FILE__, __LINE__);
                                  $table->add($this->addDocumentInfo($arr_data[$i]['folder_id'],
!                                                                    $arr_data[$i]['folder_name'],
!                                                                    $arr_data[$i]['folder_date'],
!                                                                    $arr_data[$i]['folder_autor'],
!                                                                    0,
!                                                                    $arr_data[$i]['folder_count_element'],
!                                                                    $arr_data[$i]['folder_visible'],
!                                                                    1,1,
!                                                                    true));
                          }
                          //$bol_hasFolders = true;
***************
*** 94,104 ****
                  if ($arr_data[0]['document_name'] != null) {
                          for ($i=0; $i<count($arr_data); $i++) {
-                                 //Debug::oneVar($arr_data[$i], __FILE__, __LINE__);
                                  $table->add($this->addDocumentInfo($arr_data[$i]['document_id'],
!                                                                                         $arr_data[$i]['document_name'],
!                                                                                         $arr_data[$i]['document_date'],
!                                                                                         $arr_data[$i]['document_autor'],
!                                                                                         0,
!                                                                                         $arr_data[$i]['document_size']));
                          }
                  } /*else {
--- 96,108 ----
                  if ($arr_data[0]['document_name'] != null) {
                          for ($i=0; $i<count($arr_data); $i++) {
                                  $table->add($this->addDocumentInfo($arr_data[$i]['document_id'],
!                                                                    $arr_data[$i]['document_name'],
!                                                                    $arr_data[$i]['document_date'],
!                                                                    $arr_data[$i]['document_autor'],
!                                                                    0,
!                                                                    $arr_data[$i]['document_size'],
!                                                                    $arr_data[$i]['document_visible'],
!                                                                    $arr_data[$i]['document_lock'],
!                                                                    $arr_data[$i]['document_share']));
                          }
                  } /*else {
***************
*** 115,122 ****
                  $folder_parent_id = $this->getViewVariable('folder_parent_id');
                  if($folder_parent_id != 0 ){
!                         $link = $this->imag_alone(Util::format_URLPath('filemanager/index.php',$status.$_id, 'folder_id=' . $folder_parent_id),
!                                                                                                                 Theme::getThemeImagePath('img_carpeta_up.png'), agt('Subir'), 15, 12); //filemanager/parentdir.png
!                         //$image = Theme::getThemeImage("filemanager/parentdir.png"); //img_carpeta.jpg //boton_arriba.gif
!                         //$link = html_a(Util::format_URLPath('filemanager/index.php', 'folder_id=' . $folder_parent_id), $image, null, '_top');
                  } else {
                          $link = _HTML_SPACE;
--- 119,124 ----
                  $folder_parent_id = $this->getViewVariable('folder_parent_id');
                  if($folder_parent_id != 0 ){
!                         $link = $this->imag_alone(Util::format_URLPath('filemanager/index.php',"folder_id=$folder_parent_id"),
!                                                                         Theme::getThemeImagePath('filemanager/parentdir.png'), agt('Subir'),15,12);
                  } else {
                          $link = _HTML_SPACE;
***************
*** 135,138 ****
--- 137,145 ----
                  $elem8 = html_td('ptabla02', "", _HTML_SPACE);
                  $elem9 = html_td('ptabla02', "",_HTML_SPACE);
+                 $elem10 = html_td('ptabla02', "",_HTML_SPACE);
+                 $elem11 = html_td('ptabla02', "",_HTML_SPACE);
+                 $elem12 = html_td('ptabla02', "",_HTML_SPACE);
+                 $elem13 = html_td('ptabla02', "",_HTML_SPACE);
+                 $elem14 = html_td('ptabla02', "",_HTML_SPACE);
  
                  $elem1->set_tag_attribute('width', '1%');
***************
*** 145,148 ****
--- 152,160 ----
                  $elem8->set_tag_attribute('width', '1%');
                  $elem9->set_tag_attribute('width', '1%');
+                 $elem10->set_tag_attribute('width', '1%');
+                 $elem11->set_tag_attribute('width', '1%');
+                 $elem12->set_tag_attribute('width', '1%');
+                 $elem13->set_tag_attribute('width', '1%');
+                 $elem14->set_tag_attribute('width', '1%');
  
                  $row->add($elem1);
***************
*** 155,163 ****
                  $row->add($elem8);
                  $row->add($elem9);
! 
                  return $row;
          }
  
!         function addDocumentInfo($_id, $_name, $_date, $_owner, $_downs, $_size, $_folder = false)
          {
                  $row = html_tr();
--- 167,179 ----
                  $row->add($elem8);
                  $row->add($elem9);
!                 $row->add($elem10);
!                 $row->add($elem11);
!                 $row->add($elem12);
!                 $row->add($elem13);
!                 $row->add($elem14);
                  return $row;
          }
  
!         function addDocumentInfo($_id, $_name, $_date, $_owner, $_downs, $_size, $_visible=1, $_lock=1, $_share=1, $_folder = false)
          {
                  $row = html_tr();
***************
*** 167,171 ****
                  if($_folder){
                          $link = $this->imag_alone(Util::format_URLPath('filemanager/index.php',"folder_id=$_id"),
!                                                                                                                 Theme::getThemeImagePath('img_carpeta.jpg'), agt('Entrar'));
                  } else {
                          include_once (Util::app_Path("filemanager/include/classes/filedisplay.class.php"));
--- 183,187 ----
                  if($_folder){
                          $link = $this->imag_alone(Util::format_URLPath('filemanager/index.php',"folder_id=$_id"),
!                                                                         Theme::getThemeImagePath('filemanager/folder.png'), agt('Entrar'));
                  } else {
                          include_once (Util::app_Path("filemanager/include/classes/filedisplay.class.php"));
***************
*** 197,200 ****
--- 213,217 ----
                  $elem8->set_tag_attribute('align', 'center');
  
+                 //----------------- COMMON OPERATIONS ------------------------------
                  $_fid = $this->getViewVariable('folder_id');
  
***************
*** 205,212 ****
                  }
                  $img = $this->imag_alone(Util::format_URLPath('filemanager/index.php',$status.$_id),
!                                                                                                                 Theme::getThemeImagePath('boton_papelera.gif'), agt('Borrar'));
!                 $elem9 = html_td('ptabla03', '', $img); //eliminar.jpg //html_img(Theme::getThemeImagePath('boton_papelera.gif'))
                  $elem9->set_tag_attribute('align', 'center');
  
                  $row->add($elem1);
                  $row->add($elem2);
--- 222,308 ----
                  }
                  $img = $this->imag_alone(Util::format_URLPath('filemanager/index.php',$status.$_id),
!                                          Theme::getThemeImagePath('filemanager/delete.png'), agt('Borrar'));
!                 $elem9 = html_td('ptabla03', '', $img);
                  $elem9->set_tag_attribute('align', 'center');
  
+                 $_fid = $this->getViewVariable('folder_id');
+ 
+                 if($_folder){
+                         $status = 'oldName='.$_name.'&operation_id=rename&tp=f&id=';
+                 } else {
+                         $status = 'oldName='.$_name.'&operation_id=rename&tp=d&id=';
+                 }
+                 $img = $this->imag_alone(Util::format_URLPath('filemanager/index.php',$status.$_id),
+                                          Theme::getThemeImagePath('filemanager/rename.png'), agt('Renombrar'));
+                 $elem10 = html_td('ptabla03', '', $img); 
+                 $elem10->set_tag_attribute('align', 'center');
+ 
+                 if($_folder){
+                         $status = 'folder_id='.$_fid.'&operation_id=move&tp=f&id=';
+                 } else {
+                         $status = 'folder_id='.$_fid.'&operation_id=move&tp=d&id=';
+                 }
+                 $img = $this->imag_alone(Util::format_URLPath('filemanager/index.php',$status.$_id),
+                                          Theme::getThemeImagePath('filemanager/move.png'), agt('Mover'));
+                 $elem11 = html_td('ptabla03', '', $img); 
+                 $elem11->set_tag_attribute('align', 'center');
+                 if ($_visible == 0) {
+                     $status= 'visible';
+                     $icon='invisible.png';
+                     $tooltip='Visible';
+                 } else {
+                     $status='invisible';
+                     $icon='visible.png';
+                     $tooltip='Invisible';
+                 }
+                 if($_folder){
+                         $status = 'status='.$status.'&tp=f&id=';
+                 } else {
+                         $status = 'status='.$status.'&tp=d&id=';
+                 }
+                 $img = $this->imag_alone(Util::format_URLPath('filemanager/index.php',$status.$_id),
+                                          Theme::getThemeImagePath('filemanager/'.$icon), agt($tooltip));
+                 $elem12 = html_td('ptabla03', '', $img); 
+                 $elem12->set_tag_attribute('align', 'center');
+ 
+                 if( !$_folder ) {
+                     if ($_lock == 0) {
+                         $status= 'lock';
+                         $icon='lock.png';
+                         $tooltip='Bloquear';
+                     } else {
+                         $status='unlock';
+                         $icon='unlock.png';
+                         $tooltip='Desbloqear';
+                     }
+                     $status = 'status='.$status.'&id=';
+                     $img = $this->imag_alone(Util::format_URLPath('filemanager/index.php',$status.$_id),
+                                              Theme::getThemeImagePath('filemanager/'.$icon), agt($tooltip));
+ 
+                     $elem13 = html_td('ptabla03', '', $img);
+                     $elem13->set_tag_attribute('align', 'center');
+                     if ($_share == 0) {
+                         $status= 'share';
+                         $icon='invisible.png';
+                         $tooltip='Compartir';
+                     } else {
+                         $status='unshare';
+                         $icon='visible.png';
+                         $tooltip='No compartir';
+                     }
+                     $status = 'status='.$status.'&id=';
+                     $img = $this->imag_alone(Util::format_URLPath('filemanager/index.php',$status.$_id),
+                                              Theme::getThemeImagePath('filemanager/'.$icon), agt($tooltip));
+ 
+                     $elem14 = html_td('ptabla03', '', $img);
+                     $elem14->set_tag_attribute('align', 'center');
+                 } else {
+                     $link = _HTML_SPACE;
+                     $elem13 = html_td('ptabla03', '', $link);
+                     $elem13->set_tag_attribute('align', 'center');
+                     $elem14 = html_td('ptabla03', '', $link);
+                     $elem14->set_tag_attribute('align', 'center');
+                 }
+                 //--------------------- ADD OPERATIONS INTO TR CONTAINET -----------------
                  $row->add($elem1);
                  $row->add($elem2);
***************
*** 218,222 ****
                  $row->add($elem8);
                  $row->add($elem9);
! 
                  return $row;
          }
--- 314,322 ----
                  $row->add($elem8);
                  $row->add($elem9);
!                 $row->add($elem10);
!                 $row->add($elem11);
!                 $row->add($elem12);
!                 $row->add($elem13);
!                 $row->add($elem14);
                  return $row;
          }
***************
*** 232,235 ****
--- 332,344 ----
                                          $ret_val = $this->addForm('filemanager', 'miguel_submitFileForm');
                                          break;
+                                 case 'rename':
+                                         $ret_val = $this->addForm('filemanager', 'miguel_renameForm');
+                                         break; 
+                                 case 'move':
+                                         $ret_val = $this->addForm('filemanager', 'miguel_moveForm');
+                                         break;
+                                 case 'comment':
+                                         $ret_val = $this->addForm('filemanager', 'miguel_submitFileForm');
+                                         break;  
                          }
                  } else {
***************
*** 269,274 ****
          //$table->add_row(html_td('ptabla03', '', $this->init_content() ));
          $table->add_row(html_td('ptabla03', '', _HTML_SPACE));
!                 $table->add_row($this->_operationForm());
!                 $table->add_row(html_td('ptabla03', '', _HTML_SPACE));
          $table->add_row(html_td('ptabla01pie', '', $title));
  
--- 378,383 ----
          //$table->add_row(html_td('ptabla03', '', $this->init_content() ));
          $table->add_row(html_td('ptabla03', '', _HTML_SPACE));
!         $table->add_row($this->_operationForm());
!         $table->add_row(html_td('ptabla03', '', _HTML_SPACE));
          $table->add_row(html_td('ptabla01pie', '', $title));
  
***************
*** 277,281 ****
  
      function right_block()
!         {
                  //Crea el contenedor del right_block
                  $main = container();
--- 386,390 ----
  
      function right_block()
!     {
                  //Crea el contenedor del right_block
                  $main = container();



From nobody at sheep.berlios.de  Thu Aug 12 13:36:39 2004
From: nobody at sheep.berlios.de (antoniofcano)
Date: Thu, 12 Aug 2004 13:36:39 +0200
Subject: [Migueloo-cvs] migueloo/doc/sql filemanager.sql,NONE,1.1
Message-ID: <200408121136.i7CBad631079@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/doc/sql
In directory sheep:/tmp/cvs-serv28553

Added Files:
	filemanager.sql 
Log Message:
Add filemanager SQL structure


--- NEW FILE: filemanager.sql ---
-- phpMyAdmin SQL Dump
-- version 2.6.0-beta1
-- http://www.phpmyadmin.net
-- 
-- Servidor: localhost
-- Tiempo de generaci?n: 12-08-2004 a las 13:35:40
-- Versi?n del servidor: 4.0.13
-- Versi?n de PHP: 4.3.4
-- 
-- Base de datos: `migueloo_desa`
-- 

-- --------------------------------------------------------

-- 
-- Estructura de tabla para la tabla `fm_course_document_folder`
-- 

DROP TABLE IF EXISTS `fm_course_document_folder`;
CREATE TABLE `fm_course_document_folder` (
  `COURSE_ID` int(11) NOT NULL default '0',
  `DOCUMENT_ID` int(11) NOT NULL default '0',
  `FOLDER_ID` int(11) NOT NULL default '0',
  PRIMARY KEY  (`COURSE_ID`,`DOCUMENT_ID`,`FOLDER_ID`)
) TYPE=MyISAM;

-- --------------------------------------------------------

-- 
-- Estructura de tabla para la tabla `fm_document`
-- 

DROP TABLE IF EXISTS `fm_document`;
CREATE TABLE `fm_document` (
  `DOCUMENT_ID` int(11) NOT NULL auto_increment,
  `DOCUMENT_COMMENT` char(255) NOT NULL default '',
  `DOCUMENT_VISIBLE` tinyint(1) NOT NULL default '0',
  `DOCUMENT_MIME` char(30) NOT NULL default '',
  `DATE_PUBLISH` date NOT NULL default '0000-00-00',
  `DOCUMENT_LOCK` tinyint(1) NOT NULL default '0',
  `DOCUMENT_SHARE` tinyint(4) NOT NULL default '0',
  `USER_ID` int(11) NOT NULL default '0',
  `DOCUMENT_NAME` char(100) NOT NULL default '',
  `DOCUMENT_SIZE` int(11) NOT NULL default '0',
  PRIMARY KEY  (`DOCUMENT_ID`)
) TYPE=MyISAM AUTO_INCREMENT=3 ;

-- --------------------------------------------------------

-- 
-- Estructura de tabla para la tabla `fm_folder`
-- 

DROP TABLE IF EXISTS `fm_folder`;
CREATE TABLE `fm_folder` (
  `FOLDER_ID` int(11) NOT NULL auto_increment,
  `FOLDER_PARENT_ID` int(11) NOT NULL default '0',
  `FOLDER_NAME` char(100) NOT NULL default '',
  `FOLDER_COMMENT` char(255) NOT NULL default '',
  `FOLDER_VISIBLE` tinyint(11) NOT NULL default '0',
  `FOLDER_DATE` date NOT NULL default '0000-00-00',
  `COURSE_ID` int(11) NOT NULL default '0',
  `USER_ID` int(11) NOT NULL default '0',
  PRIMARY KEY  (`FOLDER_ID`)
) TYPE=MyISAM AUTO_INCREMENT=3 ;



From nobody at sheep.berlios.de  Thu Aug 12 17:20:05 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Thu, 12 Aug 2004 17:20:05 +0200
Subject: [Migueloo-cvs] migueloo index.php,1.1,1.2
Message-ID: <200408121520.i7CFK5604948@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo
In directory sheep:/tmp/cvs-serv6513

Modified Files:
	index.php 
Log Message:
Optimizaci?n con el uso correcto de las comillas simples y dobles

Index: index.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/index.php,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** index.php	13 Jun 2004 14:03:45 -0000	1.1
--- index.php	12 Aug 2004 15:20:03 -0000	1.2
***************
*** 27,42 ****
        +----------------------------------------------------------------------+
  */
! if(file_exists("./modules/common/miguel_base.inc.php")){
! 	include_once ("./modules/common/miguel_base.inc.php");
  
  	if(file_exists(CONFIG_FILE)){
! 		header("Location:./modules/main/index.php");
  	} else {
! 		header("Location:./modules/install/index.php");
  	}
  } else {
! 	echo "<h1>miguel no est? configurado</h1>";
! 	echo "<h2>Debe ejecutar previamente el sistema de setup desde la consola</h2>";
! 	echo "<h3>Lea el fichero INSTALL para m?s informaci?n</h3>";
  }
  ?>
--- 27,42 ----
        +----------------------------------------------------------------------+
  */
! if(file_exists('./modules/common/miguel_base.inc.php')){
! 	include_once ('./modules/common/miguel_base.inc.php');
  
  	if(file_exists(CONFIG_FILE)){
! 		header('Location:./modules/main/index.php');
  	} else {
! 		header('Location:./modules/install/index.php');
  	}
  } else {
! 	echo '<h1>miguel no est? configurado</h1>';
! 	echo '<h2>Debe ejecutar previamente el sistema de setup desde la consola</h2>';
! 	echo '<h3>Lea el fichero INSTALL para m?s informaci?n</h3>';
  }
  ?>



From nobody at sheep.berlios.de  Thu Aug 12 17:20:06 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Thu, 12 Aug 2004 17:20:06 +0200
Subject: [Migueloo-cvs] migueloo/modules/admin index.php,1.3,1.4
Message-ID: <200408121520.i7CFK6604956@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/admin
In directory sheep:/tmp/cvs-serv6513/modules/admin

Modified Files:
	index.php 
Log Message:
Optimizaci?n con el uso correcto de las comillas simples y dobles

Index: index.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/admin/index.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** index.php	6 Aug 2004 08:07:47 -0000	1.3
--- index.php	12 Aug 2004 15:20:03 -0000	1.4
***************
*** 29,34 ****
  */
  
! include_once ("../common/miguel_base.inc.php");
! include_once (Util::app_Path("admin/control/classes/miguel_cadmin.class.php"));
  
  $miguel = new miguel_CAdmin();
--- 29,34 ----
  */
  
! include_once ('../common/miguel_base.inc.php');
! include_once (Util::app_Path('admin/control/classes/miguel_cadmin.class.php'));
  
  $miguel = new miguel_CAdmin();



From nobody at sheep.berlios.de  Thu Aug 12 17:20:06 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Thu, 12 Aug 2004 17:20:06 +0200
Subject: [Migueloo-cvs] migueloo/modules/admin/control/classes miguel_cadmin.class.php,1.3,1.4
Message-ID: <200408121520.i7CFK6604960@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/admin/control/classes
In directory sheep:/tmp/cvs-serv6513/modules/admin/control/classes

Modified Files:
	miguel_cadmin.class.php 
Log Message:
Optimizaci?n con el uso correcto de las comillas simples y dobles

Index: miguel_cadmin.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/admin/control/classes/miguel_cadmin.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** miguel_cadmin.class.php	6 Aug 2004 08:07:47 -0000	1.3
--- miguel_cadmin.class.php	12 Aug 2004 15:20:03 -0000	1.4
***************
*** 41,45 ****
   */
  
! include_once (Util::app_Path("common/control/classes/miguel_userinfo.class.php"));
  
  
--- 41,45 ----
   */
  
! include_once (Util::app_Path('common/control/classes/miguel_userinfo.class.php'));
  
  



From nobody at sheep.berlios.de  Thu Aug 12 17:20:06 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Thu, 12 Aug 2004 17:20:06 +0200
Subject: [Migueloo-cvs] migueloo/modules/admin/view/classes miguel_vadmin.class.php,1.3,1.4
Message-ID: <200408121520.i7CFK6604964@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/admin/view/classes
In directory sheep:/tmp/cvs-serv6513/modules/admin/view/classes

Modified Files:
	miguel_vadmin.class.php 
Log Message:
Optimizaci?n con el uso correcto de las comillas simples y dobles

Index: miguel_vadmin.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/admin/view/classes/miguel_vadmin.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** miguel_vadmin.class.php	6 Aug 2004 10:13:55 -0000	1.3
--- miguel_vadmin.class.php	12 Aug 2004 15:20:04 -0000	1.4
***************
*** 41,51 ****
   */
  
! include_once (Util::app_Path("common/view/classes/miguel_vmenu.class.php"));
! include_once (Util::app_Path("admin/view/include/classes/miguel_searchForm.class.php"));
! include_once (Util::app_Path("admin/view/include/classes/miguel_searchresultForm.class.php"));
! include_once (Util::app_Path("admin/view/include/classes/miguel_adduserlistForm.class.php"));
! include_once (Util::app_Path("admin/view/include/classes/miguel_adduserForm.class.php"));
! include_once (Util::app_Path("admin/view/include/classes/miguel_deluserForm.class.php"));
! include_once (Util::app_Path("admin/view/include/classes/miguel_edituserprofileForm.class.php"));
  
  class miguel_VAdmin extends miguel_VMenu
--- 41,51 ----
   */
  
! include_once (Util::app_Path('common/view/classes/miguel_vmenu.class.php'));
! include_once (Util::app_Path('admin/view/include/classes/miguel_searchForm.class.php'));
! include_once (Util::app_Path('admin/view/include/classes/miguel_searchresultForm.class.php'));
! include_once (Util::app_Path('admin/view/include/classes/miguel_adduserlistForm.class.php'));
! include_once (Util::app_Path('admin/view/include/classes/miguel_adduserForm.class.php'));
! include_once (Util::app_Path('admin/view/include/classes/miguel_deluserForm.class.php'));
! include_once (Util::app_Path('admin/view/include/classes/miguel_edituserprofileForm.class.php'));
  
  class miguel_VAdmin extends miguel_VMenu
***************
*** 284,288 ****
      //$ret_val->add(html_a(Util::format_URLPath('admin/index.php', 'admin_screen=course_list'),
      //                                          'Lista de cursos'), html_br());
!     $ret_val->add("No implementado");
  
      return $ret_val;
--- 284,288 ----
      //$ret_val->add(html_a(Util::format_URLPath('admin/index.php', 'admin_screen=course_list'),
      //                                          'Lista de cursos'), html_br());
!     $ret_val->add('No implementado');
  
      return $ret_val;
***************
*** 293,297 ****
      $ret_val = html_div();
  
!     $ret_val->add("No implementado");
  
      return $ret_val;
--- 293,297 ----
      $ret_val = html_div();
  
!     $ret_val->add('No implementado');
  
      return $ret_val;
***************
*** 302,306 ****
      $ret_val = html_div();
  
!     $ret_val->add("No implementado");
  
      return $ret_val;
--- 302,306 ----
      $ret_val = html_div();
  
!     $ret_val->add('No implementado');
  
      return $ret_val;



From nobody at sheep.berlios.de  Thu Aug 12 17:20:05 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Thu, 12 Aug 2004 17:20:05 +0200
Subject: [Migueloo-cvs] migueloo/doc/scripts andro_xgettext.php,1.1.1.1,1.2 miguel_HTMLParser.php,1.1,1.2
Message-ID: <200408121520.i7CFK5604952@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/doc/scripts
In directory sheep:/tmp/cvs-serv6513/doc/scripts

Modified Files:
	andro_xgettext.php miguel_HTMLParser.php 
Log Message:
Optimizaci?n con el uso correcto de las comillas simples y dobles

Index: andro_xgettext.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/doc/scripts/andro_xgettext.php,v
retrieving revision 1.1.1.1
retrieving revision 1.2
diff -C2 -d -r1.1.1.1 -r1.2
*** andro_xgettext.php	13 Jun 2004 15:05:25 -0000	1.1.1.1
--- andro_xgettext.php	12 Aug 2004 15:20:03 -0000	1.2
***************
*** 161,165 ****
  		}
  		//Writes file into $folder
! 		$fp = fopen($filename,"wb");
  		fwrite($fp,$file_content);
  		fclose($fp);
--- 161,165 ----
  		}
  		//Writes file into $folder
! 		$fp = fopen($filename,'wb');
  		fwrite($fp,$file_content);
  		fclose($fp);
***************
*** 174,178 ****
  		$numLin = 0;
  		// Read in the file's contents
! 		$fp = fopen($filename,"rb");
  		while($reg = fgets($fp)) {
  			$file_content[$numLin] =$reg;
--- 174,178 ----
  		$numLin = 0;
  		// Read in the file's contents
! 		$fp = fopen($filename,'rb');
  		while($reg = fgets($fp)) {
  			$file_content[$numLin] =$reg;
***************
*** 218,222 ****
  	$gen = new andro_xgettext();
  	for($i = 1; $i < $argc; $i++){
! 		if($argv[$i] == "-o") {
  			$gen->setFileName($argv[$i+1]);
  			$i = $i+1;
--- 218,222 ----
  	$gen = new andro_xgettext();
  	for($i = 1; $i < $argc; $i++){
! 		if($argv[$i] == '-o') {
  			$gen->setFileName($argv[$i+1]);
  			$i = $i+1;
***************
*** 228,230 ****
  	$gen->generateFile();
  } 
! ?>
\ No newline at end of file
--- 228,230 ----
  	$gen->generateFile();
  } 
! ?>

Index: miguel_HTMLParser.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/doc/scripts/miguel_HTMLParser.php,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** miguel_HTMLParser.php	5 Aug 2004 00:44:54 -0000	1.1
--- miguel_HTMLParser.php	12 Aug 2004 15:20:03 -0000	1.2
***************
*** 119,123 ****
  		}
  		//Writes file into $folder
! 		$fp = fopen($filename,"wb");
  		fwrite($fp,$file_content);
  		fclose($fp);
--- 119,123 ----
  		}
  		//Writes file into $folder
! 		$fp = fopen($filename,'wb');
  		fwrite($fp,$file_content);
  		fclose($fp);
***************
*** 129,135 ****
  		$numLin = 0;
  		// Read in the file's contents
! 		$fp = fopen($filename,"rb");
  		while($reg = fgets($fp)) {
! 			$file_content[$numLin] =$reg;
  			$numLin++;
  		}
--- 129,135 ----
  		$numLin = 0;
  		// Read in the file's contents
! 		$fp = fopen($filename,'rb');
  		while($reg = fgets($fp)) {
! 			$file_content[$numLin] = $reg;
  			$numLin++;
  		}
***************
*** 163,181 ****
  	
  	for($i = 1; $i < $argc; $i++)	{
! 		if($argv[$i] == "-p"){
  			$gen->setParam($argv[$i+1], $argv[$i+2]);
  			$i = $i +3;
  		}
  		
! 		if($argv[$i] == "-d") {
  			$dirname = getcwd();
  			$dir = opendir($dirname);
  
  			while($file = @readdir($dir)) {
! 				if($file == "." || $file == "..") {
  					continue;
! 				} else if(@is_dir($dirname."/".$file)) {
  					continue;
! 				} else if(@file_exists($dirname."/".$file)) {
  					if($file != 'miguel_HTMLParser.php'){
  						echo "Procesado fichero: $file\n";
--- 163,181 ----
  	
  	for($i = 1; $i < $argc; $i++)	{
! 		if($argv[$i] == '-p'){
  			$gen->setParam($argv[$i+1], $argv[$i+2]);
  			$i = $i +3;
  		}
  		
! 		if($argv[$i] == '-d') {
  			$dirname = getcwd();
  			$dir = opendir($dirname);
  
  			while($file = @readdir($dir)) {
! 				if($file == '.' || $file == '..') {
  					continue;
! 				} else if(@is_dir($dirname.'/'.$file)) {
  					continue;
! 				} else if(@file_exists($dirname.'/'.$file)) {
  					if($file != 'miguel_HTMLParser.php'){
  						echo "Procesado fichero: $file\n";
***************
*** 191,193 ****
  	}
  }
! ?>
\ No newline at end of file
--- 191,193 ----
  	}
  }
! ?>



From nobody at sheep.berlios.de  Fri Aug 13 20:04:56 2004
From: nobody at sheep.berlios.de (antoniofcano)
Date: Fri, 13 Aug 2004 20:04:56 +0200
Subject: [Migueloo-cvs] migueloo/modules/filemanager/control/classes miguel_cfilemanager.class.php,1.2,1.3
Message-ID: <200408131804.i7DI4u611617@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/filemanager/control/classes
In directory sheep:/tmp/cvs-serv21897/control/classes

Modified Files:
	miguel_cfilemanager.class.php 
Log Message:
Improved view restriction (visibility, lock, ...) tests


Index: miguel_cfilemanager.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/filemanager/control/classes/miguel_cfilemanager.class.php,v
retrieving revision 1.2
retrieving revision 1.3
diff -C2 -d -r1.2 -r1.3
*** miguel_cfilemanager.class.php	12 Aug 2004 11:33:54 -0000	1.2
--- miguel_cfilemanager.class.php	13 Aug 2004 18:04:54 -0000	1.3
***************
*** 64,74 ****
  
  		//Primero comprueba si estamos identificados y si no es asi entonces vamos a ver si es una peticion de autenticacion
! 		$user_id = $this->getSessionElement( 'userinfo', 'user_id' );
!         $course_id = $this->getSessionElement( 'courseinfo', 'course_id');
  		//Para maqueta
  		if(empty($course_id)){
  			$course_id = 7;
  		}
- 
  		if ( isset($user_id) && $user_id != '' ) {
  			$bol_hasaccess = true;
--- 64,74 ----
  
  		//Primero comprueba si estamos identificados y si no es asi entonces vamos a ver si es una peticion de autenticacion
!                 $user_id = $this->getSessionElement( 'userinfo', 'user_id' );
!                 $course_id = $this->getSessionElement( 'courseinfo', 'course_id');
! 
  		//Para maqueta
  		if(empty($course_id)){
  			$course_id = 7;
  		}
  		if ( isset($user_id) && $user_id != '' ) {
  			$bol_hasaccess = true;
***************
*** 79,89 ****
  
  		if($bol_hasaccess) {
  			if ( $this->issetViewVariable('submit') ) {
! 				/* ----------- CREA UN DIRECTORIO -------------- */
  				if ( $this->issetViewVariable('foldername') ) {
! 						$this->setViewVariable('folder_id', $this->obj_data->insertFolder( $this->getViewVariable('folder_id'), $course_id, $this->getViewVariable('foldername'), $user_id ));
  				}
  	
! 				/* ----------- ENV?O DE FICHEROS -------------- */
  				if ( $_FILES['filename']['tmp_name'] != null ) {
  					include_once (Util::app_Path("filemanager/include/classes/filemanager.class.php"));
--- 79,90 ----
  
  		if($bol_hasaccess) {
+                         /* --------------- EXEC FILEMANAGER ACTIONS ----------------- */
  			if ( $this->issetViewVariable('submit') ) {
! 				/* ----------- NEW FOLDER  -------------- */
  				if ( $this->issetViewVariable('foldername') ) {
!                                     $this->setViewVariable('folder_id', $this->obj_data->insertFolder( $this->getViewVariable('folder_id'), $course_id, $this->getViewVariable('foldername'), $user_id ));
  				}
  	
! 				/* -----------  SUBMIT FILE  -------------- */
  				if ( $_FILES['filename']['tmp_name'] != null ) {
  					include_once (Util::app_Path("filemanager/include/classes/filemanager.class.php"));
***************
*** 166,169 ****
--- 167,171 ----
                              }
                          }
+                         /* -------- SET CURRENT FOLDER, IF EMPTY BY DEFAULT FOLDER_ID = 0 ------------- */
  			if ( $this->issetViewVariable("folder_id") != "" ) {
  				$current_folder_id = $this->getViewVariable("folder_id");
***************
*** 172,175 ****
--- 174,179 ----
                                  $current_folder_id = 0;
  			}
+ //Debug::oneVar( $this->obj_data->getFolderTree( $course_id,  0 ) );
+                         /* ----------- DISPLAY FOLDER CONTENT --------------- */
  			$current_folder_info = $this->obj_data->getFolderName( $current_folder_id );
  				
***************
*** 183,186 ****
--- 187,192 ----
  			$this->setViewVariable('operation_id', $this->getViewVariable('operation_id') );
  		
+                         $this->setViewVariable('user_id', $user_id);
+                         $this->setViewVariable('profile_id', $this->getSessionElement( 'userinfo', 'profile_id' ) );
  			$this->setCacheFile("miguel_VFileManager" . $this->getSessionElement("userinfo", "user_id"));
  			//$this->setMessage(agt("miguel_fileManager"));



From nobody at sheep.berlios.de  Fri Aug 13 20:04:57 2004
From: nobody at sheep.berlios.de (antoniofcano)
Date: Fri, 13 Aug 2004 20:04:57 +0200
Subject: [Migueloo-cvs] migueloo/modules/filemanager/view/classes miguel_vfilemanager.class.php,1.2,1.3
Message-ID: <200408131804.i7DI4v611625@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/filemanager/view/classes
In directory sheep:/tmp/cvs-serv21897/view/classes

Modified Files:
	miguel_vfilemanager.class.php 
Log Message:
Improved view restriction (visibility, lock, ...) tests


Index: miguel_vfilemanager.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/filemanager/view/classes/miguel_vfilemanager.class.php,v
retrieving revision 1.2
retrieving revision 1.3
diff -C2 -d -r1.2 -r1.3
*** miguel_vfilemanager.class.php	12 Aug 2004 11:33:55 -0000	1.2
--- miguel_vfilemanager.class.php	13 Aug 2004 18:04:54 -0000	1.3
***************
*** 22,26 ****
        |   the world-wide-web at http://www.gnu.org/copyleft/gpl.html         |
        +----------------------------------------------------------------------+
!       | Authors: Antonio F. Cano Damas <antoniofcano at telefonica.net>         |
        |          miguel Development Team                                     |
        |                       <e-learning-desarrollo at listas.hispalinux.es>   |
--- 22,26 ----
        |   the world-wide-web at http://www.gnu.org/copyleft/gpl.html         |
        +----------------------------------------------------------------------+
!       | Authors: Antonio F. Cano Damas <antonio at igestec.com>                 |
        |          miguel Development Team                                     |
        |                       <e-learning-desarrollo at listas.hispalinux.es>   |
***************
*** 47,51 ****
   * Utiliza la libreria phphtmllib.
   *
!  * @author Antonio F. Cano Damas  <antoniofcano at telefonica.net>
   * @author miguel development team <e-learning-desarrollo at listas.hispalinux.es>
   * @package miguel base
--- 47,51 ----
   * Utiliza la libreria phphtmllib.
   *
!  * @author Antonio F. Cano Damas  <antonio at igestec.com>
   * @author miguel development team <e-learning-desarrollo at listas.hispalinux.es>
   * @package miguel base
***************
*** 81,84 ****
--- 81,85 ----
                                                                     $arr_data[$i]['folder_date'],
                                                                     $arr_data[$i]['folder_autor'],
+                                                                    $arr_data[$i]['folder_user_id'],
                                                                     0,
                                                                     $arr_data[$i]['folder_count_element'],
***************
*** 100,103 ****
--- 101,105 ----
                                                                     $arr_data[$i]['document_date'],
                                                                     $arr_data[$i]['document_autor'],
+                                                                    $arr_data[$i]['document_user_id'],
                                                                     0,
                                                                     $arr_data[$i]['document_size'],
***************
*** 175,180 ****
          }
  
!         function addDocumentInfo($_id, $_name, $_date, $_owner, $_downs, $_size, $_visible=1, $_lock=1, $_share=1, $_folder = false)
          {
                  $row = html_tr();
  
--- 177,193 ----
          }
  
!         function addDocumentInfo($_id, $_name, $_date, $_owner, $_owner_id, $_downs, $_size, $_visible=1, $_lock=1, $_share=1, $_folder = false)
          {
+                 $user_id = $this->getViewVariable('user_id');
+                 $profile_id = $this->getViewVariable('profile_id');
+                 //If not Admin, teacher or tutor
+                 if ( $profile_id >= 4) {
+                     //Test ownership and visibility
+                     if ( ( $user_id != $_owner_id ) && ($_visible == 0 ) ) {
+                         return ;
+                     }
+                 }
+ 
+                 //Necesito dos clases: una para visible y otra para invisible. La de invisible es para diferenciar en la vista del propietario o administrador
                  $row = html_tr();
  
***************
*** 213,216 ****
--- 226,267 ----
                  $elem8->set_tag_attribute('align', 'center');
  
+                 //---------------- TEST LOCK ---------------------------------------
+                 if ( ($_lock == 0) && ($profile_id >= 4) ){
+                     $elem9 = html_td('ptabla03', '', _HTML_SPACE);
+                     $elem9->set_tag_attribute('align', 'center');
+ 
+                     $elem10 = html_td('ptabla03', '', _HTML_SPACE);
+                     $elem10->set_tag_attribute('align', 'center');
+ 
+                     $elem11 = html_td('ptabla03', '', _HTML_SPACE);
+                     $elem11->set_tag_attribute('align', 'center');
+ 
+                     $elem12 = html_td('ptabla03', '', _HTML_SPACE);
+                     $elem12->set_tag_attribute('align', 'center');
+ 
+                     $elem13 = html_td('ptabla03', '', _HTML_SPACE);
+                     $elem13->set_tag_attribute('align', 'center');
+ 
+                     $elem14 = html_td('ptabla03', '', _HTML_SPACE);
+                     $elem14->set_tag_attribute('align', 'center');
+                   
+                     $row->add($elem1);
+                     $row->add($elem2);
+                     $row->add($elem3);
+                     $row->add($elem4);
+                     $row->add($elem5);
+                     $row->add($elem6);
+                     $row->add($elem7);
+                     $row->add($elem8);
+                     $row->add($elem9);
+                     $row->add($elem10);
+                     $row->add($elem11);
+                     $row->add($elem12);
+                     $row->add($elem13);
+                     $row->add($elem14);
+ 
+                     return $row;
+                 }
+ 
                  //----------------- COMMON OPERATIONS ------------------------------
                  $_fid = $this->getViewVariable('folder_id');
***************
*** 267,285 ****
  
                  if( !$_folder ) {
!                     if ($_lock == 0) {
!                         $status= 'lock';
!                         $icon='lock.png';
!                         $tooltip='Bloquear';
                      } else {
!                         $status='unlock';
!                         $icon='unlock.png';
!                         $tooltip='Desbloqear';
                      }
-                     $status = 'status='.$status.'&id=';
-                     $img = $this->imag_alone(Util::format_URLPath('filemanager/index.php',$status.$_id),
-                                              Theme::getThemeImagePath('filemanager/'.$icon), agt($tooltip));
- 
                      $elem13 = html_td('ptabla03', '', $img);
                      $elem13->set_tag_attribute('align', 'center');
                      if ($_share == 0) {
                          $status= 'share';
--- 318,341 ----
  
                  if( !$_folder ) {
!                     //--------- ONLY TEACHER, TUTOR OR ADMIN CAN LOCK FILES ----------------
!                     if ($profile_id < 4) {
!                         if ($_lock == 0) {
!                             $status= 'lock';
!                             $icon='lock.png';
!                             $tooltip='Bloquear';
!                         } else {
!                             $status='unlock';
!                             $icon='unlock.png';
!                             $tooltip='Desbloqear';
!                         }
!                         $status = 'status='.$status.'&id=';
!                         $img = $this->imag_alone(Util::format_URLPath('filemanager/index.php',$status.$_id),
!                                                  Theme::getThemeImagePath('filemanager/'.$icon), agt($tooltip));
                      } else {
!                         $img = _HTML_SPACE;
                      }
                      $elem13 = html_td('ptabla03', '', $img);
                      $elem13->set_tag_attribute('align', 'center');
+ 
                      if ($_share == 0) {
                          $status= 'share';



From nobody at sheep.berlios.de  Fri Aug 13 20:04:56 2004
From: nobody at sheep.berlios.de (antoniofcano)
Date: Fri, 13 Aug 2004 20:04:56 +0200
Subject: [Migueloo-cvs] migueloo/modules/filemanager/model/classes miguel_mfilemanager.class.php,1.2,1.3
Message-ID: <200408131804.i7DI4u611621@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/filemanager/model/classes
In directory sheep:/tmp/cvs-serv21897/model/classes

Modified Files:
	miguel_mfilemanager.class.php 
Log Message:
Improved view restriction (visibility, lock, ...) tests


Index: miguel_mfilemanager.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/filemanager/model/classes/miguel_mfilemanager.class.php,v
retrieving revision 1.2
retrieving revision 1.3
diff -C2 -d -r1.2 -r1.3
*** miguel_mfilemanager.class.php	12 Aug 2004 11:33:55 -0000	1.2
--- miguel_mfilemanager.class.php	13 Aug 2004 18:04:54 -0000	1.3
***************
*** 22,26 ****
        |   the world-wide-web at http://www.gnu.org/copyleft/gpl.html         |
        +----------------------------------------------------------------------+
!       | Authors: Antonio F. Cano Damas <antoniofcano at telefonica.net>         |
        |          miguel Development Team                                     |
        |                       <e-learning-desarrollo at listas.hispalinux.es>   |
--- 22,26 ----
        |   the world-wide-web at http://www.gnu.org/copyleft/gpl.html         |
        +----------------------------------------------------------------------+
!       | Authors: Antonio F. Cano Damas <antonio at igestec.com>                 |
        |          miguel Development Team                                     |
        |                       <e-learning-desarrollo at listas.hispalinux.es>   |
***************
*** 30,34 ****
   * Define la clase base de miguel.
   *
!  * @author Antonio F. Cano Damas <antoniofcano at telefonica.net>
   * @author miguel development team <e-learning-desarrollo at listas.hispalinux.es>
   * @package miguel base
--- 30,34 ----
   * Define la clase base de miguel.
   *
!  * @author Antonio F. Cano Damas <antonio at igestec.com>
   * @author miguel development team <e-learning-desarrollo at listas.hispalinux.es>
   * @package miguel base
***************
*** 59,62 ****
--- 59,63 ----
                                    'document_date' => $document[$i]['fm_document.date_publish'],
                                    'document_autor' => $this->_getNameFromUser($document[$i]['fm_document.user_id']),
+                                   'document_user_id' => $document[$i]['fm_document.user_id'],
                                    'document_visible' => $document[$i]['fm_document.document_visible'],
                                    'document_lock' => $document[$i]['fm_document.document_lock'],
***************
*** 111,114 ****
--- 112,116 ----
                                    'folder_count_element' => $fileCount + $currentFolderCount,
                                    'folder_autor' => $this->_getNameFromUser($folder[$i]['fm_folder.user_id']),
+                                   'folder_user_id' => $folder[$i]['fm_folder.user_id'],
                                    'folder_visible' => $folder[$i]['fm_folder.folder_visible']
                                  );
***************
*** 118,121 ****
--- 120,139 ----
      }
  
+     function getFolderTree( $current_course, $current_folder_id = 0 )
+     {
+         $folderList = $this->getFolderList($current_course, $current_folder_id);
+ 
+         // recursive operation if subdirectories exist
+         $folderCount = sizeof($folderList);
+         if ( $folderCount > 0 ) {
+             for ($i = 0 ; $i < $folderCount ; $i++ ) {
+ //                $subFolderList = $this->getFolderTree( $current_course, $folderList[$i]['folder_id'] ) ;             // function recursivity
+ //                $folderList  =  array_merge( $folderList , $subFolderList ) ; // data merge
+                   Debug::oneVar( $folderList[$i]['folder_id'] );
+             }
+         }
+         return $folderList;
+     }
+ 
      //Maqueta
      function getFolderId( $course_id )
***************
*** 177,181 ****
          $documentID = $this->Insert('fm_document',
                                   'document_mime, document_name, user_id, document_size, date_publish, document_visible, document_lock, document_share',
!                                  "$document_mime, $document_name, $user_id, $size, $now,0,0,0");
  
          if ($this->hasError()) {
--- 195,199 ----
          $documentID = $this->Insert('fm_document',
                                   'document_mime, document_name, user_id, document_size, date_publish, document_visible, document_lock, document_share',
!                                  "$document_mime, $document_name, $user_id, $size, $now,0,1,0");
  
          if ($this->hasError()) {



From nobody at sheep.berlios.de  Sun Aug 15 17:08:27 2004
From: nobody at sheep.berlios.de (antoniofcano)
Date: Sun, 15 Aug 2004 17:08:27 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/model/classes/ddbb base_ddbbdata.class.php,1.3,1.4
Message-ID: <200408151508.i7FF8R609566@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/ddbb
In directory sheep:/tmp/cvs-serv22390

Modified Files:
	base_ddbbdata.class.php 
Log Message:
Correct a bug with Update operations and 1/0 states


Index: base_ddbbdata.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/ddbb/base_ddbbdata.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_ddbbdata.class.php	6 Aug 2004 10:23:09 -0000	1.3
--- base_ddbbdata.class.php	15 Aug 2004 15:08:25 -0000	1.4
***************
*** 24,28 ****
        | Authors: Jesus A. Martinez Cerezal <jamarcer at inicia.es>              |
        |          miguel Development Team                                     |
!       |                       <e-learning-desarrollo at listas.hispalinux.es>   |      
        +----------------------------------------------------------------------+
  */
--- 24,28 ----
        | Authors: Jesus A. Martinez Cerezal <jamarcer at inicia.es>              |
        |          miguel Development Team                                     |
!       |                       <e-learning-desarrollo at listas.hispalinux.es>   |
        +----------------------------------------------------------------------+
[...1115 lines suppressed...]
!                                 while (!$rs->EOF) {
!                                         $ret[] = $rs->fields;
!                                         $rs->MoveNext();
!                                 }
!                         }
!                 }
!                 return $ret;
!           }
! 
!           /**
!          * Ejecuta contra la base de datos la sentencia SQL generada.
!          * @access private
!      */
!         function _getLastInserted()
!         {
!                 return $this->ado_con->Insert_ID();
!           }
  }
! ?>
\ No newline at end of file



From nobody at sheep.berlios.de  Sun Aug 15 17:10:21 2004
From: nobody at sheep.berlios.de (antoniofcano)
Date: Sun, 15 Aug 2004 17:10:21 +0200
Subject: [Migueloo-cvs] migueloo/modules/filemanager/control/classes miguel_cfilemanager.class.php,1.3,1.4
Message-ID: <200408151510.i7FFAL609609@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/filemanager/control/classes
In directory sheep:/tmp/cvs-serv22666/control/classes

Modified Files:
	miguel_cfilemanager.class.php 
Log Message:
Added Move (File & Folder) and Delete file operations


Index: miguel_cfilemanager.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/filemanager/control/classes/miguel_cfilemanager.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** miguel_cfilemanager.class.php	13 Aug 2004 18:04:54 -0000	1.3
--- miguel_cfilemanager.class.php	15 Aug 2004 15:10:18 -0000	1.4
***************
*** 121,124 ****
--- 121,137 ----
                                              }
                                              break;
+                                         case 'move':
+                                             if($this->getViewVariable('tp') == 'f'){
+                                                 $folder_id = $this->getViewVariable('id');
+                                                 $nuevo_destino = $this->getViewVariable('nuevo_destino');
+                                                 if ( $folder_id != $nuevo_destino ) {
+                                                     $this->obj_data->moveFolder($folder_id, $nuevo_destino);
+                                                 }
+                                                 $folder_id = null; unset( $folder_id );
+                                                 $nuevo_destino = null; unset( $nuevo_destino );
+                                             } else {
+                                                     $this->obj_data->moveFile($course_id, $this->getViewVariable('id'), $this->getViewVariable('folder_id'), $this->getViewVariable('nuevo_destino'));
+                                             }
+                                             break;
                                      }
                                      $status = null;
***************
*** 134,140 ****
  				case 'del':
  					if($this->getViewVariable('tp') == 'f'){
! 						$this->obj_data->deleteFolder($this->getViewVariable('id'));
  					} else {
! 						$this->obj_data->deleteFile($this->getViewVariable('id'));
  					}
                                          break;
--- 147,153 ----
  				case 'del':
  					if($this->getViewVariable('tp') == 'f'){
! 						$this->obj_data->deleteFolder($course_id, $this->getViewVariable('id'));
  					} else {
! 						$this->obj_data->deleteFile($this->getViewVariable('id'), $this->getViewVariable('folder_id'), $course_id);
  					}
                                          break;
***************
*** 174,178 ****
                                  $current_folder_id = 0;
  			}
- //Debug::oneVar( $this->obj_data->getFolderTree( $course_id,  0 ) );
                          /* ----------- DISPLAY FOLDER CONTENT --------------- */
  			$current_folder_info = $this->obj_data->getFolderName( $current_folder_id );
--- 187,190 ----
***************
*** 185,189 ****
  
  			$this->setViewVariable('folder_id', $current_folder_id);
! 			$this->setViewVariable('operation_id', $this->getViewVariable('operation_id') );
  		
                          $this->setViewVariable('user_id', $user_id);
--- 197,208 ----
  
  			$this->setViewVariable('folder_id', $current_folder_id);
! 
!                         $operation_id = $this->getViewVariable('operation_id');
! 			$this->setViewVariable('operation_id', $operation_id );
! 
!                         if ( $operation_id == 'move' ) {
!                             $this->obj_data->getFolderTree( $course_id, $result, 0, 0 );
!                             $this->setViewVariable( 'folderTree', $result ); 
!                         }
  		
                          $this->setViewVariable('user_id', $user_id);



From nobody at sheep.berlios.de  Sun Aug 15 17:10:21 2004
From: nobody at sheep.berlios.de (antoniofcano)
Date: Sun, 15 Aug 2004 17:10:21 +0200
Subject: [Migueloo-cvs] migueloo/modules/filemanager/view/classes miguel_moveform.class.php,NONE,1.1 miguel_vfilemanager.class.php,1.3,1.4
Message-ID: <200408151510.i7FFAL609617@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/filemanager/view/classes
In directory sheep:/tmp/cvs-serv22666/view/classes

Modified Files:
	miguel_vfilemanager.class.php 
Added Files:
	miguel_moveform.class.php 
Log Message:
Added Move (File & Folder) and Delete file operations


--- NEW FILE: miguel_moveform.class.php ---
<?php
/*
      +----------------------------------------------------------------------+
      | miguel base                                                          |
      +----------------------------------------------------------------------+
      | Copyright (c) 2003, miguel Development Team                          |
      +----------------------------------------------------------------------+
      |   This program is free software; you can redistribute it and/or      |
      |   modify it under the terms of the GNU General Public License        |
      |   as published by the Free Software Foundation; either version 2     |
      |   of the License, or (at your option) any later version.             |
      |                                                                      |
      |   This program is distributed in the hope that it will be useful,    |
      |   but WITHOUT ANY WARRANTY; without even the implied warranty of     |
      |   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      |
      |   GNU General Public License for more details.                       |
      |                                                                      |
      |   You should have received a copy of the GNU General Public License  |
      |   along with this program; if not, write to the Free Software        |
      |   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA          |
      |   02111-1307, USA. The GNU GPL license is also available through     |
      |   the world-wide-web at http://www.gnu.org/copyleft/gpl.html         |
      +----------------------------------------------------------------------+
      | Authors: Antonio F. Cano Damas  <antonio at igestec.com  >              |
      |          miguel Development Team                                     |
      |                       <e-learning-desarrollo at listas.hispalinux.es>   |      
      +----------------------------------------------------------------------+
*/
/**
 * Esta clase se encarga de gestionar el formulario para accesos
 * de usuarios a la plataforma miguel
 *
 * @author  Antonio F. Cano Damas  <antonio at igestec.com>
 * @author miguel development team <e-learning-desarrollo at listas.hispalinux.es>     
 * @package miguel filemanager
 * @version 1.0.0
 */
include_once (Util::app_Path("common/view/classes/miguel_formcontent.class.php"));

class miguel_moveForm extends miguel_FormContent
{
    function form_init_elements() 
    {
        //Make ListBox Data
        $folderTreeList = $this->getViewVariable( 'folderTree' );
        $listCount = count( $folderTreeList );
        $dataListBox['/'] = 0;
        for ( $i=0; $i < $listCount; $i++ ) {
              $name = "";
              for ( $countSpace = 0; $countSpace < $folderTreeList[$i][1]; $countSpace++ ) {
                  $name .= _HTML_SPACE . _HTML_SPACE;
              }
              $name .= $folderTreeList[$i][0]['folder_name'];
              $dataListBox["$name"] = $folderTreeList[$i][0]['folder_id'];
        }

        //$list_box = $this->_formatElem("FEListBox", agt("Nuevo Destino"), "newDest", FALSE, "200", "100");
        $list_box = new FEListBox( agt("Nuevo Destino"), false, '200px', '100px');
        $list_box->set_list_data( $dataListBox );
        $this->add_element($list_box);

	$submit = $this->_formatElem("base_SubmitButton", "Aceptar", "submit", agt("Aceptar"));
	$submit->set_attribute('class','p'); 
	$submit->set_attribute('accesskey','e');               
	$this->add_element($submit);

        $folder_id = $this->getViewVariable('folder_id');
        if ( isset($folder_id) ) {
            $this->add_hidden_element("folder_id");	
        }
	$this->add_hidden_element("id"); 
        $this->add_hidden_element("tp");
        $this->add_hidden_element("status");
    }

    function form_init_data() 
    {
        $folder_id = $this->getViewVariable('folder_id');
        if ( isset($folder_id) ) {
            $this->set_hidden_element_value('folder_id', $folder_id );
        }
        $this->set_hidden_element_value("id", $this->getViewVariable('id') );
        $this->set_hidden_element_value("tp", $this->getViewVariable('tp') );
        $this->set_hidden_element_value("status", 'move' );

        return;
    }

    function form() 
    {
        $table = &html_table($this->_width,0,3);
        $table->set_class("mainInterfaceWidth");
        //$table->set_style("border: 1px solid");
        
        $table->add_row($this->_tableRow(agt("Nuevo Destino")));

        $elem = html_td('ptabla03', '', container($this->element_form("Aceptar")));
	$elem->set_tag_attribute('colspan','9');
        $table->add_row($elem);      

        return $table;
    }
}

?>

Index: miguel_vfilemanager.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/filemanager/view/classes/miguel_vfilemanager.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** miguel_vfilemanager.class.php	13 Aug 2004 18:04:54 -0000	1.3
--- miguel_vfilemanager.class.php	15 Aug 2004 15:10:19 -0000	1.4
***************
*** 290,294 ****
  
                  if($_folder){
!                         $status = 'folder_id='.$_fid.'&operation_id=move&tp=f&id=';
                  } else {
                          $status = 'folder_id='.$_fid.'&operation_id=move&tp=d&id=';
--- 290,294 ----
  
                  if($_folder){
!                         $status = 'operation_id=move&tp=f&id=';
                  } else {
                          $status = 'folder_id='.$_fid.'&operation_id=move&tp=d&id=';



From nobody at sheep.berlios.de  Sun Aug 15 17:10:21 2004
From: nobody at sheep.berlios.de (antoniofcano)
Date: Sun, 15 Aug 2004 17:10:21 +0200
Subject: [Migueloo-cvs] migueloo/modules/filemanager/model/classes miguel_mfilemanager.class.php,1.3,1.4
Message-ID: <200408151510.i7FFAL609613@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/filemanager/model/classes
In directory sheep:/tmp/cvs-serv22666/model/classes

Modified Files:
	miguel_mfilemanager.class.php 
Log Message:
Added Move (File & Folder) and Delete file operations


Index: miguel_mfilemanager.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/filemanager/model/classes/miguel_mfilemanager.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** miguel_mfilemanager.class.php	13 Aug 2004 18:04:54 -0000	1.3
--- miguel_mfilemanager.class.php	15 Aug 2004 15:10:19 -0000	1.4
***************
*** 120,137 ****
      }
  
!     function getFolderTree( $current_course, $current_folder_id = 0 )
      {
          $folderList = $this->getFolderList($current_course, $current_folder_id);
  
          // recursive operation if subdirectories exist
!         $folderCount = sizeof($folderList);
!         if ( $folderCount > 0 ) {
!             for ($i = 0 ; $i < $folderCount ; $i++ ) {
! //                $subFolderList = $this->getFolderTree( $current_course, $folderList[$i]['folder_id'] ) ;             // function recursivity
! //                $folderList  =  array_merge( $folderList , $subFolderList ) ; // data merge
!                   Debug::oneVar( $folderList[$i]['folder_id'] );
              }
          }
-         return $folderList;
      }
  
--- 120,138 ----
      }
  
!     function getFolderTree( $current_course, &$result, $profundidad = 0, $current_folder_id = 0 )
      {
          $folderList = $this->getFolderList($current_course, $current_folder_id);
  
          // recursive operation if subdirectories exist
!         if ( $folderList[0]['folder_id'] != null ) {
!             $folderCount = sizeof($folderList);
!             $profundidad++;
!             if ( $folderCount > 0 ) {
!                 for ($i = 0 ; $i < $folderCount ; $i++ ) {
!                       $result[]  =  array($folderList[$i], $profundidad);
!                       $this->getFolderTree( $current_course, $result, $profundidad, $folderList[$i]['folder_id'] ) ;             // function recursivity
!                 }
              }
          }
      }
  
***************
*** 290,332 ****
      }
  
! 	function deleteFile($_id)
! 	{
! 		$show_sql = $this->Select('fm_document', 'document_name', "document_id = $_id");
! 				
! 		if ($this->hasError()) {
! 			$ret_val = null;
! 		} else {
! 			$sql_ret = $this->Delete('fm_document', "document_id = $_id");
! 	
! 			if ($this->hasError()) {
! 				$ret_val = null;
! 			} else {
! 				$file = Util::main_Path('var/data/'.$show_sql[0]['fm_document.document_name']);
  
! 				if(file_exists($file)){
! 					unlink($file);
! 				}
! 			}
! 		}
  		
! 		return ($ret_val);	
! 	}
! 	
! 	function deleteFolder($_id)
! 	{
! 		$sql_ret = $this->Delete('fm_folder', "folder_id = $_id");
  	
! 		if ($this->hasError()) {
! 			$ret_val = null;
! 		} else {
! 			$sql2_ret = $this->Delete('fm_course_document_folder', "folder_id = $_id");
! 			
! 			if ($this->hasError()) {
! 				$ret_val = null;
! 			}
! 		}
! 		
! 		return ($ret_val);	
! 	}
  
  
--- 291,370 ----
      }
  
!     function moveFolder( $_id, $_newParentId ) { 
!         $ret_val = $this->Update('fm_folder', 'folder_parent_id', $_newParentId, 'folder_id = '.$_id);
!       
!         if ($this->hasError() ) {
!             $ret_val = null;
!         } 
!       
!         return ($ret_val);
!     }
  
!     function moveFile( $_courseId, $_id, $_oldParentId, $_newParentId ) {
!         $ret_val = $this->Update('fm_course_document_folder', 'folder_id', $_newParentId, 'folder_id = '.$_oldParentId.' AND document_id = '.$_id.' AND course_id = '.$_courseId);
!       
!         if ($this->hasError() ) {
!             $ret_val = null;
!         } 
!       
!         return ($ret_val);
!     } 
! 
!     function getFileShareCount( $_id ) {
!        $shareCount = $this->SelectCount('fm_course_document_folder', "document_id = $_id");
! 
!        if ($this->hasError()) {
!             $shareCount = 0;
!        }
!        return $shareCount;
! 
!     }
!  
!     function deleteFile($_id, $_folder_id, $_course_id) {
!         $shareCount = $this->getFileShareCount( $_id );
!  
!         $sql_ret = $this->Delete('fm_course_document_folder',"course_id = $_course_id AND folder_id = $_folder_id AND document_id = $_id");
!  
!         if ( $this->hasError() ) {
!             $ret_val = null;
!         } else {
!             if ( $shareCount == 1 ) {
!                 $show_sql = $this->Select('fm_document', 'document_name', 'document_id = ' . $_id);
!                 $sql_ret = $this->Delete('fm_document', "document_id = $_id");
!  
!                 if ($this->hasError()) {
!                     $ret_val = null;
!                 } else {
!                     $file = Util::main_Path('var/data/'.$show_sql[0]['fm_document.document_name']);
!                     if( file_exists($file) ){
!                         unlink($file);
!                     }
!                 } 
!              }
!         } 
  		
!         return ($ret_val);	
!     }
  	
!     function deleteFolder($_current_course, $_id) 
!     {
!         $folderList = $this->getFolderList($_current_course, $_id);
! 
!         // recursive operation if subdirectories exist
!         if ( $folderList[0]['folder_id'] != null ) {
!             $folderCount = sizeof($folderList);
!             if ( $folderCount > 0 ) {
!                 for ($i = 0 ; $i < $folderCount ; $i++ ) {
!                       //Delete Contents
!                       $sql_ret = $this->Delete('fm_course_document_folder', 'course_id = ' . $_current_course . ' AND folder_id = ' . $folderList[$i]['folder_id']);
! 
!                       //Delete Folder 
!                       $sql_ret = $this->Delete('fm_folder', 'folder_id = ' . $folderList[$i]['folder_id']);
! 
!                       $this->deleteFolder( $_current_course, $folderList[$i]['folder_id'] ) ;             // function recursivity
!                 }
!             }
!         }		
!     }
  
  



From nobody at sheep.berlios.de  Sat Aug 21 21:05:02 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:02 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/include/classes debug.class.php,1.3,1.4 errorhandler.class.php,1.3,1.4 file.class.php,1.3,1.4 loghandler.class.php,1.3,1.4 mailer.class.php,1.3,1.4 nls.class.php,1.3,1.4 nls.inc.php,1.3,1.4 theme.class.php,1.3,1.4 theme_20040426.class.php,1.1,1.2 theme_changeit.class.php,1.1,1.2
Message-ID: <200408211905.i7LJ52628935@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/include/classes
In directory sheep:/tmp/cvs-serv22200/modules/andromeda/include/classes

Modified Files:
	debug.class.php errorhandler.class.php file.class.php 
	loghandler.class.php mailer.class.php nls.class.php 
	nls.inc.php theme.class.php theme_20040426.class.php 
	theme_changeit.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: debug.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/classes/debug.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** debug.class.php	6 Aug 2004 10:31:13 -0000	1.3
--- debug.class.php	21 Aug 2004 19:05:00 -0000	1.4
***************
*** 31,35 ****
       Modo de uso
       
!      Debug::msg("Hola", __FILE__, __LINE__);
  */
  include_once(Util::base_Path('include/classes/lensdebug.class.php'));
--- 31,35 ----
       Modo de uso
       
!      Debug::msg('Hola', __FILE__, __LINE__);
  */
  include_once(Util::base_Path('include/classes/lensdebug.class.php'));

Index: errorhandler.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/classes/errorhandler.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** errorhandler.class.php	6 Aug 2004 10:31:13 -0000	1.3
--- errorhandler.class.php	21 Aug 2004 19:05:00 -0000	1.4
***************
*** 55,59 ****
  		error_reporting(E_ALL);
  		//error_reporting  (FATAL + ERROR + WARNING);
! 		set_error_handler(array($this, "processError"));
  	}
  
--- 55,59 ----
  		error_reporting(E_ALL);
  		//error_reporting  (FATAL + ERROR + WARNING);
! 		set_error_handler(array($this, 'processError'));
  	}
  
***************
*** 66,70 ****
  		if (in_array($num_err, $errores_de_usuario)){
  		    // marca de fecha/hora para el registro de error
!     		$dt = date("Y-m-d H:i:s (T)");
  
      		// definir una matriz asociativa de cadenas de error
--- 66,70 ----
  		if (in_array($num_err, $errores_de_usuario)){
  		    // marca de fecha/hora para el registro de error
!     		$dt = date('Y-m-d H:i:s (T)');
  
      		// definir una matriz asociativa de cadenas de error
***************
*** 74,90 ****
  
      		$tipo_error = array (
! 				E_ERROR          => "Error",
! 				E_WARNING        => "Advertencia",
! 				E_PARSE          => "Error de Int?rprete",
! 				E_NOTICE          => "Anotaci?n",
! 				E_CORE_ERROR      => "Error de N?cleo",
! 				E_CORE_WARNING    => "Advertencia de N?cleo",
! 				E_COMPILE_ERROR  => "Error de Compilaci?n",
! 				E_COMPILE_WARNING => "Advertencia de Compilac?n",
! 				E_USER_ERROR      => "Error de Usuario",
! 				E_USER_WARNING    => "Advertencia de Usuario",
! 				E_USER_NOTICE    => "Anotaci?n de Usuario"
  				//,
! 				//E_STRICT          => "Anotaci&oacute;n de tiempo de ejecuci&oacute;n"
      		);
  
--- 74,90 ----
  
      		$tipo_error = array (
! 				E_ERROR          => 'Error',
! 				E_WARNING        => 'Advertencia',
! 				E_PARSE          => 'Error de Int?rprete',
! 				E_NOTICE          => 'Anotaci?n',
! 				E_CORE_ERROR      => 'Error de N?cleo',
! 				E_CORE_WARNING    => 'Advertencia de N?cleo',
! 				E_COMPILE_ERROR  => 'Error de Compilaci?n',
! 				E_COMPILE_WARNING => 'Advertencia de Compilac?n',
! 				E_USER_ERROR      => 'Error de Usuario',
! 				E_USER_WARNING    => 'Advertencia de Usuario',
! 				E_USER_NOTICE    => 'Anotaci?n de Usuario'
  				//,
! 				//E_STRICT          => 'Anotaci&oacute;n de tiempo de ejecuci&oacute;n'
      		);
  

Index: file.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/classes/file.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** file.class.php	6 Aug 2004 10:31:13 -0000	1.3
--- file.class.php	21 Aug 2004 19:05:00 -0000	1.4
***************
*** 119,133 ****
     if ($dh = opendir($dir)) {
         while (false !== ($file = readdir($dh))){
!            if ($file != "." && $file != "..") {
                 $files[] = $file;
             }
         }
         closedir($dh);
!        if(strpos($pattern,".")) {
!            $baseexp=substr($pattern,0,strpos($pattern,"."));
!            $typeexp=substr($pattern,strpos($pattern,".")+1,strlen($pattern));
         }else{
             $baseexp=$pattern;
!            $typeexp="";
         }
         $baseexp=preg_quote($baseexp);
--- 119,133 ----
     if ($dh = opendir($dir)) {
         while (false !== ($file = readdir($dh))){
!            if ($file != '.' && $file != '..') {
                 $files[] = $file;
             }
         }
         closedir($dh);
!        if(strpos($pattern,'.')) {
!            $baseexp=substr($pattern,0,strpos($pattern,'.'));
!            $typeexp=substr($pattern,strpos($pattern,'.')+1,strlen($pattern));
         }else{
             $baseexp=$pattern;
!            $typeexp='';
         }
         $baseexp=preg_quote($baseexp);
***************
*** 138,147 ****
         foreach($files as $file) {
             $filename=basename($file);
!            if(strpos($filename,".")) {
!                $base=substr($filename,0,strpos($filename,"."));
!                $type=substr($filename,strpos($filename,".")+1,strlen($filename));
             }else{
                 $base=$filename;
!                $type="";
             }
             if(preg_match("/^".$baseexp."$/i",$base) && preg_match("/^".$typeexp."$/i",$type))  {
--- 138,147 ----
         foreach($files as $file) {
             $filename=basename($file);
!            if(strpos($filename,'.')) {
!                $base=substr($filename,0,strpos($filename,'.'));
!                $type=substr($filename,strpos($filename,'.')+1,strlen($filename));
             }else{
                 $base=$filename;
!                $type='';
             }
             if(preg_match("/^".$baseexp."$/i",$base) && preg_match("/^".$typeexp."$/i",$type))  {
***************
*** 152,159 ****
         if (count($matches) > 0){
                 while(list($idx,$val) = each($matches)){
!                    if (substr($dir,-1) == "/"){
                         unlink($dir.$val);
                     }else{
!                        unlink($dir."/".$val);
                     }
                 }
--- 152,159 ----
         if (count($matches) > 0){
                 while(list($idx,$val) = each($matches)){
!                    if (substr($dir,-1) == '/'){
                         unlink($dir.$val);
                     }else{
!                        unlink($dir.'/'.$val);
                     }
                 }
***************
*** 163,167 ****
  }
  
! unlink_wc("/path/to/folder/","*.*");
  */
  }
--- 163,167 ----
  }
  
! unlink_wc('/path/to/folder/','*.*');
  */
  }

Index: loghandler.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/classes/loghandler.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** loghandler.class.php	6 Aug 2004 10:31:13 -0000	1.3
--- loghandler.class.php	21 Aug 2004 19:05:00 -0000	1.4
***************
*** 65,73 ****
                		break;
        	      	case 'adodb':
!            	 		$db_conf = array('ddbbSgbd' =>Session::getContextValue("ddbbSgbd"),
!         	    					 'ddbbServer' => Session::getContextValue("ddbbServer"),
! 						    		 'ddbbUser' => Session::getContextValue("ddbbUser"),
! 						    		 'ddbbPassword' => Session::getContextValue("ddbbPassword"),
! 						    		 'ddbbMainDb' => Session::getContextValue("ddbbMainDb"));
          	    	$conf = array('dsn' => $db_conf);
  					$logger = &Log::singleton('adodb', MIGUELBASE_LOG_TABLE, 'miguelOO_'.$ident, $conf);
--- 65,73 ----
                		break;
        	      	case 'adodb':
!            	 		$db_conf = array('ddbbSgbd' =>Session::getContextValue('ddbbSgbd'),
!         	    					 'ddbbServer' => Session::getContextValue('ddbbServer'),
! 						    		 'ddbbUser' => Session::getContextValue('ddbbUser'),
! 						    		 'ddbbPassword' => Session::getContextValue('ddbbPassword'),
! 						    		 'ddbbMainDb' => Session::getContextValue('ddbbMainDb'));
          	    	$conf = array('dsn' => $db_conf);
  					$logger = &Log::singleton('adodb', MIGUELBASE_LOG_TABLE, 'miguelOO_'.$ident, $conf);

Index: mailer.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/classes/mailer.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** mailer.class.php	6 Aug 2004 10:31:13 -0000	1.3
--- mailer.class.php	21 Aug 2004 19:05:00 -0000	1.4
***************
*** 50,60 ****
  
  class miguel_mailer extends phpmailer {
!     var $Host     = "smtp.telefonica.net";
!     var $Mailer   = "smtp";                         // Alternative to IsSMTP()
      var $WordWrap = 75;
  
      var $SMTPAuth = true;     // turn on SMTP authentication
!     var $Username = "";  // SMTP username
!     var $Password = ""; // SMTP password
      
      // Replace the default error_handler
--- 50,60 ----
  
  class miguel_mailer extends phpmailer {
!     var $Host     = 'smtp.telefonica.net';
!     var $Mailer   = 'smtp';                         // Alternative to IsSMTP()
      var $WordWrap = 75;
  
      var $SMTPAuth = true;     // turn on SMTP authentication
!     var $Username = '';  // SMTP username
!     var $Password = ''; // SMTP password
      
      // Replace the default error_handler
***************
*** 65,67 ****
  }
  
! ?>
\ No newline at end of file
--- 65,67 ----
  }
  
! ?>

Index: nls.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/classes/nls.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** nls.class.php	6 Aug 2004 10:31:13 -0000	1.3
--- nls.class.php	21 Aug 2004 19:05:00 -0000	1.4
***************
*** 66,73 ****
          //Debug::oneVar($lang, __FILE__, __LINE__);
          if(empty($lang) || !NLS::isValid($lang)) {
!         	if(Session::getValue("lang") != null) {
! 				$lang = Session::getValue("lang");
! 			} else if(Session::getContextValue("gettext_lang") != null) {
! 				$lang = Session::getContextValue("gettext_lang");
  			} else {
  				$lang = 'es_ES';
--- 66,73 ----
          //Debug::oneVar($lang, __FILE__, __LINE__);
          if(empty($lang) || !NLS::isValid($lang)) {
!         	if(Session::getValue('lang') != null) {
! 				$lang = Session::getValue('lang');
! 			} else if(Session::getContextValue('gettext_lang') != null) {
! 				$lang = Session::getContextValue('gettext_lang');
  			} else {
  				$lang = 'es_ES';
***************
*** 189,196 ****
  	{
  		//$datetime tiene el formato aaaa-mm-dd HH:MM:SS
! 		list($date, $time) = explode(" ", $datetime, 2);
  		
! 		list($year, $month, $day) = explode("-", $date, 3);
! 		list($hour, $minute, $second) = explode(":", $time, 3);
  		
  		return strftime($format, mktime($hour, $minute, $second, $day, $month,$year));
--- 189,196 ----
  	{
  		//$datetime tiene el formato aaaa-mm-dd HH:MM:SS
! 		list($date, $time) = explode(' ', $datetime, 2);
  		
! 		list($year, $month, $day) = explode('-', $date, 3);
! 		list($hour, $minute, $second) = explode(':', $time, 3);
  		
  		return strftime($format, mktime($hour, $minute, $second, $day, $month,$year));

Index: nls.inc.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/classes/nls.inc.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** nls.inc.php	6 Aug 2004 10:31:13 -0000	1.3
--- nls.inc.php	21 Aug 2004 19:05:00 -0000	1.4
***************
*** 206,231 ****
   **/
  
! $nls['encodings']['windows-1256'] = _("Arabic (Windows-1256)");
! $nls['encodings']['ARMSCII-8'] = _("Armenian (ARMSCII-8)");
! $nls['encodings']['ISO-8859-13'] = _("Baltic (ISO-8859-13)");
! $nls['encodings']['ISO-8859-14'] = _("Celtic (ISO-8859-14)");
! $nls['encodings']['ISO-8859-2'] = _("Central European (ISO-8859-2)");
! $nls['encodings']['GB2312'] = _("Chinese Simplified (GB2312)");
! $nls['encodings']['BIG5'] = _("Chinese Traditional (Big5)");
! $nls['encodings']['KOI8-R'] = _("Cyrillic (KOI8-R)");
! $nls['encodings']['windows-1251'] = _("Cyrillic (Windows-1251)");
! $nls['encodings']['KOI8-U'] = _("Cyrillic/Ukrainian (KOI8-U)");
! $nls['encodings']['ISO-8859-7'] = _("Greek (ISO-8859-7)");
! $nls['encodings']['ISO-8859-8-I'] = _("Hebrew (ISO-8859-8-I)");
! $nls['encodings']['ISO-2022-JP'] = _("Japanese (ISO-2022-JP)");
! $nls['encodings']['EUC-KR'] = _("Korean (EUC-KR)");
! $nls['encodings']['ISO-8859-10'] = _("Nordic (ISO-8859-10)");
! $nls['encodings']['ISO-8859-3'] = _("South European (ISO-8859-3)");
! $nls['encodings']['TIS-620'] = _("Thai (TIS-620)");
! $nls['encodings']['ISO-8859-9'] = _("Turkish (ISO-8859-9)");
! $nls['encodings']['UTF-8'] = _("Unicode (UTF-8)");
! $nls['encodings']['VISCII'] = _("Vietnamese (VISCII)");
! $nls['encodings']['ISO-8859-1'] = _("Western (ISO-8859-1)");
! $nls['encodings']['ISO-8859-15'] = _("Western (ISO-8859-15)");
  asort($nls['encodings']);
  
--- 206,231 ----
   **/
  
! $nls['encodings']['windows-1256'] = _('Arabic (Windows-1256)');
! $nls['encodings']['ARMSCII-8'] = _('Armenian (ARMSCII-8)');
! $nls['encodings']['ISO-8859-13'] = _('Baltic (ISO-8859-13)');
! $nls['encodings']['ISO-8859-14'] = _('Celtic (ISO-8859-14)');
! $nls['encodings']['ISO-8859-2'] = _('Central European (ISO-8859-2)');
! $nls['encodings']['GB2312'] = _('Chinese Simplified (GB2312)');
! $nls['encodings']['BIG5'] = _('Chinese Traditional (Big5)');
! $nls['encodings']['KOI8-R'] = _('Cyrillic (KOI8-R)');
! $nls['encodings']['windows-1251'] = _('Cyrillic (Windows-1251)');
! $nls['encodings']['KOI8-U'] = _('Cyrillic/Ukrainian (KOI8-U)');
! $nls['encodings']['ISO-8859-7'] = _('Greek (ISO-8859-7)');
! $nls['encodings']['ISO-8859-8-I'] = _('Hebrew (ISO-8859-8-I)');
! $nls['encodings']['ISO-2022-JP'] = _('Japanese (ISO-2022-JP)');
! $nls['encodings']['EUC-KR'] = _('Korean (EUC-KR)');
! $nls['encodings']['ISO-8859-10'] = _('Nordic (ISO-8859-10)');
! $nls['encodings']['ISO-8859-3'] = _('South European (ISO-8859-3)');
! $nls['encodings']['TIS-620'] = _('Thai (TIS-620)');
! $nls['encodings']['ISO-8859-9'] = _('Turkish (ISO-8859-9)');
! $nls['encodings']['UTF-8'] = _('Unicode (UTF-8)');
! $nls['encodings']['VISCII'] = _('Vietnamese (VISCII)');
! $nls['encodings']['ISO-8859-1'] = _('Western (ISO-8859-1)');
! $nls['encodings']['ISO-8859-15'] = _('Western (ISO-8859-15)');
  asort($nls['encodings']);
  

Index: theme.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/classes/theme.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** theme.class.php	6 Aug 2004 10:31:13 -0000	1.3
--- theme.class.php	21 Aug 2004 19:05:00 -0000	1.4
***************
*** 97,101 ****
  		
  		if(!Theme::existTheme($theme)){
!      		$theme = Session::getContextValue("theme");
       	} 
  		
--- 97,101 ----
  		
  		if(!Theme::existTheme($theme)){
!      		$theme = Session::getContextValue('theme');
       	} 
  		
***************
*** 113,117 ****
  
       	if(!Theme::existTheme($theme)){
!      		$theme = Session::getContextValue("theme");
       	}
  		
--- 113,117 ----
  
       	if(!Theme::existTheme($theme)){
!      		$theme = Session::getContextValue('theme');
       	}
  		
***************
*** 199,203 ****
  //          */
  //        function getThemeUser($_uid){
! //                $getTheme = mysql_query("SELECT theme FROM " . $GLOBALS['mysqlMainDb'] . ".user WHERE user_id='$_uid'");
  //                while ($mythemeuser = mysql_fetch_array($getTheme)){
  //                        $ThemeUser=$mythemeuser[0];
--- 199,203 ----
  //          */
  //        function getThemeUser($_uid){
! //                $getTheme = mysql_query('SELECT theme FROM ' . $GLOBALS['mysqlMainDb'] . ".user WHERE user_id='$_uid'");
  //                while ($mythemeuser = mysql_fetch_array($getTheme)){
  //                        $ThemeUser=$mythemeuser[0];

Index: theme_20040426.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/classes/theme_20040426.class.php,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** theme_20040426.class.php	6 Aug 2004 10:31:13 -0000	1.1
--- theme_20040426.class.php	21 Aug 2004 19:05:00 -0000	1.2
***************
*** 198,202 ****
  //          */
  //        function getThemeUser($_uid){
! //                $getTheme = mysql_query("SELECT theme FROM " . $GLOBALS['mysqlMainDb'] . ".user WHERE user_id='$_uid'");
  //                while ($mythemeuser = mysql_fetch_array($getTheme)){
  //                        $ThemeUser=$mythemeuser[0];
--- 198,202 ----
  //          */
  //        function getThemeUser($_uid){
! //                $getTheme = mysql_query('SELECT theme FROM ' . $GLOBALS['mysqlMainDb'] . ".user WHERE user_id='$_uid'");
  //                while ($mythemeuser = mysql_fetch_array($getTheme)){
  //                        $ThemeUser=$mythemeuser[0];

Index: theme_changeit.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/classes/theme_changeit.class.php,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** theme_changeit.class.php	6 Aug 2004 10:31:13 -0000	1.1
--- theme_changeit.class.php	21 Aug 2004 19:05:00 -0000	1.2
***************
*** 187,191 ****
  //          */
  //        function getThemeUser($_uid){
! //                $getTheme = mysql_query("SELECT theme FROM " . $GLOBALS['mysqlMainDb'] . ".user WHERE user_id='$_uid'");
  //                while ($mythemeuser = mysql_fetch_array($getTheme)){
  //                        $ThemeUser=$mythemeuser[0];
--- 187,191 ----
  //          */
  //        function getThemeUser($_uid){
! //                $getTheme = mysql_query('SELECT theme FROM ' . $GLOBALS['mysqlMainDb'] . ".user WHERE user_id='$_uid'");
  //                while ($mythemeuser = mysql_fetch_array($getTheme)){
  //                        $ThemeUser=$mythemeuser[0];



From nobody at sheep.berlios.de  Sat Aug 21 21:05:03 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:03 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/include/error/control/classes base_cerror.class.php,1.3,1.4
Message-ID: <200408211905.i7LJ53628946@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/include/error/control/classes
In directory sheep:/tmp/cvs-serv22200/modules/andromeda/include/error/control/classes

Modified Files:
	base_cerror.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: base_cerror.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/error/control/classes/base_cerror.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_cerror.class.php	6 Aug 2004 10:38:42 -0000	1.3
--- base_cerror.class.php	21 Aug 2004 19:05:01 -0000	1.4
***************
*** 73,81 ****
  	function processPetition() 
  	{
! 		//$this->addNavElement(Util::format_URLPath($this->url), "Volver");
! 		//$this->addNavElement(Util::format_URLPath("base/include/error/index.php"), "Error");
! 		$this->setPageTitle("miguel Error Page");
! 		$this->setMessage("Detectado un error.");
! 		$this->setHelp("");
  		
  		$this->setViewVariable('str_error', $this->str_error);
--- 73,81 ----
  	function processPetition() 
  	{
! 		//$this->addNavElement(Util::format_URLPath($this->url), 'Volver');
! 		//$this->addNavElement(Util::format_URLPath('base/include/error/index.php'), 'Error');
! 		$this->setPageTitle('miguel Error Page');
! 		$this->setMessage('Detectado un error.');
! 		$this->setHelp('');
  		
  		$this->setViewVariable('str_error', $this->str_error);



From nobody at sheep.berlios.de  Sat Aug 21 21:05:02 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:02 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/include/error index.php,1.3,1.4
Message-ID: <200408211905.i7LJ52628937@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/include/error
In directory sheep:/tmp/cvs-serv22200/modules/andromeda/include/error

Modified Files:
	index.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: index.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/error/index.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** index.php	6 Aug 2004 10:31:13 -0000	1.3
--- index.php	21 Aug 2004 19:05:00 -0000	1.4
***************
*** 27,32 ****
  */
  //S?lo para desarrollo
! include_once ("../../../common/miguel_base.inc.php");
! include_once (Util::app_Path("base/include/error/control/classes/base_cerror.class.php"));
  
  $miguel = new base_CError('Literal de ejemplo');
--- 27,32 ----
  */
  //S?lo para desarrollo
! include_once ('../../../common/miguel_base.inc.php');
! include_once (Util::app_Path('base/include/error/control/classes/base_cerror.class.php'));
  
  $miguel = new base_CError('Literal de ejemplo');



From nobody at sheep.berlios.de  Sat Aug 21 21:05:04 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:04 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/model/classes/ddbb base_model.class.php,1.1,1.2
Message-ID: <200408211905.i7LJ54628959@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/ddbb
In directory sheep:/tmp/cvs-serv22200/modules/andromeda/model/classes/ddbb

Modified Files:
	base_model.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: base_model.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/ddbb/base_model.class.php,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** base_model.class.php	6 Aug 2004 10:23:09 -0000	1.1
--- base_model.class.php	21 Aug 2004 19:05:01 -0000	1.2
***************
*** 35,39 ****
   *
   */ 
! include_once(MIGUELBASE_DIR."model/classes/ddbb/base_ddbberror.class.php");
  
  /**
--- 35,39 ----
   *
   */ 
! include_once(MIGUELBASE_DIR.'model/classes/ddbb/base_ddbberror.class.php');
  
  /**
***************
*** 100,104 ****
  	{
  		//Include database access class
! 		require_once Util::base_Path("model/classes/ddbb/base_ddbbdata.class.php");
  		//Instanciamos la clase responsable
  		$this->obj_data = new base_ddbbData();
--- 100,104 ----
  	{
  		//Include database access class
! 		require_once Util::base_Path('model/classes/ddbb/base_ddbbdata.class.php');
  		//Instanciamos la clase responsable
  		$this->obj_data = new base_ddbbData();
***************
*** 327,331 ****
      function log($message, $priority)
      {	
!     	include_once(Util::base_Path("include/classes/loghandler.class.php"));
    		LogHandler::log($message, $this->str_moduleName.'_controller', $priority);
      }
--- 327,331 ----
      function log($message, $priority)
      {	
!     	include_once(Util::base_Path('include/classes/loghandler.class.php'));
    		LogHandler::log($message, $this->str_moduleName.'_controller', $priority);
      }



From nobody at sheep.berlios.de  Sat Aug 21 21:05:03 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:03 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/include/error/view/classes base_verror.class.php,1.3,1.4
Message-ID: <200408211905.i7LJ53628949@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/include/error/view/classes
In directory sheep:/tmp/cvs-serv22200/modules/andromeda/include/error/view/classes

Modified Files:
	base_verror.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: base_verror.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/error/view/classes/base_verror.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_verror.class.php	9 Aug 2004 22:09:03 -0000	1.3
--- base_verror.class.php	21 Aug 2004 19:05:01 -0000	1.4
***************
*** 43,47 ****
  	 * @access private
  	 */
! 	var $gettext_domain = "error"; 
  
  	/**
--- 43,47 ----
  	 * @access private
  	 */
! 	var $gettext_domain = 'error'; 
  
  	/**
***************
*** 67,80 ****
  
  		$main = html_div();
! 		$main->set_id("content");
  		
! 		$title = html_h2("Se ha producido un error");
! 		$title->set_tag_attribute("class", "warncolor");
  		$main->add($title);
  		
  		//Puede no estar definido el contexto
! 		$width = Session::getContextValue("mainInterfaceWidth");
  		if(!isset($width)) {
! 			$width = "100%";
  		} 
  		$table = html_table($width,0,1,0);
--- 67,80 ----
  
  		$main = html_div();
! 		$main->set_id('content');
  		
! 		$title = html_h2('Se ha producido un error');
! 		$title->set_tag_attribute('class', 'warncolor');
  		$main->add($title);
  		
  		//Puede no estar definido el contexto
! 		$width = Session::getContextValue('mainInterfaceWidth');
  		if(!isset($width)) {
! 			$width = '100%';
  		} 
  		$table = html_table($width,0,1,0);
***************
*** 83,91 ****
  		$error = $this->getViewVariable('str_error');
  		if(!isset($error)) {
! 			$error = "No error code was given";
  		} 
  		
! 		$row = html_td("warncolor", "",$error);
! 		$row->set_tag_attribute("align", "center");
  		$table->add_row($row);
  		
--- 83,91 ----
  		$error = $this->getViewVariable('str_error');
  		if(!isset($error)) {
! 			$error = 'No error code was given';
  		} 
  		
! 		$row = html_td('warncolor', '',$error);
! 		$row->set_tag_attribute('align', 'center');
  		$table->add_row($row);
  		
***************
*** 93,98 ****
  		$url = $this->getViewVariable('str_url');
  		if(isset($url)) {
! 			$row = html_td("", "",html_a($url, agt('Volver')));
! 			$row->set_tag_attribute("align", "center");
  			$table->add_row($row);
  		} 
--- 93,98 ----
  		$url = $this->getViewVariable('str_url');
  		if(isset($url)) {
! 			$row = html_td('', '',html_a($url, agt('Volver')));
! 			$row->set_tag_attribute('align', 'center');
  			$table->add_row($row);
  		} 



From nobody at sheep.berlios.de  Sat Aug 21 21:05:04 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:04 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/model/classes/fs fileDisplayLib.inc.php,1.3,1.4 fileManageLib.inc.php,1.3,1.4 filetools.class.php,1.3,1.4 miguel_dirtemp.class.php,1.3,1.4
Message-ID: <200408211905.i7LJ54628963@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/fs
In directory sheep:/tmp/cvs-serv22200/modules/andromeda/model/classes/fs

Modified Files:
	fileDisplayLib.inc.php fileManageLib.inc.php 
	filetools.class.php miguel_dirtemp.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: fileDisplayLib.inc.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/fs/fileDisplayLib.inc.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** fileDisplayLib.inc.php	6 Aug 2004 10:23:09 -0000	1.3
--- fileDisplayLib.inc.php	21 Aug 2004 19:05:02 -0000	1.4
***************
*** 81,133 ****
  	/*** Tables initiliasation ***/
  	if (!$type || !$image) {
!                 $type['text'] = array( "txt" );
! 		$type['word'      ] = array("doc", "dot", "rtf", "mcw", "wps", "sxw", "txt" );
! 		$type['web'       ] = array( "htm", "html", "htx", "xml", "xsl");
!                 $type['web_css'] = array("css");
!                 $type['web_php'] = array("php", "php3", "phps", "php3s");
!                 $type['web_pl'] = array("pl", "pls");
!                 $type['web_js'] = array("js");
!                 $type['web_flash'] = array("swf");
!                 $type['image_jpg'] = array("png", "jpg", "jpeg" );
!                 $type['image_bmp'] = array("bmp");
!                 $type['image_gif'] = array("gif");
! 		$type['audio'     ] = array("wav", "mp2", "mp4", "vqf", "ogg");
!                 $type['audio_mp3'] = array("mp3");
!                 $type['audio_mid'] = array("mid", "midi");
! 		$type['excel'     ] = array("sxc", "stc", "sdc", "vor", "xls", "xlt", "xls", "xlt");
! 		$type['compressed'] = array("zip", "tar", "gz", "gz", "bz", "bz2");
!                 $type['compressed_rar'] = array("rar");
! 		$type['code'      ] = array("cpp", "c", "java" );
! 		$type['acrobat'   ] = array("pdf", "ps");
! 		$type['powerpoint'] = array("ppt", "pps", "sxi", "sti", "sda", "sdd");
!                 $type['video_avi'] = array("avi");
!                 $type['video_mpeg'] = array("mpg", "mpeg");
!                 $type['video_mov'] = array("mov");
!                 $type['video_ram'] = array("ram");
  
!                 $image['text'] = "mime_txt.png";
! 		$image['word'      ] = "mime_doc.png";
! 		$image['web'       ] = "mime_html.png";
!                 $image['web_css'] = "mime_css.png";
!                 $image['web_php'] = "mime_php.png";
!                 $image['web_pl'] = "mime_pl.png";
!                 $image['web_js'] = "mime_js.png";
!                 $image['web_flash'] = "mime_flash.png";
! 		$image['image_jpg'     ] = "mime_jpg.png";
!                 $image['image_bmp'] = "mime_bmp.png";
!                 $image['image_gif'] = "mime_gif.png"; 
! 		$image['audio'     ] = "mime_wav.png";
!                 $image['audio_mp3'] = "mime_mp3.png";
!                 $image['audio_mid'] = "mime_mid.png";
! 		$image['excel'     ] = "mime_xls.png";
! 		$image['compressed'] = "mime_zip.png";
!                 $image['compressed_rar'] = "mime_rar.png";
! 		$image['code'      ] = "mime_exe.png";
! 		$image['acrobat'   ] = "mime_pdf.png";
! 		$image['powerpoint'] = "mime_ppt.png";
!                 $image['video_avi'] = "mime_avi.png";
!                 $image['video_mpeg'] = "mime_mpeg.png";
!                 $image['video_mov'] = "mime_mov.png";
!                 $image['video_ram'] = "mime_ram.png";
  	}
  
--- 81,133 ----
  	/*** Tables initiliasation ***/
  	if (!$type || !$image) {
!                 $type['text'] = array( 'txt' );
! 		$type['word'      ] = array('doc', 'dot', 'rtf', 'mcw', 'wps', 'sxw', 'txt' );
! 		$type['web'       ] = array( 'htm', 'html', 'htx', 'xml', 'xsl');
!                 $type['web_css'] = array('css');
!                 $type['web_php'] = array('php', 'php3', 'phps', 'php3s');
!                 $type['web_pl'] = array('pl', 'pls');
!                 $type['web_js'] = array('js');
!                 $type['web_flash'] = array('swf');
!                 $type['image_jpg'] = array('png', 'jpg', 'jpeg' );
!                 $type['image_bmp'] = array('bmp');
!                 $type['image_gif'] = array('gif');
! 		$type['audio'     ] = array('wav', 'mp2', 'mp4', 'vqf', 'ogg');
!                 $type['audio_mp3'] = array('mp3');
!                 $type['audio_mid'] = array('mid', 'midi');
! 		$type['excel'     ] = array('sxc', 'stc', 'sdc', 'vor', 'xls', 'xlt', 'xls', 'xlt');
! 		$type['compressed'] = array('zip', 'tar', 'gz', 'gz', 'bz', 'bz2');
!                 $type['compressed_rar'] = array('rar');
! 		$type['code'      ] = array('cpp', 'c', 'java' );
! 		$type['acrobat'   ] = array('pdf', 'ps');
! 		$type['powerpoint'] = array('ppt', 'pps', 'sxi', 'sti', 'sda', 'sdd');
!                 $type['video_avi'] = array('avi');
!                 $type['video_mpeg'] = array('mpg', 'mpeg');
!                 $type['video_mov'] = array('mov');
!                 $type['video_ram'] = array('ram');
  
!                 $image['text'] = 'mime_txt.png';
! 		$image['word'      ] = 'mime_doc.png';
! 		$image['web'       ] = 'mime_html.png';
!                 $image['web_css'] = 'mime_css.png';
!                 $image['web_php'] = 'mime_php.png';
!                 $image['web_pl'] = 'mime_pl.png';
!                 $image['web_js'] = 'mime_js.png';
!                 $image['web_flash'] = 'mime_flash.png';
! 		$image['image_jpg'     ] = 'mime_jpg.png';
!                 $image['image_bmp'] = 'mime_bmp.png';
!                 $image['image_gif'] = 'mime_gif.png'; 
! 		$image['audio'     ] = 'mime_wav.png';
!                 $image['audio_mp3'] = 'mime_mp3.png';
!                 $image['audio_mid'] = 'mime_mid.png';
! 		$image['excel'     ] = 'mime_xls.png';
! 		$image['compressed'] = 'mime_zip.png';
!                 $image['compressed_rar'] = 'mime_rar.png';
! 		$image['code'      ] = 'mime_exe.png';
! 		$image['acrobat'   ] = 'mime_pdf.png';
! 		$image['powerpoint'] = 'mime_ppt.png';
!                 $image['video_avi'] = 'mime_avi.png';
!                 $image['video_mpeg'] = 'mime_mpeg.png';
!                 $image['video_mov'] = 'mime_mov.png';
!                 $image['video_ram'] = 'mime_ram.png';
  	}
  
***************
*** 143,147 ****
  	}
  
! 	return "mime_defaut.png";
  }
  
--- 143,147 ----
  	}
  
! 	return 'mime_defaut.png';
  }
  
***************
*** 157,167 ****
  function format_file_size($fileSize) {
  	if($fileSize >= 1073741824) {
! 		$fileSize = round($fileSize / 1073741824 * 100) / 100 . "g";
  	} elseif($fileSize >= 1048576) {
! 		$fileSize = round($fileSize / 1048576 * 100) / 100 . "m";
  	} elseif($fileSize >= 1024) {
! 		$fileSize = round($fileSize / 1024 * 100) / 100 . "k";
  	} else {
! 		$fileSize = $fileSize . "b";
  	}
  
--- 157,167 ----
  function format_file_size($fileSize) {
  	if($fileSize >= 1073741824) {
! 		$fileSize = round($fileSize / 1073741824 * 100) / 100 . 'g';
  	} elseif($fileSize >= 1048576) {
! 		$fileSize = round($fileSize / 1048576 * 100) / 100 . 'm';
  	} elseif($fileSize >= 1024) {
! 		$fileSize = round($fileSize / 1024 * 100) / 100 . 'k';
  	} else {
! 		$fileSize = $fileSize . 'b';
  	}
  
***************
*** 181,185 ****
  function format_date($fileDate)
  {
! 	return date("d.m.Y", $fileDate);
  }
  
--- 181,185 ----
  function format_date($fileDate)
  {
! 	return date('d.m.Y', $fileDate);
  }
  
***************
*** 196,200 ****
  function format_url($filePath)
  {
! 	$stringArray = explode("/", $filePath);
  
  	for ($i = 0; $i < sizeof($stringArray); $i++) {
--- 196,200 ----
  function format_url($filePath)
  {
! 	$stringArray = explode('/', $filePath);
  
  	for ($i = 0; $i < sizeof($stringArray); $i++) {
***************
*** 202,206 ****
  	}
  
! 	return implode("/",$stringArray);
  }
  
--- 202,206 ----
  	}
  
! 	return implode('/',$stringArray);
  }
  

Index: fileManageLib.inc.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/fs/fileManageLib.inc.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** fileManageLib.inc.php	6 Aug 2004 10:23:09 -0000	1.3
--- fileManageLib.inc.php	21 Aug 2004 19:05:02 -0000	1.4
***************
*** 36,52 ****
   // Antonio F. Cano <antoniofcano at telefonica.net>
   // Se pasa la tabla de trabajo como parametro
! function update_db_info($dbTable, $action, $oldPath, $newPath="")
  {
  	/*** DELETE ***/
! 	if ($action == "delete")
  	{
! 		$query = "DELETE FROM " . $dbTable . "
  		WHERE path LIKE \"".$oldPath."%\"";
  	}
  
  	/*** UPDATE ***/
! 	if ($action == "update")
  	{
! 		$query = "UPDATE " . $dbTable . "
  		SET path = CONCAT(\"".$newPath."\", SUBSTRING(path, LENGTH(\"".$oldPath."\")+1) )
  		WHERE path LIKE \"".$oldPath."%\"";
--- 36,52 ----
   // Antonio F. Cano <antoniofcano at telefonica.net>
   // Se pasa la tabla de trabajo como parametro
! function update_db_info($dbTable, $action, $oldPath, $newPath='')
  {
  	/*** DELETE ***/
! 	if ($action == 'delete')
  	{
! 		$query = 'DELETE FROM ' . $dbTable . "
  		WHERE path LIKE \"".$oldPath."%\"";
  	}
  
  	/*** UPDATE ***/
! 	if ($action == 'update')
  	{
! 		$query = 'UPDATE ' . $dbTable . "
  		SET path = CONCAT(\"".$newPath."\", SUBSTRING(path, LENGTH(\"".$oldPath."\")+1) )
  		WHERE path LIKE \"".$oldPath."%\"";
***************
*** 143,147 ****
  		while ($element = readdir($handle) )
  		{
! 			if ( $element == "." || $element == "..")
  			{
  				continue;	// skip current and parent directories
--- 143,147 ----
  		while ($element = readdir($handle) )
  		{
! 			if ( $element == '.' || $element == '..')
  			{
  				continue;	// skip current and parent directories
***************
*** 153,157 ****
  			elseif ( is_dir ($element) )
  			{
! 				$dirToRemove[] = $dirPath."/".$element;
  			}
  		}
--- 153,157 ----
  			elseif ( is_dir ($element) )
  			{
! 				$dirToRemove[] = $dirPath.'/'.$element;
  			}
  		}
***************
*** 187,191 ****
  	$oldFileName = basename($filePath);
  
! 	if (check_name_exist($path."/".$newFileName)
  		&& $newFileName != $oldFileName)
  	{
--- 187,191 ----
  	$oldFileName = basename($filePath);
  
! 	if (check_name_exist($path.'/'.$newFileName)
  		&& $newFileName != $oldFileName)
  	{
***************
*** 198,202 ****
  			&& ereg("[[:print:]]+\.([[:alnum:]]+)$", $olFileName, $extension))
  		{
! 			$newFileName .= ".".$extension[1];
  		}
  		
--- 198,202 ----
  			&& ereg("[[:print:]]+\.([[:alnum:]]+)$", $olFileName, $extension))
  		{
! 			$newFileName .= '.'.$extension[1];
  		}
  		
***************
*** 237,241 ****
  	{
  		$fileName = basename($source);
! 		if ( check_name_exist($target."/".$fileName) )
  		{
  			return false;
--- 237,241 ----
  	{
  		$fileName = basename($source);
! 		if ( check_name_exist($target.'/'.$fileName) )
  		{
  			return false;
***************
*** 245,249 ****
  			if ( is_file($source) )
  			{
! 				copy($source , $target."/".$fileName);
  				unlink($source);
  				return true;
--- 245,249 ----
  			if ( is_file($source) )
  			{
! 				copy($source , $target.'/'.$fileName);
  				unlink($source);
  				return true;
***************
*** 253,257 ****
  			{
  				// check to not copy the directory inside itself
! 				if (ereg("^".$source."*", $target))
  				{
  					return false;
--- 253,257 ----
  			{
  				// check to not copy the directory inside itself
! 				if (ereg('^'.$source.'*', $target))
  				{
  					return false;
***************
*** 288,293 ****
  	// extract directory name - create it at destination - update destination trail
  	$dirName = basename($origDirPath);
! 	mkdir ($destination."/".$dirName, 0775);
! 	$destinationTrail = $destination."/".$dirName;
  
  	chdir ($origDirPath) ;
--- 288,293 ----
  	// extract directory name - create it at destination - update destination trail
  	$dirName = basename($origDirPath);
! 	mkdir ($destination.'/'.$dirName, 0775);
! 	$destinationTrail = $destination.'/'.$dirName;
  
  	chdir ($origDirPath) ;
***************
*** 296,300 ****
  	while ($element = readdir($handle) )
  	{
! 		if ( $element == "." || $element == "..")
  		{
  			continue; // skip the current and parent directories
--- 296,300 ----
  	while ($element = readdir($handle) )
  	{
! 		if ( $element == '.' || $element == '..')
  		{
  			continue; // skip the current and parent directories
***************
*** 302,311 ****
  		elseif ( is_file($element) )
  		{
! 			copy($element, $destinationTrail."/".$element);
  			unlink($element) ;
  		}
  		elseif ( is_dir($element) )
  		{
! 			$dirToCopy[] = $origDirPath."/".$element;
  		}
  	}
--- 302,311 ----
  		elseif ( is_file($element) )
  		{
! 			copy($element, $destinationTrail.'/'.$element);
  			unlink($element) ;
  		}
  		elseif ( is_dir($element) )
  		{
! 			$dirToCopy[] = $origDirPath.'/'.$element;
  		}
  	}
***************
*** 351,356 ****
  	while ($element = readdir($handle) )
  	{
! 		if ( $element == "." || $element == "..") continue;	// skip the current and parent directories
! 		if ( is_dir($element) )	 $dirArray[] = $path."/".$element;
  	}
  
--- 351,356 ----
  	while ($element = readdir($handle) )
  	{
! 		if ( $element == '.' || $element == '..') continue;	// skip the current and parent directories
! 		if ( is_dir($element) )	 $dirArray[] = $path.'/'.$element;
  	}
  
***************
*** 368,372 ****
  	}
  
! 	chdir("..") ;
  
  	return $dirArray ;
--- 368,372 ----
  	}
  
! 	chdir('..') ;
  
  	return $dirArray ;
***************
*** 411,417 ****
  {
      //Aadido por Fernando Acero Martin
!     include_once("../lang/english/trad4all.inc.php");
      include_once("../lang/$language/trad4all.inc.php");
!     include_once("../lang/english/document.inc.php");
      include_once("../lang/$language/document.inc.php");
      //Fin del aadido
--- 411,417 ----
  {
      //Aadido por Fernando Acero Martin
!     include_once('../lang/english/trad4all.inc.php');
      include_once("../lang/$language/trad4all.inc.php");
!     include_once('../lang/english/document.inc.php');
      include_once("../lang/$language/document.inc.php");
      //Fin del aadido
***************
*** 439,447 ****
  			/* compute de the display tab */
  
! 			$tab = "";					// $tab reinitialisation
! 			$depth = substr_count($pathValue, "/");		// The number of nombre '/' indicates the directory deepness
  			for ($h=0; $h<$depth; $h++)
  			{
! 				$tab .= "&nbsp;&nbsp";
  			}
  			$dialogBox .= "<option value=\"$pathValue\">$tab>$dirname\n";
--- 439,447 ----
  			/* compute de the display tab */
  
! 			$tab = '';					// $tab reinitialisation
! 			$depth = substr_count($pathValue, '/');		// The number of nombre '/' indicates the directory deepness
  			for ($h=0; $h<$depth; $h++)
  			{
! 				$tab .= '&nbsp;&nbsp';
  			}
  			$dialogBox .= "<option value=\"$pathValue\">$tab>$dirname\n";
***************
*** 463,467 ****
   * @param  - path (string) - directory path of the one to index
   */
! function form_upload($webDir, $pathServer, $language, $submitGroupWorkUrl="", $extended=true, $zip=false)
  {
      //Aadido por Fernando Acero Martin
--- 463,467 ----
   * @param  - path (string) - directory path of the one to index
   */
! function form_upload($webDir, $pathServer, $language, $submitGroupWorkUrl='', $extended=true, $zip=false)
  {
      //Aadido por Fernando Acero Martin
***************
*** 496,503 ****
  		//Indetec: Utilizamos el formulario de Document.php, ajustando las variables.
  		if ( !isset($titreFile) ) {
! 			$titreFile ="";
  		}
  		if ( !isset($commentFile) ) {
! 			$commentFile ="";
  		}
  
--- 496,503 ----
  		//Indetec: Utilizamos el formulario de Document.php, ajustando las variables.
  		if ( !isset($titreFile) ) {
! 			$titreFile ='';
  		}
  		if ( !isset($commentFile) ) {
! 			$commentFile ='';
  		}
  
***************
*** 603,611 ****
  		$dirId = $fileManage->dirList[$i]['id'];
  		$dspDirName = htmlentities( $dirName );
! 		$cmdDirName = rawurlencode($fileManage->getDir() . $curDirpath . "/" . $dirPath);
  		$dirComment = $fileManage->dirList[$i]['comment'];
  		$dirVisibility = $fileManage->dirList[$i]['visibility'];
  
! 		if ( $dirVisibility == "i" ) {
  			$style=" class=\"invisible\"";
  			if ( !$is_adminOfCourse ) {
--- 603,611 ----
  		$dirId = $fileManage->dirList[$i]['id'];
  		$dspDirName = htmlentities( $dirName );
! 		$cmdDirName = rawurlencode($fileManage->getDir() . $curDirpath . '/' . $dirPath);
  		$dirComment = $fileManage->dirList[$i]['comment'];
  		$dirVisibility = $fileManage->dirList[$i]['visibility'];
  
! 		if ( $dirVisibility == 'i' ) {
  			$style=" class=\"invisible\"";
  			if ( !$is_adminOfCourse ) {
***************
*** 614,618 ****
  		}
  		else {
! 			$style="";
  		}
  
--- 614,618 ----
  		}
  		else {
! 			$style='';
  		}
  
***************
*** 681,690 ****
  		$size        = format_file_size( $fileManage->fileList[$i]['size'] );
  		$date        = format_date( $fileManage->fileList[$i]['date'] );
! 		$pathFileName = format_url( $GLOBALS[currentCourseID] . "/" . $fileManage->modName . $fileManage->fileList[$i]['path'] );
  		$dspFileName = htmlentities( $fileManage->fileList[$i]['titre'] );
  		$commentFile = $fileManage->fileList[$i]['comment'];
  		$visibilityStatus = $fileManage->fileList[$i]['visibility'];
  
! 		if ( $fileManage->modName != "document" ) {
  			$lockStatus = $fileManage->fileList[$i]['lock'];
  			$UIDFile = $fileManage->fileList[$i]['uid'];
--- 681,690 ----
  		$size        = format_file_size( $fileManage->fileList[$i]['size'] );
  		$date        = format_date( $fileManage->fileList[$i]['date'] );
! 		$pathFileName = format_url( $GLOBALS[currentCourseID] . '/' . $fileManage->modName . $fileManage->fileList[$i]['path'] );
  		$dspFileName = htmlentities( $fileManage->fileList[$i]['titre'] );
  		$commentFile = $fileManage->fileList[$i]['comment'];
  		$visibilityStatus = $fileManage->fileList[$i]['visibility'];
  
! 		if ( $fileManage->modName != 'document' ) {
  			$lockStatus = $fileManage->fileList[$i]['lock'];
  			$UIDFile = $fileManage->fileList[$i]['uid'];
***************
*** 695,699 ****
  
  		//Indetec: Elige el estilo de la tupla en funci??n d la visibilidad y el bloqueo.
! 		if ($visibilityStatus == "i") {
  			$style=" class=\"invisible\"";
  			//Si no somos administradores o due??os y es una tupla invisible pasamos a la siguiente
--- 695,699 ----
  
  		//Indetec: Elige el estilo de la tupla en funci??n d la visibilidad y el bloqueo.
! 		if ($visibilityStatus == 'i') {
  			$style=" class=\"invisible\"";
  			//Si no somos administradores o due??os y es una tupla invisible pasamos a la siguiente
***************
*** 764,768 ****
  		echo "</tr>\n";
  		/*** comments ***/
! 		if ( $commentFile != "" ) {
  			$commentFile = htmlentities($commentFile);
  			$commentFile = nl2br($commentFile);
--- 764,768 ----
  		echo "</tr>\n";
  		/*** comments ***/
! 		if ( $commentFile != '' ) {
  			$commentFile = htmlentities($commentFile);
  			$commentFile = nl2br($commentFile);

Index: filetools.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/fs/filetools.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** filetools.class.php	6 Aug 2004 10:23:09 -0000	1.3
--- filetools.class.php	21 Aug 2004 19:05:02 -0000	1.4
***************
*** 20,27 ****
  	function replace_dangerous_char($string)
  	{
! 		$search[]="\/"; $replace[]="-";
! 		$search[]="\\"; $replace[]="-";
! 		$search[]="\|"; $replace[]="-";
! 		$search[]="\""; $replace[]="";
  
  		foreach($search as $key=>$char ) {
--- 20,27 ----
  	function replace_dangerous_char($string)
  	{
! 		$search[]="\/"; $replace[]='-';
! 		$search[]="\\"; $replace[]='-';
! 		$search[]="\|"; $replace[]='-';
! 		$search[]="\""; $replace[]='';
  
  		foreach($search as $key=>$char ) {
***************
*** 45,53 ****
  	function php2phps ($fileName)
  	{
! 		$fileName = ereg_replace(".php$", ".phps", $fileName);
  		//Antonio: Other scripts extensions
! 		$fileName = ereg_replace(".phtml", ".phps", $fileName);
! 		$fileName = ereg_replace(".asp", ".asps", $fileName);
! 		$fileName = ereg_replace(".pl", ".pls", $fileName);
  		return $fileName;
  	}
--- 45,53 ----
  	function php2phps ($fileName)
  	{
! 		$fileName = ereg_replace('.php$', '.phps', $fileName);
  		//Antonio: Other scripts extensions
! 		$fileName = ereg_replace('.phtml', '.phps', $fileName);
! 		$fileName = ereg_replace('.asp', '.asps', $fileName);
! 		$fileName = ereg_replace('.pl', '.pls', $fileName);
  		return $fileName;
  	}
***************
*** 100,104 ****
  
  		while ( $element = @readdir($handle) ) {
! 			if ( $element == "." || $element == "..") {
  				continue; // skip the current and parent directories
  			}
--- 100,104 ----
  
  		while ( $element = @readdir($handle) ) {
! 			if ( $element == '.' || $element == '..') {
  				continue; // skip the current and parent directories
  			}
***************
*** 107,111 ****
  			}
  			if ( @is_dir($element) ) {
! 				$dirList[] = $dirPath . "/" . $element;
  			}
  		}
--- 107,111 ----
  			}
  			if ( @is_dir($element) ) {
! 				$dirList[] = $dirPath . '/' . $element;
  			}
  		}
***************
*** 150,181 ****
  			static $mimeType = array();
  
! 			$mimeType[] = "application/msword";		$extension[] =".doc";
! 			$mimeType[] = "application/rtf";		$extension[] =".rtf";
! 			$mimeType[] = "application/vnd.ms-powerpoint";	$extension[] =".ppt";
! 			$mimeType[] = "application/vnd.ms-excel";	$extension[] =".xls";
! 			$mimeType[] = "application/pdf";		$extension[] =".pdf";
! 			$mimeType[] = "application/postscript";		$extension[] =".ps";
! 			$mimeType[] = "application/mac-binhex40";	$extension[] =".hqx";
! 			$mimeType[] = "application/x-gzip";		$extension[] ="tar.gz";
! 			$mimeType[] = "application/x-shockwave-flash";	$extension[] =".swf";
! 			$mimeType[] = "application/x-stuffit";		$extension[] =".sit";
! 			$mimeType[] = "application/x-tar";		$extension[] =".tar";
! 			$mimeType[] = "application/zip";		$extension[] =".zip";
! 			$mimeType[] = "application/x-tar";		$extension[] =".tar";
! 			$mimeType[] = "text/html";			$extension[] =".htm";
! 			$mimeType[] = "text/plain";			$extension[] =".txt";
! 			$mimeType[] = "text/rtf";			$extension[] =".rtf";
! 			$mimeType[] = "image/gif";			$extension[] =".gif";
! 			$mimeType[] = "image/jpeg";			$extension[] =".jpg";
! 			$mimeType[] = "image/png";			$extension[] =".png";
! 			$mimeType[] = "audio/midi";			$extension[] =".mid";
! 			$mimeType[] = "audio/mpeg";			$extension[] =".mp3";
! 			$mimeType[] = "audio/x-aiff";			$extension[] =".aif";
! 			$mimeType[] = "audio/x-pn-realaudio";		$extension[] =".rm";
! 			$mimeType[] = "audio/x-pn-realaudio-plugin";	$extension[] =".rpm";
! 			$mimeType[] = "audio/x-wav";			$extension[] =".wav";
! 			$mimeType[] = "video/mpeg";			$extension[] =".mpg";
! 			$mimeType[] = "video/quicktime";		$extension[] =".mov";
! 			$mimeType[] = "video/x-msvideo";		$extension[] =".avi";
  
  
--- 150,181 ----
  			static $mimeType = array();
  
! 			$mimeType[] = 'application/msword';		$extension[] ='.doc';
! 			$mimeType[] = 'application/rtf';		$extension[] ='.rtf';
! 			$mimeType[] = 'application/vnd.ms-powerpoint';	$extension[] ='.ppt';
! 			$mimeType[] = 'application/vnd.ms-excel';	$extension[] ='.xls';
! 			$mimeType[] = 'application/pdf';		$extension[] ='.pdf';
! 			$mimeType[] = 'application/postscript';		$extension[] ='.ps';
! 			$mimeType[] = 'application/mac-binhex40';	$extension[] ='.hqx';
! 			$mimeType[] = 'application/x-gzip';		$extension[] ='tar.gz';
! 			$mimeType[] = 'application/x-shockwave-flash';	$extension[] ='.swf';
! 			$mimeType[] = 'application/x-stuffit';		$extension[] ='.sit';
! 			$mimeType[] = 'application/x-tar';		$extension[] ='.tar';
! 			$mimeType[] = 'application/zip';		$extension[] ='.zip';
! 			$mimeType[] = 'application/x-tar';		$extension[] ='.tar';
! 			$mimeType[] = 'text/html';			$extension[] ='.htm';
! 			$mimeType[] = 'text/plain';			$extension[] ='.txt';
! 			$mimeType[] = 'text/rtf';			$extension[] ='.rtf';
! 			$mimeType[] = 'image/gif';			$extension[] ='.gif';
! 			$mimeType[] = 'image/jpeg';			$extension[] ='.jpg';
! 			$mimeType[] = 'image/png';			$extension[] ='.png';
! 			$mimeType[] = 'audio/midi';			$extension[] ='.mid';
! 			$mimeType[] = 'audio/mpeg';			$extension[] ='.mp3';
! 			$mimeType[] = 'audio/x-aiff';			$extension[] ='.aif';
! 			$mimeType[] = 'audio/x-pn-realaudio';		$extension[] ='.rm';
! 			$mimeType[] = 'audio/x-pn-realaudio-plugin';	$extension[] ='.rpm';
! 			$mimeType[] = 'audio/x-wav';			$extension[] ='.wav';
! 			$mimeType[] = 'video/mpeg';			$extension[] ='.mpg';
! 			$mimeType[] = 'video/quicktime';		$extension[] ='.mov';
! 			$mimeType[] = 'video/x-msvideo';		$extension[] ='.avi';
  
  
***************
*** 275,279 ****
  
  			while ($element = @readdir($handle) ) {
! 				if ( $element == "." || $element == "..") {
  					continue;	// skip current and parent directories
  				} elseif ( @is_file($element) ) {
--- 275,279 ----
  
  			while ($element = @readdir($handle) ) {
! 				if ( $element == '.' || $element == '..') {
  					continue;	// skip current and parent directories
  				} elseif ( @is_file($element) ) {
***************
*** 281,285 ****
  				}
  				elseif ( @is_dir ($element) ) {
! 					$dirToRemove[] = $dirPath."/".$element;
  				}
  			}
--- 281,285 ----
  				}
  				elseif ( @is_dir ($element) ) {
! 					$dirToRemove[] = $dirPath.'/'.$element;
  				}
  			}
***************
*** 314,318 ****
  		$oldFileName = basename($filePath);
  
! 		if ( $this->check_name_exist( $path . "/" . $newFileName )
  			&& $newFileName != $oldFileName) {
  			return false;
--- 314,318 ----
  		$oldFileName = basename($filePath);
  
! 		if ( $this->check_name_exist( $path . '/' . $newFileName )
  			&& $newFileName != $oldFileName) {
  			return false;
***************
*** 322,326 ****
  				&& ereg("[[:print:]]+\.([[:alnum:]]+)$", $olFileName, $extension)) {
  
! 				$newFileName .= "." . $extension[1];
  			}
  			/*** Prevent file name with php extension ***/
--- 322,326 ----
  				&& ereg("[[:print:]]+\.([[:alnum:]]+)$", $olFileName, $extension)) {
  
! 				$newFileName .= '.' . $extension[1];
  			}
  			/*** Prevent file name with php extension ***/
***************
*** 353,361 ****
  		if ( check_name_exist($source) ) {
  			$fileName = basename($source);
! 			if ( check_name_exist($target."/".$fileName) ) {
  				return false;
  			} else {	/*** File case ***/
  				if ( @is_file($source) ) {
! 					@copy($source , $target."/".$fileName);
  					@unlink($source);
  					return true;
--- 353,361 ----
  		if ( check_name_exist($source) ) {
  			$fileName = basename($source);
! 			if ( check_name_exist($target.'/'.$fileName) ) {
  				return false;
  			} else {	/*** File case ***/
  				if ( @is_file($source) ) {
! 					@copy($source , $target.'/'.$fileName);
  					@unlink($source);
  					return true;
***************
*** 364,368 ****
  				elseif ( @is_dir($source)) {
  					// check to not copy the directory inside itself
! 					if ( ereg("^".$source, $target) ) {
  						return false;
  
--- 364,368 ----
  				elseif ( @is_dir($source)) {
  					// check to not copy the directory inside itself
! 					if ( ereg('^'.$source, $target) ) {
  						return false;
  
***************
*** 391,396 ****
  		// extract directory name - create it at destination - update destination trail
  		$dirName = basename($origDirPath);
! 		@mkdir ($destination."/".$dirName, 0775);
! 		$destinationTrail = $destination."/".$dirName;
  
  		@chdir ($origDirPath) ;
--- 391,396 ----
  		// extract directory name - create it at destination - update destination trail
  		$dirName = basename($origDirPath);
! 		@mkdir ($destination.'/'.$dirName, 0775);
! 		$destinationTrail = $destination.'/'.$dirName;
  
  		@chdir ($origDirPath) ;
***************
*** 398,408 ****
  
  		while ($element = @readdir($handle) ) {
! 			if ( $element == "." || $element == "..") {
  				continue; // skip the current and parent directories
  			} elseif ( @is_file($element) ) {
! 				@copy($element, $destinationTrail."/".$element);
  				@unlink($element) ;
  			} elseif ( @is_dir($element) ) {
! 				$dirToCopy[] = $origDirPath."/".$element;
  			}
  		}
--- 398,408 ----
  
  		while ($element = @readdir($handle) ) {
! 			if ( $element == '.' || $element == '..') {
  				continue; // skip the current and parent directories
  			} elseif ( @is_file($element) ) {
! 				@copy($element, $destinationTrail.'/'.$element);
  				@unlink($element) ;
  			} elseif ( @is_dir($element) ) {
! 				$dirToCopy[] = $origDirPath.'/'.$element;
  			}
  		}

Index: miguel_dirtemp.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/fs/miguel_dirtemp.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** miguel_dirtemp.class.php	6 Aug 2004 10:23:09 -0000	1.3
--- miguel_dirtemp.class.php	21 Aug 2004 19:05:02 -0000	1.4
***************
*** 44,60 ****
    	02/09/2003 00:40 - Initial release
  */
! include_once (Util::app_Path("common/control/classes/miguel_Error.class.php"));
  
  class miguel_DirTemp extends miguel_Error
  {
! 	var $name = "";
! 	var $dirBase = "";
  
! 	function miguel_DirTemp ( $strDirBase = "")
  	{
  		//Set a prime seed for random nums
  		srand( (double)microtime()*7919 );
  
! 		$this->name = "";
  		$this->dirBase = $strDirBase;
  
--- 44,60 ----
    	02/09/2003 00:40 - Initial release
  */
! include_once (Util::app_Path('common/control/classes/miguel_Error.class.php'));
  
  class miguel_DirTemp extends miguel_Error
  {
! 	var $name = '';
! 	var $dirBase = '';
  
! 	function miguel_DirTemp ( $strDirBase = '')
  	{
  		//Set a prime seed for random nums
  		srand( (double)microtime()*7919 );
  
! 		$this->name = '';
  		$this->dirBase = $strDirBase;
  
***************
*** 75,79 ****
  	function getDirTemp()
  	{
! 		return ( $this->dirBase . "/" . $this->name );
  	}
  
--- 75,79 ----
  	function getDirTemp()
  	{
! 		return ( $this->dirBase . '/' . $this->name );
  	}
  
***************
*** 98,105 ****
  	}
  
! 	function deleteName($dirPath="")
  	{
! 		if ( $dirPath == "" ) {
! 			$dirPath = $this->dirBase . "/" . $this->name;
  		}
                  /* Try to remove the directory. If it can not manage to remove it,
--- 98,105 ----
  	}
  
! 	function deleteName($dirPath='')
  	{
! 		if ( $dirPath == '' ) {
! 			$dirPath = $this->dirBase . '/' . $this->name;
  		}
                  /* Try to remove the directory. If it can not manage to remove it,
***************
*** 111,116 ****
                    $handle = @opendir($dirPath) ;
                    while ($element = @readdir($handle) ) {
! 		      $elementPath = $dirPath . "/" . $element;
!                       if ( $element == "." || $element == "..") {
                           continue;       // skip current and parent directories
                        } elseif ( @is_file($elementPath) ) {
--- 111,116 ----
                    $handle = @opendir($dirPath) ;
                    while ($element = @readdir($handle) ) {
! 		      $elementPath = $dirPath . '/' . $element;
!                       if ( $element == '.' || $element == '..') {
                           continue;       // skip current and parent directories
                        } elseif ( @is_file($elementPath) ) {
***************
*** 136,140 ****
  		//Read data from a file in temp folder
  		if (@is_file($file)) {
! 			if (($fp = fopen($file,"rb"))) {
  				$file_content = fread($fp, filesize($file));
  				fclose($fp);
--- 136,140 ----
  		//Read data from a file in temp folder
  		if (@is_file($file)) {
! 			if (($fp = fopen($file,'rb'))) {
  				$file_content = fread($fp, filesize($file));
  				fclose($fp);
***************
*** 151,155 ****
  	{
  		//Write data in a file in temp folder
! 		if (($fp = fopen($this->getDirTemp().'/'.$filename,"wb"))) {
  			fwrite($fp, $data);
  			fclose($fp);
--- 151,155 ----
  	{
  		//Write data in a file in temp folder
! 		if (($fp = fopen($this->getDirTemp().'/'.$filename,'wb'))) {
  			fwrite($fp, $data);
  			fclose($fp);



From nobody at sheep.berlios.de  Sat Aug 21 21:05:03 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:03 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/model/classes base_model.class.php,1.3,1.4
Message-ID: <200408211905.i7LJ53628955@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/model/classes
In directory sheep:/tmp/cvs-serv22200/modules/andromeda/model/classes

Modified Files:
	base_model.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: base_model.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/base_model.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_model.class.php	6 Aug 2004 10:23:09 -0000	1.3
--- base_model.class.php	21 Aug 2004 19:05:01 -0000	1.4
***************
*** 35,39 ****
   *
   */ 
! include_once(MIGUELBASE_DIR."model/classes/ddbb/base_ddbberror.class.php");
  
  /**
--- 35,39 ----
   *
   */ 
! include_once(MIGUELBASE_DIR.'model/classes/ddbb/base_ddbberror.class.php');
  
  /**
***************
*** 100,104 ****
  	{
  		//Include database access class
! 		require_once Util::base_Path("model/classes/ddbb/base_ddbbdata.class.php");
  		//Instanciamos la clase responsable
  		$this->obj_data = new base_ddbbData();
--- 100,104 ----
  	{
  		//Include database access class
! 		require_once Util::base_Path('model/classes/ddbb/base_ddbbdata.class.php');
  		//Instanciamos la clase responsable
  		$this->obj_data = new base_ddbbData();
***************
*** 327,331 ****
      function log($message, $priority)
      {	
!     	include_once(Util::base_Path("include/classes/loghandler.class.php"));
    		LogHandler::log($message, $this->str_moduleName.'_controller', $priority);
      }
--- 327,331 ----
      function log($message, $priority)
      {	
!     	include_once(Util::base_Path('include/classes/loghandler.class.php'));
    		LogHandler::log($message, $this->str_moduleName.'_controller', $priority);
      }



From nobody at sheep.berlios.de  Sat Aug 21 21:05:03 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:03 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/include/error/classes base_Error.class.php,1.4,1.5 base_verror.orig.php,1.3,1.4
Message-ID: <200408211905.i7LJ53628943@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/include/error/classes
In directory sheep:/tmp/cvs-serv22200/modules/andromeda/include/error/classes

Modified Files:
	base_Error.class.php base_verror.orig.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: base_Error.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/error/classes/base_Error.class.php,v
retrieving revision 1.4
retrieving revision 1.5
diff -C2 -d -r1.4 -r1.5
*** base_Error.class.php	9 Aug 2004 22:09:03 -0000	1.4
--- base_Error.class.php	21 Aug 2004 19:05:00 -0000	1.5
***************
*** 79,83 ****
  		@setlocale(LC_ALL, $GLOBALS['locale']);
  	
! 		$gettext_domain = "errors";
  		bindtextdomain($gettext_domain, miguel_webDir().'/miguel/gettext');
  		textdomain($gettext_domain);
--- 79,83 ----
  		@setlocale(LC_ALL, $GLOBALS['locale']);
  	
! 		$gettext_domain = 'errors';
  		bindtextdomain($gettext_domain, miguel_webDir().'/miguel/gettext');
  		textdomain($gettext_domain);
***************
*** 132,139 ****
  	function showErrors ()
  	{
! 		if ($this->hasError() && !strstr(substr($_SERVER["PHP_SELF"], -33), "miguel/messages/error_message.php")) {
! 			$_SESSION["errors"] = $this->ArrayErrors;
! 			$_SESSION["errors_args"] = $this->ArrayErrorsArgs;
! 			header("Location: ".$GLOBALS['urlServer']."miguel/messages/error_message.php");
  		}
  	}
--- 132,139 ----
  	function showErrors ()
  	{
! 		if ($this->hasError() && !strstr(substr($_SERVER['PHP_SELF'], -33), 'miguel/messages/error_message.php')) {
! 			$_SESSION['errors'] = $this->ArrayErrors;
! 			$_SESSION['errors_args'] = $this->ArrayErrorsArgs;
! 			header('Location: '.$GLOBALS['urlServer'].'miguel/messages/error_message.php');
  		}
  	}
***************
*** 150,154 ****
    	  * @private
  	  */
! 	function _addError ($error, $args_array="")
  	{
          	if ($this->validError($error)) {
--- 150,154 ----
    	  * @private
  	  */
! 	function _addError ($error, $args_array='')
  	{
          	if ($this->validError($error)) {
***************
*** 157,161 ****
  			        $this->ArrayErrors[]     = $error;
  			        $this->bError            = TRUE;
!                         } elseif (count($args_array) == substr_count(agt($error), "%")) {
                                  $this->ArrayErrorsArgs[$error] = $args_array;
  			        $this->ArrayErrors[]     = $error;
--- 157,161 ----
  			        $this->ArrayErrors[]     = $error;
  			        $this->bError            = TRUE;
!                         } elseif (count($args_array) == substr_count(agt($error), '%')) {
                                  $this->ArrayErrorsArgs[$error] = $args_array;
  			        $this->ArrayErrors[]     = $error;

Index: base_verror.orig.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/include/error/classes/base_verror.orig.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_verror.orig.php	6 Aug 2004 10:38:42 -0000	1.3
--- base_verror.orig.php	21 Aug 2004 19:05:00 -0000	1.4
***************
*** 41,57 ****
  // NOTE: This is an error page and dependences with db neither configuration file must be deleted, so like
  // in the install script, we set the vars ussually setted in the config file.
! $GLOBALS['webDir']           = realpath("../..")."/";
! $GLOBALS['urlAppend']        = str_replace ("/miguel/messages/error_message.php", "", $PHP_SELF);
! $GLOBALS['urlServer']        = "http://".$SERVER_NAME.$GLOBALS['urlAppend']."/";
  $GLOBALS['language']         = -1;
  $GLOBALS['config_readed']    = TRUE;
! $GLOBALS['educationManager'] = "Juan Espaol";
! $GLOBALS['siteName']         = "miguel";
! $GLOBALS['Institution']      = "Hispalinux";
! $GLOBALS['InstitutionUrl']   = "http://www.hispalinux.es/";
  
  // Now -as always- we set the vars needed by the header files
! //$GLOBALS['langFile']    = "index";
! $GLOBALS['headerTitle'] = "Miguel Error";
  
  @include_once ('../include/miguel_require.php');
--- 41,57 ----
  // NOTE: This is an error page and dependences with db neither configuration file must be deleted, so like
  // in the install script, we set the vars ussually setted in the config file.
! $GLOBALS['webDir']           = realpath('../..').'/';
! $GLOBALS['urlAppend']        = str_replace ('/miguel/messages/error_message.php', '', $PHP_SELF);
! $GLOBALS['urlServer']        = 'http://'.$SERVER_NAME.$GLOBALS['urlAppend'].'/';
  $GLOBALS['language']         = -1;
  $GLOBALS['config_readed']    = TRUE;
! $GLOBALS['educationManager'] = 'Juan Espaol';
! $GLOBALS['siteName']         = 'miguel';
! $GLOBALS['Institution']      = 'Hispalinux';
! $GLOBALS['InstitutionUrl']   = 'http://www.hispalinux.es/';
  
  // Now -as always- we set the vars needed by the header files
! //$GLOBALS['langFile']    = 'index';
! $GLOBALS['headerTitle'] = 'Miguel Error';
  
  @include_once ('../include/miguel_require.php');
***************
*** 81,91 ****
  // It might have happened more than one error. If that's the case, we provide the errors separated with a comma
  
! $ErrorsArray       = $_SESSION["errors"];
! $Errors_args_Array = $_SESSION["errors_args"];
  
  // 1:
  if (!is_array($ErrorsArray))
  {
!          $GLOBALS['miguel_Error']->_addError("no error code was given");
  // 2:
  }
--- 81,91 ----
  // It might have happened more than one error. If that's the case, we provide the errors separated with a comma
  
! $ErrorsArray       = $_SESSION['errors'];
! $Errors_args_Array = $_SESSION['errors_args'];
  
  // 1:
  if (!is_array($ErrorsArray))
  {
!          $GLOBALS['miguel_Error']->_addError('no error code was given');
  // 2:
  }
***************
*** 114,118 ****
    */
  
! //miguelIncludeHeader("miguel");
  @include_once (miguel_webDir().'miguel/include/miguel_topheader.php');
  
--- 114,118 ----
    */
  
! //miguelIncludeHeader('miguel');
  @include_once (miguel_webDir().'miguel/include/miguel_topheader.php');
  



From nobody at sheep.berlios.de  Sat Aug 21 21:05:30 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:30 +0200
Subject: [Migueloo-cvs] migueloo/modules/alumnPage index.php,1.3,1.4
Message-ID: <200408211905.i7LJ5U628966@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/alumnPage
In directory sheep:/tmp/cvs-serv22200/modules/alumnPage

Modified Files:
	index.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: index.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/alumnPage/index.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** index.php	6 Aug 2004 08:07:47 -0000	1.3
--- index.php	21 Aug 2004 19:04:58 -0000	1.4
***************
*** 30,37 ****
  
  //Carga el c?digo de Andromeda
! include_once ("../common/miguel_base.inc.php");
  
  //Carga el c?digo del controlador
! include_once (Util::app_Path("alumnPage/control/classes/miguel_calumnpage.class.php"));
  
  
--- 30,37 ----
  
  //Carga el c?digo de Andromeda
! include_once ('../common/miguel_base.inc.php');
  
  //Carga el c?digo del controlador
! include_once (Util::app_Path('alumnPage/control/classes/miguel_calumnpage.class.php'));
  
  



From nobody at sheep.berlios.de  Sat Aug 21 21:05:31 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:31 +0200
Subject: [Migueloo-cvs] migueloo/modules/alumnPage/control/classes miguel_calumnpage.class.php,1.3,1.4
Message-ID: <200408211905.i7LJ5V628969@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/alumnPage/control/classes
In directory sheep:/tmp/cvs-serv22200/modules/alumnPage/control/classes

Modified Files:
	miguel_calumnpage.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: miguel_calumnpage.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/alumnPage/control/classes/miguel_calumnpage.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** miguel_calumnpage.class.php	6 Aug 2004 08:07:47 -0000	1.3
--- miguel_calumnpage.class.php	21 Aug 2004 19:04:58 -0000	1.4
***************
*** 70,77 ****
  				$this->addNavElement(Util::format_URLPath('alumnPage/index.php'), agt('Inicio'));
  
!                 $this->setPageTitle("miguel Alumn Page");
                  $this->setMessage('');
  
!                 $this->setHelp("");
          }
  }
--- 70,77 ----
  				$this->addNavElement(Util::format_URLPath('alumnPage/index.php'), agt('Inicio'));
  
!                 $this->setPageTitle('miguel Alumn Page');
                  $this->setMessage('');
  
!                 $this->setHelp('');
          }
  }



From nobody at sheep.berlios.de  Sat Aug 21 21:05:31 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:31 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda constants.inc.php,1.3,1.4 defines.inc.php,1.3,1.4 timecontrol.class.php,1.3,1.4
Message-ID: <200408211905.i7LJ5V628978@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda
In directory sheep:/tmp/cvs-serv22200/modules/andromeda

Modified Files:
	constants.inc.php defines.inc.php timecontrol.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: constants.inc.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/constants.inc.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** constants.inc.php	6 Aug 2004 10:31:12 -0000	1.3
--- constants.inc.php	21 Aug 2004 19:04:59 -0000	1.4
***************
*** 28,32 ****
  */
  /**
!  * Errores para errorHandler
   */
  define ('FATAL', E_USER_ERROR);
--- 28,32 ----
  */
  /**
!  * Errors for errorHandler
   */
  define ('FATAL', E_USER_ERROR);
***************
*** 35,46 ****
  
  /**
!  * Clase de Error
   */
! define("USER_ERROR", 1);
! define("BASE_ERROR", 2);
! define("APP_ERROR", 3);
  
  /**
!  * Severidad del Error
   */
  define('LOG_EMERG',    0);     /** System is unusable */
--- 35,46 ----
  
  /**
!  * Class of Error
   */
! define('USER_ERROR', 1);
! define('BASE_ERROR', 2);
! define('APP_ERROR', 3);
  
  /**
!  * Error severity
   */
  define('LOG_EMERG',    0);     /** System is unusable */
***************
*** 54,68 ****
  
  /**
!  * Tipo de Error
   */
! define("UNKNOWN", 0);
! define("COULD_NOT_OPEN_FILE", 1);
! define("COULD_NOT_CREATE_FILE", 2);
! define("FILE_DOES_NOT_EXIST", 3);
! //define("", "");
! //define("", "");
  
  
! //define("", "");
  
  
--- 54,68 ----
  
  /**
!  * Type of Error
   */
! define('UNKNOWN', 0);
! define('COULD_NOT_OPEN_FILE', 1);
! define('COULD_NOT_CREATE_FILE', 2);
! define('FILE_DOES_NOT_EXIST', 3);
! //define('', '');
! //define('', '');
  
  
! //define('', '');
  
  

Index: defines.inc.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/defines.inc.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** defines.inc.php	6 Aug 2004 10:31:12 -0000	1.3
--- defines.inc.php	21 Aug 2004 19:04:59 -0000	1.4
***************
*** 103,111 ****
  }
  
! define("MIGUEL_GETTEXT_DEBUG", 0);
  
  /**
!  * Encapsula el uso de gettext. Si no existe la traducci?n, presenta un valor por defecto
!  * @param string $char Cadena a traducir
   */
  function agt($char)
--- 103,111 ----
  }
  
! define('MIGUEL_GETTEXT_DEBUG', 0);
  
  /**
!  * Encapsulates gettext use. If there isn't translation, shows a default value
!  * @param string $char String to translate
   */
  function agt($char)

Index: timecontrol.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/timecontrol.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** timecontrol.class.php	6 Aug 2004 10:31:12 -0000	1.3
--- timecontrol.class.php	21 Aug 2004 19:04:59 -0000	1.4
***************
*** 39,43 ****
      function getInterval()
  	{ 
! 		$micro_time = explode(" ", microtime()); 
  		$this->arr_time[] = $micro_time[1] + $micro_time[0]; 
      } 
--- 39,43 ----
      function getInterval()
  	{ 
! 		$micro_time = explode(' ', microtime()); 
  		$this->arr_time[] = $micro_time[1] + $micro_time[0]; 
      } 
***************
*** 50,54 ****
  		for($i=1; $i < $int_total; $i++){
  			$int_time = $this->arr_time[$i] - $this->arr_time[$i - 1];
! 			$ret_val[] = "Intervalo ".$i." en ".substr($int_time,0,5)." segundos.\n";
  		}
  		
--- 50,54 ----
  		for($i=1; $i < $int_total; $i++){
  			$int_time = $this->arr_time[$i] - $this->arr_time[$i - 1];
! 			$ret_val[] = 'Intervalo '.$i.' en '.substr($int_time,0,5)." segundos.\n";
  		}
  		



From nobody at sheep.berlios.de  Sat Aug 21 21:05:32 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:32 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/control/classes base_controller.class.php,1.3,1.4 registry.class.php,1.3,1.4 session.class.php,1.3,1.4
Message-ID: <200408211905.i7LJ5W628981@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/control/classes
In directory sheep:/tmp/cvs-serv22200/modules/andromeda/control/classes

Modified Files:
	base_controller.class.php registry.class.php session.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: base_controller.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/control/classes/base_controller.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_controller.class.php	6 Aug 2004 10:31:13 -0000	1.3
--- base_controller.class.php	21 Aug 2004 19:04:59 -0000	1.4
***************
*** 357,361 ****
      function processPetition()
      {
!     	$arr_menuElem[]= array ("url" => app_URLPath("index.php"), "name" => Session::getValue("siteName"));
      }
  
--- 357,361 ----
      function processPetition()
      {
!     	$arr_menuElem[]= array ('url' => app_URLPath('index.php'), 'name' => Session::getValue('siteName'));
      }
  
***************
*** 367,373 ****
      {	
      	$ret_val = '';
!         //include_once(Util::base_Path("view/classes/miguel_VPage.class.php"));
!         if(file_exists(Util::app_Path($this->str_moduleName.'/view/classes/'.strtolower($this->str_viewClass).".class.php"))) {
!             include (Util::app_Path($this->str_moduleName.'/view/classes/'.strtolower($this->str_viewClass).".class.php"));
              $obj_view = new $this->str_viewClass($this->str_pageTitle, $this->arr_commarea);
  		}
--- 367,373 ----
      {	
      	$ret_val = '';
!         //include_once(Util::base_Path('view/classes/miguel_VPage.class.php'));
!         if(file_exists(Util::app_Path($this->str_moduleName.'/view/classes/'.strtolower($this->str_viewClass).'.class.php'))) {
!             include (Util::app_Path($this->str_moduleName.'/view/classes/'.strtolower($this->str_viewClass).'.class.php'));
              $obj_view = new $this->str_viewClass($this->str_pageTitle, $this->arr_commarea);
  		}
***************
*** 389,394 ****
  	function giveControl($moduleName, $class)
  	{
! 		if(file_exists(Util::app_Path($moduleName.'/control/classes/'.strtolower($class).".class.php"))) {
!             include (Util::app_Path($moduleName.'/control/classes/'.strtolower($class).".class.php"));
              $new_control = new $class();
  		}
--- 389,394 ----
  	function giveControl($moduleName, $class)
  	{
! 		if(file_exists(Util::app_Path($moduleName.'/control/classes/'.strtolower($class).'.class.php'))) {
!             include (Util::app_Path($moduleName.'/control/classes/'.strtolower($class).'.class.php'));
              $new_control = new $class();
  		}
***************
*** 408,412 ****
      function log($message, $priority)
      {	
!     	include_once(Util::base_Path("include/classes/loghandler.class.php"));
    		LogHandler::log($message, $this->str_moduleName.'_controller', $priority);
      }
--- 408,412 ----
      function log($message, $priority)
      {	
!     	include_once(Util::base_Path('include/classes/loghandler.class.php'));
    		LogHandler::log($message, $this->str_moduleName.'_controller', $priority);
      }

Index: registry.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/control/classes/registry.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** registry.class.php	6 Aug 2004 10:31:13 -0000	1.3
--- registry.class.php	21 Aug 2004 19:04:59 -0000	1.4
***************
*** 411,415 ****
      function listThemes()
      {
!         include_once(Util::base_Path("include/classes/theme.class.php"));
  
          return Theme::getActiveThemes();
--- 411,415 ----
      function listThemes()
      {
!         include_once(Util::base_Path('include/classes/theme.class.php'));
  
          return Theme::getActiveThemes();

Index: session.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/control/classes/session.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** session.class.php	6 Aug 2004 10:31:13 -0000	1.3
--- session.class.php	21 Aug 2004 19:04:59 -0000	1.4
***************
*** 70,76 ****
      {	
          //Parametros de tratamiento de errores
!         ini_set("display_errors", "On");
!         //ini_set("display_startup_errors", "Off");
!         ini_set("log_errors", "Off");
  
  		include_once(Util::base_Path('include/classes/errorhandler.class.php'));
--- 70,76 ----
      {	
          //Parametros de tratamiento de errores
!         ini_set('display_errors', 'On');
!         //ini_set('display_startup_errors', 'Off');
!         ini_set('log_errors', 'Off');
  
  		include_once(Util::base_Path('include/classes/errorhandler.class.php'));
***************
*** 79,92 ****
  		$str_name = session_name();
  
! 		if ($str_name != "MIGUEL_BASE") {
! 			session_name("MIGUEL_BASE");
  		}
  
  		//Parametros de sesion
! 		ini_set("session.save_handler", "files");
! 		ini_set("session.use_cookies", 0);
  
  		if(MIGUELBASE_SESSION_DIR != ''){
!         	ini_set("session.save_path", MIGUELBASE_SESSION_DIR);
          }
  		if (MIGUELBASE_PHP_INT_VERSION >= 40200) {
--- 79,92 ----
  		$str_name = session_name();
  
! 		if ($str_name != 'MIGUEL_BASE') {
! 			session_name('MIGUEL_BASE');
  		}
  
  		//Parametros de sesion
! 		ini_set('session.save_handler', 'files');
! 		ini_set('session.use_cookies', 0);
  
  		if(MIGUELBASE_SESSION_DIR != ''){
!         	ini_set('session.save_path', MIGUELBASE_SESSION_DIR);
          }
  		if (MIGUELBASE_PHP_INT_VERSION >= 40200) {
***************
*** 94,104 ****
  		}
  
!         ini_set("session.use_trans_sid", 0);
!         ini_set("session.gc_probability", 100);
  
          //Parametros para transferencia de ficheros
! 		ini_set("file_uploads", "On");
! 		ini_set("upload_tmp_dir", MIGUELBASE_CACHE_DIR);
!         ini_set("upload_max_filesize", "2M");
  
  		if(!session_id()){
--- 94,104 ----
  		}
  
!         ini_set('session.use_trans_sid', 0);
!         ini_set('session.gc_probability', 100);
  
          //Parametros para transferencia de ficheros
! 		ini_set('file_uploads', 'On');
! 		ini_set('upload_tmp_dir', MIGUELBASE_CACHE_DIR);
!         ini_set('upload_max_filesize', '2M');
  
  		if(!session_id()){
***************
*** 141,154 ****
      {
          if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
!    			if(isset($_SESSION["CONTEXT"])){
!    				$arr_context = $_SESSION["CONTEXT"];
     				$_SESSION = array();
!    				$_SESSION["CONTEXT"] = $arr_context;
     			}
      	} else {
!     		if(isset($HTTP_SESSION_VARS["CONTEXT"])){
!    				$arr_context = $HTTP_SESSION_VARS["CONTEXT"];
     				$HTTP_SESSION_VARS = array();
!    				$HTTP_SESSION_VARS["CONTEXT"] = $arr_context;
     			}
      	}
--- 141,154 ----
      {
          if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
!    			if(isset($_SESSION['CONTEXT'])){
!    				$arr_context = $_SESSION['CONTEXT'];
     				$_SESSION = array();
!    				$_SESSION['CONTEXT'] = $arr_context;
     			}
      	} else {
!     		if(isset($HTTP_SESSION_VARS['CONTEXT'])){
!    				$arr_context = $HTTP_SESSION_VARS['CONTEXT'];
     				$HTTP_SESSION_VARS = array();
!    				$HTTP_SESSION_VARS['CONTEXT'] = $arr_context;
     			}
      	}
***************
*** 164,173 ****
      	$ret_val = null;
      	if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
!    			if(isset($_SESSION["MIGUEL_".strtoupper($str_var)])){
!    				$ret_val = $_SESSION["MIGUEL_".strtoupper($str_var)];
     			}
      	} else {
!     		if(isset($HTTP_SESSION_VARS["MIGUEL_".strtoupper($str_var)])){
!    				$ret_val = $HTTP_SESSION_VARS["MIGUEL_".strtoupper($str_var)];
     			}
      	}
--- 164,173 ----
      	$ret_val = null;
      	if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
!    			if(isset($_SESSION['MIGUEL_'.strtoupper($str_var)])){
!    				$ret_val = $_SESSION['MIGUEL_'.strtoupper($str_var)];
     			}
      	} else {
!     		if(isset($HTTP_SESSION_VARS['MIGUEL_'.strtoupper($str_var)])){
!    				$ret_val = $HTTP_SESSION_VARS['MIGUEL_'.strtoupper($str_var)];
     			}
      	}
***************
*** 183,189 ****
      {
      	if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
! 			$_SESSION["MIGUEL_".strtoupper($str_var)] = $mix_value;
      	} else {
!    			$HTTP_SESSION_VARS["MIGUEL_".strtoupper($str_var)] = $mix_value;
      	}
      }
--- 183,189 ----
      {
      	if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
! 			$_SESSION['MIGUEL_'.strtoupper($str_var)] = $mix_value;
      	} else {
!    			$HTTP_SESSION_VARS['MIGUEL_'.strtoupper($str_var)] = $mix_value;
      	}
      }
***************
*** 198,206 ****
          $ret_val = false;
  		if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
! 			if(isset($_SESSION["MIGUEL_".strtoupper($str_var)])){
  				$ret_val = true;
  			}
      	} else {
! 			if(isset($HTTP_SESSION_VARS["MIGUEL_".strtoupper($str_var)])){
  				$ret_val = true;
  			}
--- 198,206 ----
          $ret_val = false;
  		if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
! 			if(isset($_SESSION['MIGUEL_'.strtoupper($str_var)])){
  				$ret_val = true;
  			}
      	} else {
! 			if(isset($HTTP_SESSION_VARS['MIGUEL_'.strtoupper($str_var)])){
  				$ret_val = true;
  			}
***************
*** 217,225 ****
      {
  		if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
! 			//$_SESSION["MIGUEL_".strtoupper($str_var)] = null;
! 			unset($_SESSION["MIGUEL_".strtoupper($str_var)]);
  		} else {
! 			//$HTTP_SESSION_VARS["MIGUEL_".strtoupper($str_var)] = null;
! 			unset( $HTTP_SESSION_VARS["MIGUEL_".strtoupper($str_var)]);
  		}
      }
--- 217,225 ----
      {
  		if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
! 			//$_SESSION['MIGUEL_'.strtoupper($str_var)] = null;
! 			unset($_SESSION['MIGUEL_'.strtoupper($str_var)]);
  		} else {
! 			//$HTTP_SESSION_VARS['MIGUEL_'.strtoupper($str_var)] = null;
! 			unset( $HTTP_SESSION_VARS['MIGUEL_'.strtoupper($str_var)]);
  		}
      }
***************
*** 235,244 ****
  		$ret_val = null;
          if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
!    			if(isset($_SESSION["CONTEXT"]["MIGUEL_".strtoupper($str_var)])){
!    				$ret_val = $_SESSION["CONTEXT"]["MIGUEL_".strtoupper($str_var)];
     			}
      	} else {
!     		if(isset($HTTP_SESSION_VARS["CONTEXT"]["MIGUEL_".strtoupper($str_var)])){
!    				$ret_val = $HTTP_SESSION_VARS["CONTEXT"]["MIGUEL_".strtoupper($str_var)];
     			}
      	}
--- 235,244 ----
  		$ret_val = null;
          if (MIGUELBASE_PHP_INT_VERSION >= 40006) {
!    			if(isset($_SESSION['CONTEXT']['MIGUEL_'.strtoupper($str_var)])){
!    				$ret_val = $_SESSION['CONTEXT']['MIGUEL_'.strtoupper($str_var)];
     			}
      	} else {
!     		if(isset($HTTP_SESSION_VARS['CONTEXT']['MIGUEL_'.strtoupper($str_var)])){
!    				$ret_val = $HTTP_SESSION_VARS['CONTEXT']['MIGUEL_'.strtoupper($str_var)];
     			}
      	}
***************
*** 287,291 ****
  		  $this->_processXMLInitData($conf_file);
  		} else {
! 				$this->_setError("miguel_Controller:: miguel no est? configurado");
  		}
  	}
--- 287,291 ----
  		  $this->_processXMLInitData($conf_file);
  		} else {
! 				$this->_setError('miguel_Controller:: miguel no est? configurado');
  		}
  	}
***************
*** 314,318 ****
  
  		for ($i=0; $i < $xml_root->numChildren(); $i++) {
! 			$_SESSION["CONTEXT"]["MIGUEL_".strtoupper($xml_elements[$i]->name())] = $xml_elements[$i]->getValue();
  		}
  
--- 314,318 ----
  
  		for ($i=0; $i < $xml_root->numChildren(); $i++) {
! 			$_SESSION['CONTEXT']['MIGUEL_'.strtoupper($xml_elements[$i]->name())] = $xml_elements[$i]->getValue();
  		}
  



From nobody at sheep.berlios.de  Sat Aug 21 21:05:31 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:31 +0200
Subject: [Migueloo-cvs] migueloo/modules/alumnPage/model/classes miguel_malumnpage.class.php,1.3,1.4
Message-ID: <200408211905.i7LJ5V628972@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/alumnPage/model/classes
In directory sheep:/tmp/cvs-serv22200/modules/alumnPage/model/classes

Modified Files:
	miguel_malumnpage.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: miguel_malumnpage.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/alumnPage/model/classes/miguel_malumnpage.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** miguel_malumnpage.class.php	6 Aug 2004 08:07:47 -0000	1.3
--- miguel_malumnpage.class.php	21 Aug 2004 19:04:58 -0000	1.4
***************
*** 75,79 ****
      {
  
!                          $ret_val = $this->Select('notice', 'author, subject, text, time, notice_id', "");
  
  
--- 75,79 ----
      {
  
!                          $ret_val = $this->Select('notice', 'author, subject, text, time, notice_id', '');
  
  
***************
*** 84,86 ****
              return ($ret_val);
      }
! }
\ No newline at end of file
--- 84,86 ----
              return ($ret_val);
      }
! }



From nobody at sheep.berlios.de  Sat Aug 21 21:05:31 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:05:31 +0200
Subject: [Migueloo-cvs] migueloo/modules/alumnPage/view/classes miguel_valumnpage.class.php,1.3,1.4
Message-ID: <200408211905.i7LJ5V628975@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/alumnPage/view/classes
In directory sheep:/tmp/cvs-serv22200/modules/alumnPage/view/classes

Modified Files:
	miguel_valumnpage.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: miguel_valumnpage.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/alumnPage/view/classes/miguel_valumnpage.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** miguel_valumnpage.class.php	6 Aug 2004 08:07:47 -0000	1.3
--- miguel_valumnpage.class.php	21 Aug 2004 19:04:59 -0000	1.4
***************
*** 31,35 ****
   * Include classes library
   */
! include_once (Util::app_Path("common/view/classes/miguel_vmenu.class.php"));
  
  class miguel_VAlumnPage extends miguel_VMenu
--- 31,35 ----
   * Include classes library
   */
! include_once (Util::app_Path('common/view/classes/miguel_vmenu.class.php'));
  
  class miguel_VAlumnPage extends miguel_VMenu
***************
*** 44,48 ****
                  $table = &html_table(Session::getContextValue('mainInterfaceWidth'),0,0,0);
                  $row = html_tr();
!                 $image = html_td('', '',  html_img(Theme::getThemeImagePath("invisible.gif"), 20, 14));
                  $image->set_tag_attribute('align', 'right');
                  $progress = html_td('', '', 'Mi progreso');
--- 44,48 ----
                  $table = &html_table(Session::getContextValue('mainInterfaceWidth'),0,0,0);
                  $row = html_tr();
!                 $image = html_td('', '',  html_img(Theme::getThemeImagePath('invisible.gif'), 20, 14));
                  $image->set_tag_attribute('align', 'right');
                  $progress = html_td('', '', 'Mi progreso');
***************
*** 79,89 ****
              $row = html_tr();
  
!                 $from = html_td('ptabla01', "", html_b($from_to));
!                 $subject = html_td('ptabla01', "", html_b('Asunto'));
!                 $date = html_td('ptabla01', "", html_b('Recibido'));
  
!                  $from->set_tag_attribute('width',"30%");
!                  $subject->set_tag_attribute('width',"50%");
!                  $date->set_tag_attribute('width',"20%");
  
                  $row->add($from);
--- 79,89 ----
              $row = html_tr();
  
!                 $from = html_td('ptabla01', '', html_b($from_to));
!                 $subject = html_td('ptabla01', '', html_b('Asunto'));
!                 $date = html_td('ptabla01', '', html_b('Recibido'));
  
!                  $from->set_tag_attribute('width', '30%');
!                  $subject->set_tag_attribute('width', '50%');
!                  $date->set_tag_attribute('width', '20%');
  
                  $row->add($from);
***************
*** 204,210 ****
              $row = html_tr();
  
!                 $name = html_td('ptabla02', "", $strName);
!                 $number = html_td('ptabla03', "", $strNumber);
!                 $name->set_tag_attribute('width','80%');
                  $row->add($name);
                  $row->add($number);
--- 204,210 ----
              $row = html_tr();
  
!                 $name = html_td('ptabla02', '', $strName);
!                 $number = html_td('ptabla03', '', $strNumber);
!                 $name->set_tag_attribute('width', '80%');
                  $row->add($name);
                  $row->add($number);
***************
*** 219,226 ****
          $ret_val->add(html_br(2));
  
!                 $table = &html_table(Session::getContextValue('mainInterfaceWidth'),0,2,2);
  
!                 $title = html_td('ptabla01', "", 'Para hoy');
!                 $title->set_tag_attribute('colspan',2);
                  $table->add($title);
  
--- 219,226 ----
          $ret_val->add(html_br(2));
  
!                 $table = &html_table(Session::getContextValue('mainInterfaceWidth'), 0, 2, 2);
  
!                 $title = html_td('ptabla01', '', 'Para hoy');
!                 $title->set_tag_attribute('colspan', 2);
                  $table->add($title);
  
***************
*** 269,273 ****
                                  $div->add($this->add_inbox());
  
!                                 $div->add(html_img(Theme::getThemeImagePath("hr01.gif"), 400, 15));
                              $div->add(html_br());
                              //$div->add(html_hr());
--- 269,273 ----
                                  $div->add($this->add_inbox());
  
!                                 $div->add(html_img(Theme::getThemeImagePath('hr01.gif'), 400, 15));
                              $div->add(html_br());
                              //$div->add(html_hr());
***************
*** 283,287 ****
                                  $div_line = html_div();
                                  $div_line->set_tag_attribute('align', 'right');
!                                 $div_line->add(html_img(Theme::getThemeImagePath("hr02.gif"), 400, 15));
  
                                  $div->add($div_line);
--- 283,287 ----
                                  $div_line = html_div();
                                  $div_line->set_tag_attribute('align', 'right');
!                                 $div_line->add(html_img(Theme::getThemeImagePath('hr02.gif'), 400, 15));
  
                                  $div->add($div_line);



From nobody at sheep.berlios.de  Sat Aug 21 21:09:24 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:09:24 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/model/classes/ddbb base_ddbbdata.class.php,1.4,1.5
Message-ID: <200408211909.i7LJ9O629084@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/ddbb
In directory sheep:/tmp/cvs-serv22355

Modified Files:
	base_ddbbdata.class.php 
Log Message:
Uso correcto de las comillas dobles y peque?as traducciones a ingl?s

Index: base_ddbbdata.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/ddbb/base_ddbbdata.class.php,v
retrieving revision 1.4
retrieving revision 1.5
diff -C2 -d -r1.4 -r1.5
*** base_ddbbdata.class.php	15 Aug 2004 15:08:25 -0000	1.4
--- base_ddbbdata.class.php	21 Aug 2004 19:09:22 -0000	1.5
***************
*** 122,126 ****
  
                          if($this->ado_con->ErrorMsg() != '' ) {
!                             $this->_setError(Session::getContextValue('ddbbSgbd')." :: ".$this->ado_con->ErrorMsg());
                          }
                  }
--- 122,126 ----
  
                          if($this->ado_con->ErrorMsg() != '' ) {
!                             $this->_setError(Session::getContextValue('ddbbSgbd').' :: '.$this->ado_con->ErrorMsg());
                          }
                  }
***************
*** 207,211 ****
                  $this->table = $table;
  
!                 $this->_validateSelectData($table, "count(*)", $cond);
                  if ($this->hasError()) {
                          return 0;
--- 207,211 ----
                  $this->table = $table;
  
!                 $this->_validateSelectData($table, 'count(*)', $cond);
                  if ($this->hasError()) {
                          return 0;
***************
*** 216,220 ****
  
                  $ret_val = $this->_exec($sql_query);
!                 //echo "<pre>"; print_r($ret_val); echo "</pre>";
                  return ($ret_val[0][0]);
            }
--- 216,220 ----
  
                  $ret_val = $this->_exec($sql_query);
!                 //echo '<pre>'; print_r($ret_val); echo '</pre>';
                  return ($ret_val[0][0]);
            }
***************
*** 233,237 ****
                    $this->table = $table;
  
!                   $sql_query = "insert into ".$table;
  
                    if ($fields != '') {
--- 233,237 ----
                    $this->table = $table;
  
!                   $sql_query = 'insert into '.$table;
  
                    if ($fields != '') {
***************
*** 271,275 ****
                  $this->table = $table;
  
!                   $sql_query = "delete from ".$table;
  
                    if ($cond != '') {
--- 271,275 ----
                  $this->table = $table;
  
!                   $sql_query = 'delete from '.$table;
  
                    if ($cond != '') {
***************
*** 303,307 ****
                  $this->table = $table;
  
!                   $sql_query = "update ".$table." set ".$this->_formatUpdateTarget ($fields, $values) ;
  
                  if ($this->hasError()) {
--- 303,307 ----
                  $this->table = $table;
  
!                   $sql_query = 'update '.$table.' set '.$this->_formatUpdateTarget ($fields, $values) ;
  
                  if ($this->hasError()) {
***************
*** 359,363 ****
  
                  $fields= ereg_replace("[[:space:]]+",'',$table);
!                 $fields = explode(",", $fields);
  
                  for ($i=0; $i < count($fields);$i++) {
--- 359,363 ----
  
                  $fields= ereg_replace("[[:space:]]+",'',$table);
!                 $fields = explode(',', $fields);
  
                  for ($i=0; $i < count($fields);$i++) {
***************
*** 387,391 ****
                  } else {
                          $fields= ereg_replace("[[:space:]]+",'',$fields);
!                         $fields = explode(",", $fields);
  
                          if(!is_array($this->table)){
--- 387,391 ----
                  } else {
                          $fields= ereg_replace("[[:space:]]+",'',$fields);
!                         $fields = explode(',', $fields);
  
                          if(!is_array($this->table)){
***************
*** 395,399 ****
                          } else {
                                  for ($i=0; $i < count($fields);$i++) {
!                                         list($item_table, $item_field) = explode(".", $fields[$i], 2);
                                          if(is_null($item_field)){
                                                  $item_field = $item_table;
--- 395,399 ----
                          } else {
                                  for ($i=0; $i < count($fields);$i++) {
!                                         list($item_table, $item_field) = explode('.', $fields[$i], 2);
                                          if(is_null($item_field)){
                                                  $item_field = $item_table;
***************
*** 418,422 ****
                  if ($cond !='') {
                          $cond= ereg_replace("[[:space:]]+",' ',$cond);
!                         $elem = explode(" ", $cond);
                          //Debug::oneVar($cond, __FILE__, __LINE__);
                          for($i=0;$i<count($elem);$i = $i+4) {
--- 418,422 ----
                  if ($cond !='') {
                          $cond= ereg_replace("[[:space:]]+",' ',$cond);
!                         $elem = explode(' ', $cond);
                          //Debug::oneVar($cond, __FILE__, __LINE__);
                          for($i=0;$i<count($elem);$i = $i+4) {
***************
*** 434,438 ****
                                          $elem[$i+2]        = "'".$elem[$i+2]."'";
                                  } else {
!                                         list($item_table, $item_field) = explode(".", $elem[$i], 2);
                                          if(is_null($item_field)){
                                                  $item_field = $item_table;
--- 434,438 ----
                                          $elem[$i+2]        = "'".$elem[$i+2]."'";
                                  } else {
!                                         list($item_table, $item_field) = explode('.', $elem[$i], 2);
                                          if(is_null($item_field)){
                                                  $item_field = $item_table;
***************
*** 442,446 ****
                                          }
  
!                                         list($item_table, $item_field) = explode(".", $elem[$i+2], 2);
                                          if(is_null($item_field)){
                                                  $item_field = $item_table;
--- 442,446 ----
                                          }
  
!                                         list($item_table, $item_field) = explode('.', $elem[$i+2], 2);
                                          if(is_null($item_field)){
                                                  $item_field = $item_table;
***************
*** 458,462 ****
                                  }
                          }
!                         $sel_cond = " where ".implode(' ', $elem);
                  } else {
                          $sel_cond = '';
--- 458,462 ----
                                  }
                          }
!                         $sel_cond = ' where '.implode(' ', $elem);
                  } else {
                          $sel_cond = '';
***************
*** 474,478 ****
                  if ($fields !='') {
                          //$fields= ereg_replace("[[:space:]]+",' ',$fields);
!                         $elem = explode(" ", $fields);
                          //Debug::oneVar($cond, __FILE__, __LINE__);
                          for($i=0;$i<count($elem);$i++) {
--- 474,478 ----
                  if ($fields !='') {
                          //$fields= ereg_replace("[[:space:]]+",' ',$fields);
!                         $elem = explode(' ', $fields);
                          //Debug::oneVar($cond, __FILE__, __LINE__);
                          for($i=0;$i<count($elem);$i++) {
***************
*** 481,486 ****
                      $elem[$i]         = $this->table.'.'.$elem[$i];
                                  } else {
!                                     if(strchr($elem[$i],".")){
!                                            list($item_table, $item_field) = explode(".", $elem[$i], 2);
                                          } else {
                                             $item_table = '';
--- 481,486 ----
                      $elem[$i]         = $this->table.'.'.$elem[$i];
                                  } else {
!                                     if(strchr($elem[$i],'.')){
!                                            list($item_table, $item_field) = explode('.', $elem[$i], 2);
                                          } else {
                                             $item_table = '';
***************
*** 509,513 ****
                          if(!is_array($fields)){
                                  //$fields= ereg_replace("[[:space:]]+",'',$fields);
!                                 $fields = explode(",", $fields);
                          }
  
--- 509,513 ----
                          if(!is_array($fields)){
                                  //$fields= ereg_replace("[[:space:]]+",'',$fields);
!                                 $fields = explode(',', $fields);
                          }
  
***************
*** 531,535 ****
                  } else {
                          $fields= ereg_replace("[[:space:]]+",'',$fields);
!                         $fields = explode(",", $fields);
  
                          for ($i=0; $i < count($fields);$i++) {
--- 531,535 ----
                  } else {
                          $fields= ereg_replace("[[:space:]]+",'',$fields);
!                         $fields = explode(',', $fields);
  
                          for ($i=0; $i < count($fields);$i++) {
***************
*** 544,548 ****
                          if(!is_array($values) ){
                                  $values= ereg_replace("[[:space:]]+",'',$values);
!                                 $values = explode(",", $values);
                          }
                  }
--- 544,548 ----
                          if(!is_array($values) ){
                                  $values= ereg_replace("[[:space:]]+",'',$values);
!                                 $values = explode(',', $values);
                          }
                  }
***************
*** 605,607 ****
            }
  }
! ?>
\ No newline at end of file
--- 605,607 ----
            }
  }
! ?>



From nobody at sheep.berlios.de  Sat Aug 21 21:16:33 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 21:16:33 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/model/classes/login base_login.class.php,1.3,1.4 base_loginldap.class.php,1.3,1.4 base_loginmcrypt.class.php,1.3,1.4 base_loginmd5.class.php,1.3,1.4 base_loginplano.class.php,1.3,1.4 base_userinfo.class.php,1.3,1.4
Message-ID: <200408211916.i7LJGX629190@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/login
In directory sheep:/tmp/cvs-serv22454

Modified Files:
	base_login.class.php base_loginldap.class.php 
	base_loginmcrypt.class.php base_loginmd5.class.php 
	base_loginplano.class.php base_userinfo.class.php 
Log Message:
Uso correcto de comillas dobles

Index: base_login.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/login/base_login.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_login.class.php	6 Aug 2004 10:23:10 -0000	1.3
--- base_login.class.php	21 Aug 2004 19:16:31 -0000	1.4
***************
*** 52,59 ****
   // ESTE INCLUDE ELIMINARLO YA QUE ES DE PRUEBAS
  //include_once ('../../../common/miguel_base.inc.php');
! include_once("./base_loginbase.php");
! include_once("./base_loginmd5.php");
! include_once("./base_loginplano.php");
! include_once("./base_loginmcrypt.php");
   
  class base_login
--- 52,59 ----
   // ESTE INCLUDE ELIMINARLO YA QUE ES DE PRUEBAS
  //include_once ('../../../common/miguel_base.inc.php');
! include_once('./base_loginbase.php');
! include_once('./base_loginmd5.php');
! include_once('./base_loginplano.php');
! include_once('./base_loginmcrypt.php');
   
  class base_login

Index: base_loginldap.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/login/base_loginldap.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_loginldap.class.php	6 Aug 2004 10:23:10 -0000	1.3
--- base_loginldap.class.php	21 Aug 2004 19:16:31 -0000	1.4
***************
*** 47,80 ****
    function _encrypt($str_userpswd)
    {
!    echo "&lt;h3>Prueba de consulta LDAP&lt;/h3>";
!     echo "Conectando ...";
!     $ds=ldap_connect("localhost");  
!     echo "El resultado de la conexi&oacute;n es ".$ds."&lt;p>";
      
      if ($ds) 
      {
!       echo "Autentificandose  ...";
        $r=ldap_bind($ds);    
                               
!       echo "El resultado de la autentificaci&oacute;n es ".$r."&lt;p>";
        
!       echo "Buscando (sn=P*) ...";
       
!       $sr=ldap_search($ds,"o=halys, c=halys", "sn=h*"); 
!       echo "El resultado de la b&uacute;squeda es ".$sr."&lt;p>";
        
!       echo "El n&uacute;mero de entradas devueltas es ".ldap_count_entries($ds,$sr)."&lt;p>";
        
!       echo "Recuperando entradas ...&lt;p>";
        $info = ldap_get_entries($ds, $sr);
!       echo "Devueltos datos de ".$info["count"]." entradas:&lt;p>";
        
!       for ($i=0; $i<$info["count"]; $i++) 
        {
!         echo "dn es: ". $info[$i]["dn"] ."&lt;br>";
!         echo "La primera entrada cn es: ". $info[$i]["cn"][0] ."&lt;br>";
        }
        
!       echo "Cerrando conexi&oacute;n";
        ldap_close($ds);
      
--- 47,80 ----
    function _encrypt($str_userpswd)
    {
!    echo '&lt;h3>Prueba de consulta LDAP&lt;/h3>';
!     echo 'Conectando ...';
!     $ds=ldap_connect('localhost');  
!     echo 'El resultado de la conexi&oacute;n es '.$ds.'&lt;p>';
      
      if ($ds) 
      {
!       echo 'Autentific&aacute;ndose  ...';
        $r=ldap_bind($ds);    
                               
!       echo 'El resultado de la autentificaci&oacute;n es '.$r.'&lt;p>';
        
!       echo 'Buscando (sn=P*) ...';
       
!       $sr=ldap_search($ds,'o=halys, c=halys', 'sn=h*'); 
!       echo 'El resultado de la b&uacute;squeda es '.$sr.'&lt;p>';
        
!       echo 'El n&uacute;mero de entradas devueltas es '.ldap_count_entries($ds,$sr).'&lt;p>';
        
!       echo 'Recuperando entradas ...&lt;p>';
        $info = ldap_get_entries($ds, $sr);
!       echo 'Devueltos datos de '.$info['count'].' entradas:&lt;p>';
        
!       for ($i=0; $i<$info['count']; $i++) 
        {
!         echo 'dn es: '. $info[$i]['dn'] .'&lt;br>';
!         echo 'La primera entrada cn es: '. $info[$i]['cn'][0] .'&lt;br>';
        }
        
!       echo 'Cerrando conexi&oacute;n';
        ldap_close($ds);
      
***************
*** 82,86 ****
      else 
      {
!       echo "&lt;h4>Ha sido imposible conectar al servidor LDAP&lt;/h4>";
      }   
    }
--- 82,86 ----
      else 
      {
!       echo '&lt;h4>Ha sido imposible conectar al servidor LDAP&lt;/h4>';
      }   
    }

Index: base_loginmcrypt.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/login/base_loginmcrypt.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_loginmcrypt.class.php	6 Aug 2004 10:23:10 -0000	1.3
--- base_loginmcrypt.class.php	21 Aug 2004 19:16:31 -0000	1.4
***************
*** 51,55 ****
   // IMPORTANTISIMO HAY QUE TENER ACTIVADA LA EXTENSION MCRYPT.DLL PARA TRABAJAR
   // CON ESTE MODULO
! include_once(Util::app_Path("common/control/classes/base_loginbase.php"));
   
  class base_loginMCRYPT extends base_loginBase
--- 51,55 ----
   // IMPORTANTISIMO HAY QUE TENER ACTIVADA LA EXTENSION MCRYPT.DLL PARA TRABAJAR
   // CON ESTE MODULO
! include_once(Util::app_Path('common/control/classes/base_loginbase.php'));
   
  class base_loginMCRYPT extends base_loginBase
***************
*** 84,88 ****
    	} else {
    	   //dbg_var($ret_sql[0], __FILE__, __LINE__);
!   	   if($ret_sql[0]["password"] == $this->_encrypt($str_username, $str_userpswd)) {
    	       $ret_val = true;
    	   } else {
--- 84,88 ----
    	} else {
    	   //dbg_var($ret_sql[0], __FILE__, __LINE__);
!   	   if($ret_sql[0]['password'] == $this->_encrypt($str_username, $str_userpswd)) {
    	       $ret_val = true;
    	   } else {

Index: base_loginmd5.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/login/base_loginmd5.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_loginmd5.class.php	6 Aug 2004 10:23:10 -0000	1.3
--- base_loginmd5.class.php	21 Aug 2004 19:16:31 -0000	1.4
***************
*** 39,44 ****
   
   // ESTE INCLUDE ELIMINARLO YA QUE ES DE PRUEBAS
! //include_once ("../../../common/miguel_base.inc.php");
! include_once(Util::app_Path("common/control/classes/base_loginbase.php"));
   
  class base_loginMD5 extends base_loginBase
--- 39,44 ----
   
   // ESTE INCLUDE ELIMINARLO YA QUE ES DE PRUEBAS
! //include_once ('../../../common/miguel_base.inc.php');
! include_once(Util::app_Path('common/control/classes/base_loginbase.php'));
   
  class base_loginMD5 extends base_loginBase
***************
*** 63,67 ****
    	   //dbg_var($ret_sql[0], __FILE__, __LINE__);
        
!   	   if($ret_sql[0]["password"] == $this->_encrypt($str_userpswd)) {
    	       $ret_val = true;
    	   } else {
--- 63,67 ----
    	   //dbg_var($ret_sql[0], __FILE__, __LINE__);
        
!   	   if($ret_sql[0]['password'] == $this->_encrypt($str_userpswd)) {
    	       $ret_val = true;
    	   } else {

Index: base_loginplano.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/login/base_loginplano.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_loginplano.class.php	6 Aug 2004 10:23:10 -0000	1.3
--- base_loginplano.class.php	21 Aug 2004 19:16:31 -0000	1.4
***************
*** 39,44 ****
   
   // ESTE INCLUDE ELIMINARLO YA QUE ES DE PRUEBAS
! //include_once ("../../../common/miguel_base.inc.php");
! include_once(Util::app_Path("common/control/classes/base_loginbase.php"));
   
  class base_loginPlano extends base_loginBase
--- 39,44 ----
   
   // ESTE INCLUDE ELIMINARLO YA QUE ES DE PRUEBAS
! //include_once ('../../../common/miguel_base.inc.php');
! include_once(Util::app_Path('common/control/classes/base_loginbase.php'));
   
  class base_loginPlano extends base_loginBase
***************
*** 62,66 ****
    	} else {
    	   //dbg_var($ret_sql[0], __FILE__, __LINE__);
!   	   if($ret_sql[0]["password"] == $this->_encrypt($str_userpswd)) {
    	       $ret_val = true;
    	   } else {
--- 62,66 ----
    	} else {
    	   //dbg_var($ret_sql[0], __FILE__, __LINE__);
!   	   if($ret_sql[0]['password'] == $this->_encrypt($str_userpswd)) {
    	       $ret_val = true;
    	   } else {

Index: base_userinfo.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/model/classes/login/base_userinfo.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_userinfo.class.php	6 Aug 2004 10:23:10 -0000	1.3
--- base_userinfo.class.php	21 Aug 2004 19:16:31 -0000	1.4
***************
*** 40,44 ****
   */
   
! include_once(Util::app_Path("common/control/classes/base_login.php"));
   
  class miguel_UserInfo
--- 40,44 ----
   */
   
! include_once(Util::app_Path('common/control/classes/base_login.php'));
   
  class miguel_UserInfo
***************
*** 58,62 ****
      	} else {
      	   //dbg_var($ret_sql[0], __FILE__, __LINE__);
!     	   if($ret_sql[0]["idUser"] == 1) {
      	       $ret_val = true;
      	   } else {
--- 58,62 ----
      	} else {
      	   //dbg_var($ret_sql[0], __FILE__, __LINE__);
!     	   if($ret_sql[0]['idUser'] == 1) {
      	       $ret_val = true;
      	   } else {
***************
*** 83,87 ****
      	} else {
      	   //dbg_var($ret_sql[0], __FILE__, __LINE__);
!     	   if($ret_sql[0]["password"] == $str_password) {
      	       $ret_val = true;
      	   } else {
--- 83,87 ----
      	} else {
      	   //dbg_var($ret_sql[0], __FILE__, __LINE__);
!     	   if($ret_sql[0]['password'] == $str_password) {
      	       $ret_val = true;
      	   } else {
***************
*** 102,117 ****
      {
      	if($str_user == '') {
!     	   $ret_val = array ( "user_id"           => '',
!                             "name"          => '',
!                             "surname"       => '',
!                             "username"      => 'guest',
!                             "password"      => '',
!                             "email"         => '',
!                             "statut"        => '',
!                             "treatment"     => '',
!                             "language"      => '',
!                             "theme"         => '',
!                             "profile"       => 'guest',
!                             "isadmin"       => false);
      	} else {
              $ret_sql = $obj_model->Select('user',
--- 102,117 ----
      {
      	if($str_user == '') {
!     	   $ret_val = array ( 'user_id'           => '',
!                             'name'          => '',
!                             'surname'       => '',
!                             'username'      => 'guest',
!                             'password'      => '',
!                             'email'         => '',
!                             'statut'        => '',
!                             'treatment'     => '',
!                             'language'      => '',
!                             'theme'         => '',
!                             'profile'       => 'guest',
!                             'isadmin'       => false);
      	} else {
              $ret_sql = $obj_model->Select('user',
***************
*** 123,137 ****
      	   } else {
          	  //No incluimos informaci?n de la "tabla" o modelo de datos
!                   $ret_val = array ( "user_id"       => $ret_sql[0]["user_id"],
!         	                     "name"          => $ret_sql[0]["nom"],
!         	                     "surname"       => $ret_sql[0]["prenom"],
!         	                     "username"      => $ret_sql[0]["username"],
!         	                     "password"      => $ret_sql[0]["password"],
!         	                     "email"         => $ret_sql[0]["email"],
!         	                     "statut"        => $ret_sql[0]["statut"],
!         	                     "treatment"     => $ret_sql[0]["idtreatment"],
!         	                     "language"      => $ret_sql[0]["language"],
!                                "theme"         => $ret_sql[0]["theme"],
!                                "profile"       => $ret_sql[0]["profile"]);
      	   }
   	  }
--- 123,137 ----
      	   } else {
          	  //No incluimos informaci?n de la "tabla" o modelo de datos
!                   $ret_val = array ( 'user_id'       => $ret_sql[0]['user_id'],
!         	                     'name'          => $ret_sql[0]['nom'],
!         	                     'surname'       => $ret_sql[0]['prenom'],
!         	                     'username'      => $ret_sql[0]['username'],
!         	                     'password'      => $ret_sql[0]['password'],
!         	                     'email'         => $ret_sql[0]['email'],
!         	                     'statut'        => $ret_sql[0]['statut'],
!         	                     'treatment'     => $ret_sql[0]['idtreatment'],
!         	                     'language'      => $ret_sql[0]['language'],
!                                'theme'         => $ret_sql[0]['theme'],
!                                'profile'       => $ret_sql[0]['profile']);
      	   }
   	  }
***************
*** 147,152 ****
      {
        $arr_userinfo = $this->getInfo($obj_model, $str_username);
!       $arr_userinfo["isadmin"] = $this->isAdmin($obj_model, $str_username);
!       base_Controller::setSessionArray("userinfo", $arr_userinfo);
        $ret_val = true;
      }    
--- 147,152 ----
      {
        $arr_userinfo = $this->getInfo($obj_model, $str_username);
!       $arr_userinfo['isadmin'] = $this->isAdmin($obj_model, $str_username);
!       base_Controller::setSessionArray('userinfo', $arr_userinfo);
        $ret_val = true;
      }    



From nobody at sheep.berlios.de  Sat Aug 21 22:06:37 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 22:06:37 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/view includes.inc.php,1.3,1.4
Message-ID: <200408212006.i7LK6b630018@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/view
In directory sheep:/tmp/cvs-serv23939/andromeda/view

Modified Files:
	includes.inc.php 
Log Message:
Uso correcto de las comillas dobles

Index: includes.inc.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/view/includes.inc.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** includes.inc.php	6 Aug 2004 10:23:10 -0000	1.3
--- includes.inc.php	21 Aug 2004 20:06:35 -0000	1.4
***************
*** 32,55 ****
  //This variable is necessary. Don`t delete next line. 
  $phphtmllib = MIGUELBASE_PHPHTMLLIB; 
! include_once($phphtmllib."/includes.inc");
! include_once($phphtmllib."/form/includes.inc");
  
  /**
   * Include the control libraries
   */
! $viewlib = MIGUELBASE_DIR."view/classes/";
! $includelib = MIGUELBASE_DIR."include/classes/";
  
! //include($viewlib."base_element.class.php");
! //include($viewlib."base_header.class.php");
! //include($viewlib."base_footer.class.php");
! //include($viewlib."base_layoutpage.class.php");
! include($viewlib."base_formcontent.class.php");
! include($viewlib."base_submitbutton.class.php");
! include($viewlib."base_FETime.class.php");
! include($viewlib."base_FEImgRadioGroup.class.php");
! include($viewlib."base_FERadioGroup.class.php");
  
! include_once($includelib."theme.class.php");
  
  //Para tener la versi?n de phpHtmlLib usar la funci?n
--- 32,55 ----
  //This variable is necessary. Don`t delete next line. 
  $phphtmllib = MIGUELBASE_PHPHTMLLIB; 
! include_once($phphtmllib.'/includes.inc');
! include_once($phphtmllib.'/form/includes.inc');
  
  /**
   * Include the control libraries
   */
! $viewlib = MIGUELBASE_DIR.'view/classes/';
! $includelib = MIGUELBASE_DIR.'include/classes/';
  
! //include($viewlib.'base_element.class.php');
! //include($viewlib.'base_header.class.php');
! //include($viewlib.'base_footer.class.php');
! //include($viewlib.'base_layoutpage.class.php');
! include($viewlib.'base_formcontent.class.php');
! include($viewlib.'base_submitbutton.class.php');
! include($viewlib.'base_FETime.class.php');
! include($viewlib.'base_FEImgRadioGroup.class.php');
! include($viewlib.'base_FERadioGroup.class.php');
  
! include_once($includelib.'theme.class.php');
  
  //Para tener la versi?n de phpHtmlLib usar la funci?n



From nobody at sheep.berlios.de  Sat Aug 21 22:06:38 2004
From: nobody at sheep.berlios.de (luisllorente)
Date: Sat, 21 Aug 2004 22:06:38 +0200
Subject: [Migueloo-cvs] migueloo/modules/andromeda/view/classes base_FEImgRadioGroup.class.php,1.1,1.2 base_FERadioGroup.class.php,1.1,1.2 base_FETime.class.php,1.3,1.4 base_calendar.class.php,1.1,1.2 base_formcontent.class.php,1.3,1.4 base_layoutpage.class.php,1.3,1.4 base_submitbutton.class.php,1.3,1.4
Message-ID: <200408212006.i7LK6c630022@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/andromeda/view/classes
In directory sheep:/tmp/cvs-serv23939/andromeda/view/classes

Modified Files:
	base_FEImgRadioGroup.class.php base_FERadioGroup.class.php 
	base_FETime.class.php base_calendar.class.php 
	base_formcontent.class.php base_layoutpage.class.php 
	base_submitbutton.class.php 
Log Message:
Uso correcto de las comillas dobles

Index: base_FEImgRadioGroup.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/view/classes/base_FEImgRadioGroup.class.php,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** base_FEImgRadioGroup.class.php	6 Aug 2004 10:23:10 -0000	1.1
--- base_FEImgRadioGroup.class.php	21 Aug 2004 20:06:35 -0000	1.2
***************
*** 79,99 ****
      function _get_index_element($index) {
          $attributes = $this->_build_element_attributes();
!         $attributes["type"] = "radio";
  
          //list($name, $value) = each($this->_data_list[$index]);
  		
!         $attributes["value"] = $index + 1;
  
          if (($value == $this->get_value()))
!             $attributes[] = "checked";
  
          $tag = new INPUTtag($attributes);
  
          //now build the href so we can click on it.
!         //$attr["class"] ="form_link";
!         //$attr["href"] = "javascript:void(0)";
!         //$js = "javascript: function check(item){item.click();} ".
          //      "check(".$this->get_element_name().".item($index));";
!         //$attr["onclick"] = $js;
  
          $href = new Atag($attr, $value);
--- 79,99 ----
      function _get_index_element($index) {
          $attributes = $this->_build_element_attributes();
!         $attributes['type'] = 'radio';
  
          //list($name, $value) = each($this->_data_list[$index]);
  		
!         $attributes['value'] = $index + 1;
  
          if (($value == $this->get_value()))
!             $attributes[] = 'checked';
  
          $tag = new INPUTtag($attributes);
  
          //now build the href so we can click on it.
!         //$attr['class'] ='form_link';
!         //$attr['href'] = 'javascript:void(0)';
!         //$js = 'javascript: function check(item){item.click();} '.
          //      "check(".$this->get_element_name().".item($index));";
!         //$attr['onclick'] = $js;
  
          $href = new Atag($attr, $value);
***************
*** 104,106 ****
      }
  }
! ?>
\ No newline at end of file
--- 104,106 ----
      }
  }
! ?>

Index: base_FERadioGroup.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/view/classes/base_FERadioGroup.class.php,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** base_FERadioGroup.class.php	6 Aug 2004 10:23:10 -0000	1.1
--- base_FERadioGroup.class.php	21 Aug 2004 20:06:35 -0000	1.2
***************
*** 114,135 ****
      function _get_index_element($index, $img) {
          $attributes = $this->_build_element_attributes();
!         $attributes["type"] = "radio";
  
          list($name, $value) = each($this->_data_list[$index]);
!         $attributes["value"] = $value;
  
  
          if (($value == $this->get_value()))
!             $attributes[] = "checked";
  
          $tag = new INPUTtag($attributes);
  
          //now build the href so we can click on it.
!         $attr["class"] ="form_link";
!         $attr["href"] = "javascript:void(0)";
!         $js = "javascript: function check(item){item.click();} ".
                //"check(".$this->get_element_name().".item($index));";
! 			 "check(".$this->get_element_name().".item($index));";
!         $attr["onclick"] = $js;
  
          $href = new Atag($attr, $name);
--- 114,135 ----
      function _get_index_element($index, $img) {
          $attributes = $this->_build_element_attributes();
!         $attributes['type'] = 'radio';
  
          list($name, $value) = each($this->_data_list[$index]);
!         $attributes['value'] = $value;
  
  
          if (($value == $this->get_value()))
!             $attributes[] = 'checked';
  
          $tag = new INPUTtag($attributes);
  
          //now build the href so we can click on it.
!         $attr['class'] ='form_link';
!         $attr['href'] = 'javascript:void(0)';
!         $js = 'javascript: function check(item){item.click();} '.
                //"check(".$this->get_element_name().".item($index));";
! 			 'check('.$this->get_element_name().".item($index));";
!         $attr['onclick'] = $js;
  
          $href = new Atag($attr, $name);

Index: base_FETime.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/view/classes/base_FETime.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_FETime.class.php	6 Aug 2004 10:23:10 -0000	1.3
--- base_FETime.class.php	21 Aug 2004 20:06:35 -0000	1.4
***************
*** 154,159 ****
  
  //         we make sure that the date is valid
!         if ($value["hour"] < 0 || $value["hour"] > 23 ||$value["minute"] < 0 || $value["minute"] > 59) {
!             $this->set_error_message("Invalid date");
              return FALSE;
          }
--- 154,159 ----
  
  //         we make sure that the date is valid
!         if ($value['hour'] < 0 || $value['hour'] > 23 ||$value['minute'] < 0 || $value['minute'] > 59) {
!             $this->set_error_message('Invalid date');
              return FALSE;
          }
***************
*** 204,206 ****
      }
  }
! ?>
\ No newline at end of file
--- 204,206 ----
      }
  }
! ?>

Index: base_calendar.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/view/classes/base_calendar.class.php,v
retrieving revision 1.1
retrieving revision 1.2
diff -C2 -d -r1.1 -r1.2
*** base_calendar.class.php	6 Aug 2004 10:23:10 -0000	1.1
--- base_calendar.class.php	21 Aug 2004 20:06:35 -0000	1.2
***************
*** 14,18 ****
   * must have the BaseWidget
   */
! require_once( $phphtmllib."/widgets/BaseWidget.inc");
  /**
   * This class builds a calendar.
--- 14,18 ----
   * must have the BaseWidget
   */
! require_once( $phphtmllib.'/widgets/BaseWidget.inc');
  /**
   * This class builds a calendar.
***************
*** 76,80 ****
  	* @param array $locale - The language in which the calendar should be showed
  	*/
! 	function Calendar( $width = "150", $date, $locale = array("English","En")) {
  		if (isset($_REQUEST['CalendarDate'])) {
  			$this->_date = $_REQUEST['CalendarDate'];
--- 76,80 ----
  	* @param array $locale - The language in which the calendar should be showed
  	*/
! 	function Calendar( $width = '150', $date, $locale = array('English','En')) {
  		if (isset($_REQUEST['CalendarDate'])) {
  			$this->_date = $_REQUEST['CalendarDate'];
***************
*** 85,89 ****
  		setlocale (LC_TIME, $locale);
  		// First one is known sunday etc.
! 		$this->_DayNames = array(ucfirst(strftime("%a",mktime(0,0,0,11,2,2003))),ucfirst(strftime("%a",mktime(0,0,0,11,3,2003))),ucfirst(strftime("%a",mktime(0,0,0,11,4,2003))),ucfirst(strftime("%a",mktime(0,0,0,11,5,2003))),ucfirst(strftime("%a",mktime(0,0,0,11,6,2003))),ucfirst(strftime("%a",mktime(0,0,0,11,7,2003))),ucfirst(strftime("%a",mktime(0,0,0,11,8,2003))));
  	}
  
--- 85,89 ----
  		setlocale (LC_TIME, $locale);
  		// First one is known sunday etc.
! 		$this->_DayNames = array(ucfirst(strftime('%a',mktime(0,0,0,11,2,2003))),ucfirst(strftime('%a',mktime(0,0,0,11,3,2003))),ucfirst(strftime('%a',mktime(0,0,0,11,4,2003))),ucfirst(strftime('%a',mktime(0,0,0,11,5,2003))),ucfirst(strftime('%a',mktime(0,0,0,11,6,2003))),ucfirst(strftime('%a',mktime(0,0,0,11,7,2003))),ucfirst(strftime('%a',mktime(0,0,0,11,8,2003))));
  	}
  
***************
*** 145,150 ****
  		} else {
  			// Get year
! 			$year = date("Y",$this->_date);
! 			$data_table = html_table("",1,1,5);
  
  			// Setting the previous & next year
--- 145,150 ----
  		} else {
  			// Get year
! 			$year = date('Y',$this->_date);
! 			$data_table = html_table('',1,1,5);
  
  			// Setting the previous & next year
***************
*** 153,160 ****
  			// Extracting query string
  			if (isset($_SERVER['QUERY_STRING'])) {
! 				if (substr($_SERVER['QUERY_STRING'],0,12) == "CalendarDate") {
  					$query_string = substr($_SERVER['QUERY_STRING'],23);
  				} else {
! 					if ($_SERVER['QUERY_STRING'] != "") $query_string = "&" . $_SERVER['QUERY_STRING'];
  				}
  			}
--- 153,160 ----
  			// Extracting query string
  			if (isset($_SERVER['QUERY_STRING'])) {
! 				if (substr($_SERVER['QUERY_STRING'],0,12) == 'CalendarDate') {
  					$query_string = substr($_SERVER['QUERY_STRING'],23);
  				} else {
! 					if ($_SERVER['QUERY_STRING'] != '') $query_string = '&' . $_SERVER['QUERY_STRING'];
  				}
  			}
***************
*** 164,172 ****
  
  			// Add header
! 			$data_table->set_class("PHP_calendar");
  			$data_table->set_default_col_attributes(array('align' => 'center','valign' => 'baseline'));
  			$t_td = html_td('PHP_calendarHeader', 'center', $year);
  			$t_td->set_tag_attributes(array('colspan' => 2));
! 			$data_table->add_row(html_td('PHP_calendarHeader', 'center', html_a($prevYear, "&lt;&lt;")), $t_td,html_td('PHP_calendarHeader', 'center', html_a($nextYear, "&gt;&gt;")));
  
  			// adding months
--- 164,172 ----
  
  			// Add header
! 			$data_table->set_class('PHP_calendar');
  			$data_table->set_default_col_attributes(array('align' => 'center','valign' => 'baseline'));
  			$t_td = html_td('PHP_calendarHeader', 'center', $year);
  			$t_td->set_tag_attributes(array('colspan' => 2));
! 			$data_table->add_row(html_td('PHP_calendarHeader', 'center', html_a($prevYear, '&lt;&lt;')), $t_td,html_td('PHP_calendarHeader', 'center', html_a($nextYear, '&gt;&gt;')));
  
  			// adding months
***************
*** 178,182 ****
  					$this->_date = mktime(0,0,0,$month++,1, $year);
  					$Cell = html_td(NULL, 'center', $this->_DoMonth());
! 					$Cell->set_tag_attribute("valign","top");
  					$Row->add($Cell);
  				}
--- 178,182 ----
  					$this->_date = mktime(0,0,0,$month++,1, $year);
  					$Cell = html_td(NULL, 'center', $this->_DoMonth());
! 					$Cell->set_tag_attribute('valign','top');
  					$Row->add($Cell);
  				}
***************
*** 199,209 ****
  
  		// Get month and year
! 		$month = date("m",$this->_date);
! 		$year = date("Y",$this->_date);
  
  		$daysInMonth = $this->_getDaysInMonth($month, $year);
! 		$first = date("w",mktime(12, 0, 0, $month, 1, $year));
  
! 		$monthName = strftime("%b",$this->_date);
  
  		if (!$this->_ShowYear) {
--- 199,209 ----
  
  		// Get month and year
! 		$month = date('m',$this->_date);
! 		$year = date('Y',$this->_date);
  
  		$daysInMonth = $this->_getDaysInMonth($month, $year);
! 		$first = date('w',mktime(12, 0, 0, $month, 1, $year));
  
! 		$monthName = strftime('%b',$this->_date);
  
  		if (!$this->_ShowYear) {
***************
*** 218,225 ****
  		// Extracting query string
  		if (isset($_SERVER['QUERY_STRING'])) {
! 			if (substr($_SERVER['QUERY_STRING'],0,12) == "CalendarDate") {
  				$query_string = substr($_SERVER['QUERY_STRING'],23);
  			} else {
! 				if ($_SERVER['QUERY_STRING'] != "") $query_string = "&" . $_SERVER['QUERY_STRING'];
  			}
  		}
--- 218,225 ----
  		// Extracting query string
  		if (isset($_SERVER['QUERY_STRING'])) {
! 			if (substr($_SERVER['QUERY_STRING'],0,12) == 'CalendarDate') {
  				$query_string = substr($_SERVER['QUERY_STRING'],23);
  			} else {
! 				if ($_SERVER['QUERY_STRING'] != '') $query_string = '&' . $_SERVER['QUERY_STRING'];
  			}
  		}
***************
*** 229,243 ****
  
  		// Add header
! 		$data_table->set_class("PHP_calendar");
  		$data_table->set_default_col_attributes(array('align' => 'center'));
  		$t_td = html_td('PHP_calendarHeader', 'center', $header);
  		if (!$this->_ShowYear) {
  			$t_td->set_tag_attributes(array('colspan' => 5));
! 			$data_table->add_row(html_td('PHP_calendarHeader', NULL, html_a($prevMonth, "&lt;&lt;")), $t_td,html_td('PHP_calendarHeader', NULL, html_a($nextMonth, "&gt;&gt;")));
  		} else {
  			$t_td->set_tag_attributes(array('colspan' => 7));
  			$data_table->add_row($t_td);
  		}
! 		$t_tr = html_tr("PHP_calendarHeaderWeekdays",html_td(NULL, "center",  $this->_DayNames[($this->StartDay)%7]),html_td(NULL, "center", $this->_DayNames[($this->StartDay+1)%7]),html_td(NULL, "center", $this->_DayNames[($this->StartDay+2)%7]),html_td(NULL, "center", $this->_DayNames[($this->StartDay+3)%7]),html_td(NULL, "center", $this->_DayNames[($this->StartDay+4)%7]),html_td(NULL, "center", $this->_DayNames[($this->StartDay+5)%7]),html_td(NULL, "center", $this->_DayNames[($this->StartDay+6)%7]));
  		$data_table->add_row($t_tr);
  
--- 229,243 ----
  
  		// Add header
! 		$data_table->set_class('PHP_calendar');
  		$data_table->set_default_col_attributes(array('align' => 'center'));
  		$t_td = html_td('PHP_calendarHeader', 'center', $header);
  		if (!$this->_ShowYear) {
  			$t_td->set_tag_attributes(array('colspan' => 5));
! 			$data_table->add_row(html_td('PHP_calendarHeader', NULL, html_a($prevMonth, '&lt;&lt;')), $t_td,html_td('PHP_calendarHeader', NULL, html_a($nextMonth, '&gt;&gt;')));
  		} else {
  			$t_td->set_tag_attributes(array('colspan' => 7));
  			$data_table->add_row($t_td);
  		}
! 		$t_tr = html_tr('PHP_calendarHeaderWeekdays',html_td(NULL, 'center',  $this->_DayNames[($this->StartDay)%7]),html_td(NULL, 'center', $this->_DayNames[($this->StartDay+1)%7]),html_td(NULL, 'center', $this->_DayNames[($this->StartDay+2)%7]),html_td(NULL, 'center', $this->_DayNames[($this->StartDay+3)%7]),html_td(NULL, 'center', $this->_DayNames[($this->StartDay+4)%7]),html_td(NULL, 'center', $this->_DayNames[($this->StartDay+5)%7]),html_td(NULL, 'center', $this->_DayNames[($this->StartDay+6)%7]));
  		$data_table->add_row($t_tr);
  
***************
*** 253,260 ****
  
  			for ($i = 0; $i < 7; $i++) {
! 				if ($year == $today["year"] && $month == $today["mon"] && $d == $today["mday"]) {
! 					$class = "PHP_calendarToday";
  				} else {
! 					$class = "PHP_calendar";
  				}
  				if ($d > 0 && $d <= $daysInMonth) {
--- 253,260 ----
  
  			for ($i = 0; $i < 7; $i++) {
! 				if ($year == $today['year'] && $month == $today['mon'] && $d == $today['mday']) {
! 					$class = 'PHP_calendarToday';
  				} else {
! 					$class = 'PHP_calendar';
  				}
  				if ($d > 0 && $d <= $daysInMonth) {
***************
*** 262,266 ****
  					$link = $this->GetLink($d,$month,$year);
  					// checking if event
! 					if ($this->DayIsEvent(mktime(0,0,0,$month,$d,$year))) $class .= "Event";
  
  
--- 262,266 ----
  					$link = $this->GetLink($d,$month,$year);
  					// checking if event
! 					if ($this->DayIsEvent(mktime(0,0,0,$month,$d,$year))) $class .= 'Event';
  
  
***************
*** 269,278 ****
  						$objLink->set_tag_attribute('target', 'parent_popup');
  						//$objLink->set_tag_attribute('onMouseUp', 'window.close()');
! 						$t_row->add(html_td("$class","center",$objLink));
  					} else {
! 						$t_row->add(html_td("$class","center",$d));
  					}
  				} else {
! 					$t_row->add("&nbsp;");
  				}
  				$d++;
--- 269,278 ----
  						$objLink->set_tag_attribute('target', 'parent_popup');
  						//$objLink->set_tag_attribute('onMouseUp', 'window.close()');
! 						$t_row->add(html_td("$class",'center',$objLink));
  					} else {
! 						$t_row->add(html_td("$class",'center',$d));
  					}
  				} else {
! 					$t_row->add('&nbsp;');
  				}
  				$d++;
***************
*** 326,358 ****
  	function user_setup() {
  
! 		$this->add_entry(".PHP_calendarHeader", "",
! 						 array("font-size" => "12px",
! 							 "color" => "#db1c1c") );
  
! 		$this->add_entry(".PHP_calendarHeaderWeekdays", "",
! 						 array("font-size" => "12px",
! 							 "color" => "#db1c1c") );
  
! 		$this->add_entry(".PHP_calendar", "",
! 						 array("font-size" => "12px",
! 							 "color" => "#3363b7") );
  
! 		$this->add_entry(".PHP_calendarToday", "",
! 						 array("font-size" => "12px",
! 							 "background-color" => "#fffa00") );
  
! 		$this->add_entry(".PHP_calendarEvent", "",
! 						 array("font-size" => "12px",
! 							 "color" => "#3363b7",
! 							 "font-weight" => "bold") );
  
! 		$this->add_entry(".PHP_calendarTodayEvent", "",
! 						 array("font-size" => "12px",
! 							 "background-color" => "#fffa00",
! 							  "font-weight" => "bold") );
  
! 		$this->add_entry(".PHP_calendarlink", "",
! 						 array("font-size" => "12px",
! 							 "color" => "#db1c1c") );
  	}
  }
--- 326,358 ----
  	function user_setup() {
  
! 		$this->add_entry('.PHP_calendarHeader', '',
! 						 array('font-size' => '12px',
! 							 'color' => '#db1c1c') );
  
! 		$this->add_entry('.PHP_calendarHeaderWeekdays', '',
! 						 array('font-size' => '12px',
! 							 'color' => '#db1c1c') );
  
! 		$this->add_entry('.PHP_calendar', '',
! 						 array('font-size' => '12px',
! 							 'color' => '#3363b7') );
  
! 		$this->add_entry('.PHP_calendarToday', '',
! 						 array('font-size' => '12px',
! 							 'background-color' => '#fffa00') );
  
! 		$this->add_entry('.PHP_calendarEvent', '',
! 						 array('font-size' => '12px',
! 							 'color' => '#3363b7',
! 							 'font-weight' => 'bold') );
  
! 		$this->add_entry('.PHP_calendarTodayEvent', '',
! 						 array('font-size' => '12px',
! 							 'background-color' => '#fffa00',
! 							  'font-weight' => 'bold') );
  
! 		$this->add_entry('.PHP_calendarlink', '',
! 						 array('font-size' => '12px',
! 							 'color' => '#db1c1c') );
  	}
  }

Index: base_formcontent.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/view/classes/base_formcontent.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_formcontent.class.php	6 Aug 2004 10:23:10 -0000	1.3
--- base_formcontent.class.php	21 Aug 2004 20:06:35 -0000	1.4
***************
*** 104,108 ****
  	   $phpcode .= ');';
  	   
! 	   //echo "<pre>"; print_r($newparams); echo $phpcode; echo "</pre>";
  	   $elem = eval($phpcode);
  	   $elem->set_label_text($newparams[0]);
--- 104,108 ----
  	   $phpcode .= ');';
  	   
! 	   //echo '<pre>'; print_r($newparams); echo $phpcode; echo '</pre>';
  	   $elem = eval($phpcode);
  	   $elem->set_label_text($newparams[0]);
***************
*** 116,120 ****
  	    $button->set_style_attribute('id');
  	    $button->set_attribute('loc');
! 	    $button->onClick("disable=false");
  	   
  	    return($button);
--- 116,120 ----
  	    $button->set_style_attribute('id');
  	    $button->set_attribute('loc');
! 	    $button->onClick('disable=false');
  	   
  	    return($button);
***************
*** 133,141 ****
      {
  	    $label = $this->_getShowElement($name, $tab_index, $label, $text, $element);
!         $elem = html_td("", $align, $label);
!         //$elem->set_id("identification");
  	
  	    return($elem);
      }
  }
! ?>
\ No newline at end of file
--- 133,141 ----
      {
  	    $label = $this->_getShowElement($name, $tab_index, $label, $text, $element);
!         $elem = html_td('', $align, $label);
!         //$elem->set_id('identification');
  	
  	    return($elem);
      }
  }
! ?>

Index: base_layoutpage.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/view/classes/base_layoutpage.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_layoutpage.class.php	6 Aug 2004 10:23:10 -0000	1.3
--- base_layoutpage.class.php	21 Aug 2004 20:06:35 -0000	1.4
***************
*** 35,39 ****
   *
   */
! include_once(Util::base_Path("view/includes.inc.php"));
  
  /**
--- 35,39 ----
   *
   */
! include_once(Util::base_Path('view/includes.inc.php'));
  
  /**
***************
*** 128,132 ****
  
  
! 		$file_name = Util::app_Path($str_moduleName.'/view/classes/'.strtolower($str_className).".class.php");
  		
  		/*
--- 128,132 ----
  
  
! 		$file_name = Util::app_Path($str_moduleName.'/view/classes/'.strtolower($str_className).'.class.php');
  		
  		/*
***************
*** 187,191 ****
  				$path_action = Util::format_URLPath($str_url, $str_param);
  				$link = html_a($path_action);
! 				//$link = html_a("#","");
                  $link->add(html_img(Theme::getThemeImagePath($str_image), null, null, null, $str_image_text));
                  /*
--- 187,191 ----
  				$path_action = Util::format_URLPath($str_url, $str_param);
  				$link = html_a($path_action);
! 				//$link = html_a('#','');
                  $link->add(html_img(Theme::getThemeImagePath($str_image), null, null, null, $str_image_text));
                  /*
***************
*** 197,202 ****
  
                  $path_action = Util::format_URLPath($str_url, $str_param);
!                 $link->set_tag_attribute("onClick", "javascript:newWin('".$path_action."', ".$int_w.", ".$int_h.", ".$int_x.", ".$int_y.")");
! 				$link->set_tag_attribute("onClick", "javascript:ponerIframe('".$path_action."')");
  				*/
  				$link->set_tag_attribute('target', 'myFrame');
--- 197,202 ----
  
                  $path_action = Util::format_URLPath($str_url, $str_param);
!                 $link->set_tag_attribute('onClick', "javascript:newWin('".$path_action."', ".$int_w.", ".$int_h.", ".$int_x.", ".$int_y.")");
! 				$link->set_tag_attribute('onClick', "javascript:ponerIframe('".$path_action."')");
  				*/
  				$link->set_tag_attribute('target', 'myFrame');
***************
*** 300,304 ****
          //Incluimos el API de phpgacl
          //define('ADODB_DIR', MIGUELBASE_ADODB);
!                include_once(Util::base_Path("include/gacl/gacl.class.php"));
  
          //Probar el sistema de cache: ?para qu?? ADOdb cacheado ya.
--- 300,304 ----
          //Incluimos el API de phpgacl
          //define('ADODB_DIR', MIGUELBASE_ADODB);
!                include_once(Util::base_Path('include/gacl/gacl.class.php'));
  
          //Probar el sistema de cache: ?para qu?? ADOdb cacheado ya.

Index: base_submitbutton.class.php
===================================================================
RCS file: /cvsroot/migueloo/migueloo/modules/andromeda/view/classes/base_submitbutton.class.php,v
retrieving revision 1.3
retrieving revision 1.4
diff -C2 -d -r1.3 -r1.4
*** base_submitbutton.class.php	6 Aug 2004 10:23:10 -0000	1.3
--- base_submitbutton.class.php	21 Aug 2004 20:06:35 -0000	1.4
***************
*** 70,76 ****
  
          $attributes = $this->_build_element_attributes();
!         $attributes["type"] = "submit";
  
!         $attributes["value"] = $this->get_value();
  
          $tag = new INPUTtag($attributes);
--- 70,76 ----
  
          $attributes = $this->_build_element_attributes();
!         $attributes['type'] = 'submit';
  
!         $attributes['value'] = $this->get_value();
  
          $tag = new INPUTtag($attributes);
***************
*** 79,81 ****
      }
  }
! ?>
\ No newline at end of file
--- 79,81 ----
      }
  }
! ?>



From nobody at sheep.berlios.de  Mon Aug 23 17:07:52 2004
From: nobody at sheep.berlios.de (chet)
Date: Mon, 23 Aug 2004 17:07:52 +0200
Subject: [Migueloo-cvs] migueloo/modules/gettext/gl_ES/help_html - New directory
Message-ID: <200408231507.i7NF7q628281@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/gettext/gl_ES/help_html
In directory sheep:/tmp/cvs-serv25238/help_html

Log Message:
Directory /cvsroot/migueloo/migueloo/modules/gettext/gl_ES/help_html added to the repository




From nobody at sheep.berlios.de  Mon Aug 23 17:07:52 2004
From: nobody at sheep.berlios.de (chet)
Date: Mon, 23 Aug 2004 17:07:52 +0200
Subject: [Migueloo-cvs] migueloo/modules/gettext/gl_ES/LC_MESSAGES - New directory
Message-ID: <200408231507.i7NF7q628285@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/gettext/gl_ES/LC_MESSAGES
In directory sheep:/tmp/cvs-serv25238/LC_MESSAGES

Log Message:
Directory /cvsroot/migueloo/migueloo/modules/gettext/gl_ES/LC_MESSAGES added to the repository




From nobody at sheep.berlios.de  Mon Aug 23 17:19:02 2004
From: nobody at sheep.berlios.de (chet)
Date: Mon, 23 Aug 2004 17:19:02 +0200
Subject: [Migueloo-cvs] migueloo/modules/gettext/gl_ES/help_html EducAgenda.html,NONE,1.1 EducAnuncios.html,NONE,1.1 EducContent.html,NONE,1.1 EducCreateCourse.html,NONE,1.1 EducDescription.html,NONE,1.1 EducDocument.html,NONE,1.1 EducEjercicios.html,NONE,1.1 EducEnlaces.html,NONE,1.1 EducForum.html,NONE,1.1 EducGroup.html,NONE,1.1 EducInstall.html,NONE,1.1 EducReg.html,NONE,1.1 EducUser.html,NONE,1.1 EducWork.html,NONE,1.1
Message-ID: <200408231519.i7NFJ2628752@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/gettext/gl_ES/help_html
In directory sheep:/tmp/cvs-serv25836/gl_ES/help_html

Added Files:
	EducAgenda.html EducAnuncios.html EducContent.html 
	EducCreateCourse.html EducDescription.html EducDocument.html 
	EducEjercicios.html EducEnlaces.html EducForum.html 
	EducGroup.html EducInstall.html EducReg.html EducUser.html 
	EducWork.html 
Log Message:
Traducci?n al gallego (por Manuel Freire)

--- NEW FILE: EducAgenda.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<p>&Oacute; pulsar neste v&iacute;nculo abrir&aacute;senos unha fiestra
na cual seleccionar&aacute;nse os datos referentes &aacute; axenda,
como son a data, o t&iacute;tulo e unha pequena descripci&oacute;n do
evento, e unha vez realizado &oacute; pulsa-lo bot&oacute;n 'Validar',
a anotaci&oacute;n ser&aacute; visible &oacute;s alumnos. Cando creamos
un curso, autom&aacute;ticamente xen&eacute;rase un evento
correspondente &aacute; data e hora de creaci&oacute;n do mesmo.
</p>
</body>
</html>

--- NEW FILE: EducAnuncios.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
Aqu&iacute; insertar&eacute;mo-los anuncios que desexemos facer,
podendo tam&eacute;n notifica-los de forma autom&aacute;tica a todo-los
alumnos matriculados, para o que activaremo-la caxeti&ntilde;a
correspondente.
Posteriormente podemos modificar ou borrar os anuncios.
</body>
</html>

--- NEW FILE: EducContent.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<p>A pantalla principal estruct&uacute;rase en tres partes ben
distintas, como son:
</p>
<ul>
  <li>1.- A parte superior.</li>
  <li>2.- Corpo da p&aacute;xina (Centros)</li>
  <li>3.- Zona de acceso e inscripci&oacute;n.</li>
</ul>
<p></p>
<p>
<b>1.- A parte superior.</b>
<br>
Nesta zona da pantalla atop&aacute;monos cunha serie de
ligaz&oacute;ns. O primeiro (de esquerda a dereita) cond&uacute;cenos
&aacute; p&aacute;xina principal de miguel (na que agora mesmo nos
atopamos), seguidamente temos un ligaz&oacute;n &aacute; p&aacute;xina
principal de Indetec (desenvolvedor do proxecto) e por &uacute;ltimo
outro &aacute; p&aacute;xina principal da s&uacute;a
Organizaci&oacute;n.
</p>
<p>
<b>2.- Corpo da p&aacute;gina (Centros)</b>
<br>
Aqu&iacute; figura a relaci&oacute;n dos centros &oacute;s que podemos
acceder ou, o que &eacute; o mesmo, una relaci&oacute;n das facultades
que se atopan activas, aparecendo entre par&eacute;ntesis o
n&uacute;mero de cursos que hai en cada unha delas.
<br>
Cando seleccionamos un Centro ou Facultade, am&oacute;sasenos un
listado c&oacute;s cursos que se atopan dispo&ntilde;ibles.
<br>
Neste listado unicamente m&oacute;stranse os cursos que non son de
acceso privado.
<br>
Dependendo da configuraci&oacute;n do curso poderemos entrar facendo
clic c&oacute; rato enriba do nome. Pode ser que sexa de acceso
p&uacute;blico, que precisemos ter un usuario rexistrado en miguel ou
ben sermos invitados &oacute; curso.
</p>
<p>
<b>3.- Zona de acceso e inscripci&oacute;n.</b>
<br>
Nesta parte, com&uacute;n a toda-las p&aacute;ginas da
aplicaci&oacute;n, teremos o acceso &aacute; zona de usuarios, onde
existen d&uacute;as partes ben distintas. Na primeira delas figuran
d&uacute;as caxeti&ntilde;as nas que insertar&eacute;mo-lo noso nome de
usuario e
contrasinal, unha vez feito e tras pulsa-lo bot&oacute;n 'Entrar'
accederemos &aacute; nosa configuraci&oacute;n dentro da
aplicaci&oacute;n.
<br>
<br>
&nbsp; Na segunda parte atopar&eacute;monos unha serie de
opci&oacute;ns como son:
</p>
<ul>
  <li><b>Inscripci&oacute;n:</b> Aqu&iacute; rexistrar&eacute;monos a
primeira vez que entremos, cun nome de usuario e contrasinal para
acceder a todo-los servicios da aplicaci&oacute;n en
funci&oacute;n de c&oacute;mo fagamos dito rexistro.</li>
  <li><b>Axuda:</b> Presenta unhas breves indicaci&oacute;ns sobre como
traballar na fiestra na que nos atopemos en cada momento.</li>
  <li><b>Foro de soporte:</b> Este ligaz&oacute;n cond&uacute;cenos
&aacute; p&aacute;xina de Hispalinux, na cal at&oacute;pase un foro de
discusi&oacute;n e consulta onde poder&aacute; plantexar as s&uacute;as
d&uacute;bidas, consultas e suxerencias, sendo este un medio de
comunicaci&oacute;n entre e para os usuarios.</li>
</ul>
<p></p>
</body>
</html>

--- NEW FILE: EducCreateCourse.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<p>Para crear un curso debe completa-los seguintes campos que son
obrigatorios:
</p>
<ul>
  <li><b>T&iacute;tulo:</b> Este campo identificar&aacute; a asignatura.</li>
  <li><b>Facultade:</b> Aquela &aacute; que pertence a asignatura. Esta
seleccionarase entre as que aparecen no men&uacute; despleg&aacute;bel.</li>
  <li><b>C&oacute;digo do curso:</b> C&oacute;digo asignado para a
identificaci&oacute;n do curso. Se na s&uacute;a organizaci&oacute;n
non lle asignan un c&oacute;digo de curso, vostede p&oacute;deo
inventar (lembre que &eacute; &uacute;nico e non pode te-lo mesmo que
outros cursos).</li>
  <li><b>Titular:</b> Aqu&iacute; farase consta-lo que ser&aacute; o
titular ou encargado de coordina-lo curso seleccionado.</li>
  <li><b>Lingua:</b> Nesta &uacute;ltimo campo faremos consta-lo
idioma que se ha utilizar &oacute; longo do curso.</li>
</ul>
<br>
<p>
Una vez cubertos todo-los campos premerase o bot&oacute;n 'Validar'
aparecendo unha nova p&aacute;xina na que se nos indica que se creou a
web do curso c&oacute; c&oacute;digo que introduxemos&nbsp; na
p&aacute;xina anterior. Nesta p&aacute;xina apar&eacute;cenos un
ligaz&oacute;n que nos leva directamente &oacute; curso que
anteriormente creamos.
</p>
</body>
</html>

--- NEW FILE: EducDescription.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<p>Aqu&iacute; &eacute; onde o profesor realiza unha descripci&oacute;n
do curso.
</p>
<p>A informaci&oacute;n que se pode atopar aqu&iacute; &eacute; a
seguinte:
</p>
<ul>
  <li>Descripci&oacute;n do curso</li>
  <li>Calificaci&oacute;n e obxectivos</li>
  <li>Contido do curso</li>
  <li>Actividades de aprendizaxe e pr&aacute;cticas</li>
  <li>Axudas</li>
  <li>Recursos humanos e materiales</li>
  <li>M&eacute;todos de evaluaci&oacute;n e outros</li>
</ul>
<p></p>
</body>
</html>

--- NEW FILE: EducDocument.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<p>O m&oacute;dulo de xesti&oacute;n de documentos asem&eacute;llase no
seu funcionameno a xesti&oacute;n dos documentos nun ordenador. </p>
<p>Vostede pode introducir documentos de calquera tipo (HTML, Word,
Powerpoint, Excel, Acrobat, Flash, Quicktime, etc). Te&ntilde;a en
conta, sen embargo, o feito de que os estudiantes deben de
dispo&ntilde;er das ferramentas axeitadas para poder consultalos.
Te&ntilde;a tam&eacute;n coidado de non enviar documentos infectados
con virus. &Eacute; recomend&aacute;bel comprobar primeiro cun programa
antivirus que os documentos non estean infectados antes de colocalos no
iCampus.</p>
<p>Os documentos pres&eacute;ntanse en pantalla por orde
alfab&eacute;tica.<br>
<b>Consellos:</b> se vostede desexa que os documentos sexan ordenados
de xeito diferente, pode facelos preceder dun n&uacute;mero e a
partires dese intre ordenaranse seguindo est&aacute; base. </p>
<p>Vostede pode:</p>
<h4>Cargar a distancia un documento neste m&oacute;dulo</h4>
<ul>
  <li>Seleccione o documento no seu ordenador coa axuda do bot&oacute;n
"Buscar" <input type="submit" value="Buscar" name="submit2"> &aacute;
beira dereita da pantalla.</li>
  <li>Faga a carga a distancia coa axuda do bot&oacute;n "cargar a
distancia" <input type="submit" value="cargar" a="" distancia=""
 name="submit2"> .</li>
</ul>
<h4>Cambia-lo nome dun documento (ou dun directorio)</h4>
<ul>
  <li>Prema o bot&oacute;n <img src="%3C?php" echo=""
 $urlserver/miguel/image/filemanager="" ;="" ?="">/renommer.gif
width=20 height=20 align=baseline&gt; na columna "Cambiar nome".</li>
  <li>Introduza o novo nome na zona prevista que aparecer&aacute;
arriba &aacute; esquerda.</li>
  <li>Validar facendo clic en "OK" <input type="submit" value="OK"
 name="submit24"> . </li>
</ul>
<h4>Suprimir un documento (ou un directorio)</h4>
<ul>
  <li>Prema o bot&oacute;n <img src="%3C?php" echo=""
 $urlserver/miguel/image/filemanager="" ;="" ?="">/supprimer.gif
width=20 height=20&gt; na columna "Suprimir".</li>
</ul>
<h4>Facer que un documento sexa invisible para os estudiantes (ou un
directorio)</h4>
<ul>
  <li>Prema o bot&oacute;n <img src="%3C?php" echo=""
 $urlserver/miguel/image/filemanager="" ;="" ?="">/visible.gif width=20
height=20&gt; na columna "Visible/invisible".</li>
  <li>O documento (ou o directorio) segue a existir, pero xa non
&eacute; visible para os estudiantes.</li>
  <li>Si desexa que este elemento volva a ser visible, prema outra vez
o bot&oacute;n <img src="%3C?php" echo=""
 $urlserver/miguel/image/filemanager="" ;="" ?="">/invisible.gif
width=24 height=20&gt; na columna "Visible/invisible".</li>
</ul>
<h4>Agregar ou modificar un comentario a un documento (ou a un
directorio)</h4>
<ul>
  <li>Prema o bot&oacute;n <img src="%3C?php" echo=""
 $urlserver/miguel/image/filemanager="" ;="" ?="">/comment.gif width=20
height=20&gt; na columna "Comentario".</li>
  <li>Introduza o novo comentario na zona prevista que aparecer&aacute;
arriba &aacute; esquierda.</li>
  <li>Valide facendo clic en "OK" <input type="submit" value="OK"
 name="submit2"> .</li>
</ul>
<p>Se desexa suprimir un comentario, prema o bot&oacute;n <img
 src="%3C?php" echo="" $urlserver/miguel/image/filemanager="" ;="" ?="">/comment.gif
width=20 height=20&gt;, "borra-lo antigo comentario da zona" e valide
facendo clic en "OK" <input type="submit" value="OK" name="submit22">
. </p>
<hr>
<p>Vostede pode tam&eacute;n organiza-lo contido do m&oacute;dulo de
documentos gardando os documentos en directorios. Para facelo vostede
debe:</p>
<h4><b>Crear un directorio</b></h4>
<ul>
  <li>Prema a funci&oacute;n "<img src="%3C?php" echo=""
 $urlserver/miguel/image/filemanager="" ;="" ?="">/dossier.gif width=20
height=20&gt;crear un directorio" arriba &aacute; esquerda da pantalla.</li>
  <li>Introduza o nome do seu novo directorio na zona prevista arriba
&aacute; esquerda da pantalla.</li>
  <li>Valide facendo clic en "OK" <input type="submit" value="OK"
 name="submit23"> .</li>
</ul>
<h4>Desplazar un documento (ou un directorio)</h4>
<ul>
  <li>Prema o bot&oacute;n <img src="%3C?php" echo=""
 $urlserver/miguel/image/filemanager="" ;="" ?="">/deplacer.gif
width=34 height=16&gt; na columna "desplazar".</li>
  <li>Escolla o directorio &oacute; que vostede quere desplaza-lo
documento ou directorio no men&uacute; de selecci&oacute;n previsto que
aparecer&aacute; arriba &aacute; esquerda. (Nota: a palabra "raiz" en
dito men&uacute; representa a raiz (base) do seu m&oacute;dulo de
documentos).</li>
  <li>Valide facendo clic en "OK" <input type="submit" value="OK"
 name="submit232"> .</li>
</ul>
<center>
<p></p>
</center>
</body>
</html>

--- NEW FILE: EducEjercicios.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<p>Isto &eacute; un xenerador de preguntas. Permita a
realizaci&oacute;n dun exame de resposta m&uacute;ltiple. De calqueira
forma, son formativos, xa que o sistema non &eacute; o suficientemente
seguro como para garantiza-lo correcto reconto das preguntas do test.
</p>
<p>O principio deste sistema de puntuaci&oacute;n &eacute; defini-lo
valor do n&uacute;mero de respostas correctas por pregunta. Por
exemplo, se tes unha pregunta con catro respostas (posiblemente
m&aacute;is de unha correcta) e tes d&uacute;as mal e d&uacute;as ben,
pode te-la metade dos puntos, pero tam&eacute;n pode ser que o profesor
vexa que non &eacute; correcto e darlle, por exemplo, a m&aacute;xima
puntuaci&oacute;n se todo &eacute; correcto e cero puntos para calquera
outra combinaci&oacute;n. </p>
</body>
</html>

--- NEW FILE: EducEnlaces.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<p>Aqu&iacute; poderemos incluir ligaz&oacute;ns a p&aacute;xinas web
que nos parezan interesantes. Para facelo premeremos o icono
"Ligaz&oacute;ns", o que nos levar&aacute; a unha p&aacute;xina cos
ligaz&oacute;ns xa introducidos e na cal poderemos agregar os que
gustemos, introducindo a direcci&oacute;n do ligaz&oacute;n na
caxeti&ntilde;a marcada como "URL", e na caxeti&ntilde;a "Nome do
enlace" faremos consta-lo t&iacute;tulo da p&aacute;xina en
cuesti&oacute;n, namentres que en "Descripci&oacute;n" poderemos
incluir unha pequena nota sobre o contido ou a funcionalidade da
p&aacute;xina.</p>
<br>
<p>Unha vez cubertos os campos e tras premer-lo bot&oacute;n 'aceptar',
aparecer&aacute;senos unha p&aacute;xina na que se indicar&aacute; que
o ligaz&oacute;n foi agregado, preguntando se desezamos volver &aacute;
lista de ligaz&oacute;ns. Cada un destes ligaz&oacute;ns pode ser
borrado ou ben modificado facendo clic nas opci&oacute;ns que aparecen
debaixo de cada ligaz&oacute;n.
</p>
</body>
</html>

--- NEW FILE: EducForum.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<p>O foro &eacute; unha ferramenta de discusi&oacute;n
asincr&oacute;nica por escrito. A diferencia do email, o foro coloca a
discusi&oacute;n nun espacio p&uacute;blico ou semi-p&uacute;blico.</p>
<p>Para utiliza-la ferramenta do foro de iCampus, os estudiantes
s&oacute; te&ntilde;en necesidade dun simple navegador web (Mozilla,
Explorer...), non se necesita ter un cliente de email (Eudora,
Outlook...).</p>
<p>Para organiza-los foros, prema 'administrar'. Os intercambios quedan
organizados dun modo xer&aacute;rquico seguindo a seguinte estructura:</p>
<p><b>Categor&iacute;a &gt; Foro &gt; Tema &gt; Resposta</b></p>
<p>Para permitir &oacute;s estudiantes discutir de forma estructurada,
&eacute; indispensable organiza-los intercambios previamente en
categor&iacute;as e foros (a eles corresponderalles crear temas e dar
respuestas). Por defecto, o foro cont&eacute;n &uacute;nicamente a
categor&iacute;a "P&uacute;blico", un tema de exemplo e unha mensaxe de
exemplo. Vostede pode agregar foros na categor&iacute;a
"P&uacute;blico", ou ben modifica-lo seu t&iacute;tulo ou crear outras
categor&iacute;as nas que ser&aacute; preciso ent&oacute;n crear novos
foros. <span style="font-weight: bold;">Unha categor&iacute;a que non
cont&eacute;n ning&uacute;n foro non se mostra e est&aacute; fora de
servicio</span>. Se, por exemplo, vostede crea unha categor&iacute;a
"Discusi&oacute;ns para grupos reducidos", faralle falta crear unha
serie de foros nesta segunda categor&iacute;a, por exemplo, "Grupo 1",
"Grupo 2", "Grupo 3", etc.</p>
<p>A descripci&oacute;n dun foro de grupo pode se-la lista de persoas
que est&aacute;n invitadas a participar e discutir no mesmo, pero
tam&eacute;n pode ser unha explicaci&oacute;n sobre o porqu&eacute; do
foro. Se vostede crea, por calquera motivo, un foro "Chamadas de
axuda", pode agregar como descripci&oacute;n: "Se&ntilde;alar
dificultades en relaci&oacute;n &oacute; contido ou o dispositivo".</p>
</body>
</html>

--- NEW FILE: EducGroup.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<p>Aqu&iacute; poderemos xenera-los grupos de traballo existentes para
o curso. Para facelo hay que preme-la opci&oacute;n "Crear novo(s)
grupo(s)", o que nos dirixir&aacute; a unha pantalla na que se nos
permitir&aacute; crear un ou varios grupos (se ben posteriormente
poderemos agregar m&aacute;is) cun n&uacute;mero de asentos
m&aacute;ximo por grupo, se ben este par&aacute;metro &eacute;
opcional. Unha vez validada a creaci&oacute;n do grupo,
devolver&aacute;senos &aacute; p&aacute;xina anterior aparecendo na
parte inferior do grupo xa creado, o cal pode ser modificado. Para
facelo premeremo-lo icono "Editar", o que nos levar&aacute; a unha
p&aacute;xina na que podemos asigna-las caracter&iacute;sticas do
grupo. Para facelo teremos que cubrir unha serie de campos, como son:
T&iacute;tulo do curso, Tutor, unha breve descripci&oacute;n do curso
(opcional), o n&uacute;mero m&aacute;ximo de personal que
formar&aacute; o grupo e por &uacute;ltimo as persoas que
formar&aacute;n o grupo, para o cal sinalaremos a cada unha das persoas
que dese&ntilde;amos agregar ou eliminar e pulsaremo-los botones de
dobre frecha. A que sinala &aacute; dereita permite agregar, namentres
que a que apunta cara a esquerda utilizarase para quitar membros. Por
&uacute;ltimo e unha vez te&ntilde;amos cuberto todo-los campos,
premeremo-lo bot&oacute;n "Validar" para garda-los cambios.</p>
<p>Podemos tam&eacute;n borrar un grupo determinado dende as
opci&oacute;ns de grupo, ou ben eliminar todo-los grupos no bloque de
opci&oacute;ns que figuran na parte superior da p&aacute;xina. Ou ben
podemos vacia-los grupos co fin de definir novamente as
caracter&iacute;sticas de cada un deles. Nesta mesma p&aacute;xina
podemos cambiar igualmente as opci&oacute;ns dos grupos, o que nos
permite autorizar &oacute;s alumnos a d&aacute;rense de alta nos
grupos, asignar un foro &oacute; grupo e que este sexa privado ou
p&uacute;blico e por &uacute;ltimo podemos activa-la opci&oacute;n de
utilizar documentos ou non. Do mesmo xeito que no resto das
p&aacute;xinas, quedar&iacute;anos preme-lo bot&oacute;n "Validar" para
acepta-los cambios.
</p>
</body>
</html>

--- NEW FILE: EducInstall.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<h1>Instalaci&oacute;n e Configuraci&oacute;n de miguel</h1>
<br>
<p>Aqu&iacute; deben ir as instrucci&oacute;ns para a
instalaci&oacute;n de miguel.</p>
</body>
</html>

--- NEW FILE: EducReg.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<p>Este &eacute; o primeiro paso que se debe realizar unha vez entremos
na aplicaci&oacute;n, xa que de non estarmos rexistrados na mesma non
poderemos participar dos beneficios que aporta esta aplicaci&oacute;n,
non podendo acceder a moitos dos seus apartados.
</p>
<p>
&Oacute; pulsarmo-lo ligaz&oacute;n 'Inscripci&oacute;n'
dirixir&aacute;senos a unha p&aacute;xina na que introduciremo-los
nosos datos personales a fin de formar parte da base de datos de
miguel, sexa como <span style="font-style: italic;">profesor ou como
estudiante</span>, segundo a opci&oacute;n que elixamos no campo
correspondente.
</p>
Os datos que se nos han pedir nesta p&aacute;xina ser&aacute;n os
seguintes:
<ul>
  <li><b>Nome:</b> Faremos consta-lo noso nome de pila.</li>
  <li><b>Apelidos:</b> Sen m&aacute;is comentarios.</li>
  <li><b>Nome de usuario:</b> Aquel c&oacute; que seremos identificados
po-la aplicaci&oacute;n (pode se-lo noso nome ou un pseud&oacute;nimo).
Deberase ter en conta que a aplicaci&oacute;n distingue entre
mai&uacute;sculas e min&uacute;sculas.</li>
  <li><b>Clave de acceso:</b> Aqu&iacute; introduciremos un contrasinal
que nos dar&aacute; acceso &aacute; aplicaci&oacute;n, o mesmo tempo
que impedir&aacute; que outros accedan a ela utilizando os nosos datos.
Igual que no campo anterior e no seguinte diferenciarase entre
mai&uacute;sculas e min&uacute;sculas.</li>
  <li><b>Clave de acceso (confirmaci&oacute;n):</b> Neste campo
volveremos a introduci-lo contrasinal exactamente como o puxemos no
campo anterior. Isto faise para comprobar que non nos trabucamos o
teclea-la clave, pois esta non aparecer&aacute; visible en pantalla,
sen&oacute;n oculta tras asteriscos. <br>
  </li>
  <li><b>Correo electr&oacute;nico:</b> Aqu&iacute; faremos constar
unha direcci&oacute;n de correo electr&oacute;nico na que recibiremos
comunicaci&oacute;ns e notificaci&oacute;ns.</li>
  <li><b>Estado:</b> Neste &uacute;ltimo campo seleccionaremo-la
opci&oacute;n coa que imos ser rexistrados na aplicaci&oacute;n,
podendo seleccionar no men&uacute; despleg&aacute;bel entre a
opci&oacute;n de rexistrarnos como estudiante ou como profesor.</li>
</ul>
<br>
<p>Unha vez te&ntilde;amos cuberto todo-los campos correspondentes
&oacute;s datos personales, premeremo-lo bot&oacute;n 'Aceptar' e
pasaremos a formar parte da base de datos da aplicaci&oacute;n. <b>A
s&uacute;a
informaci&oacute;n persoal non ser&aacute; cedida, entregada ou vendida
a terceras partes</b> &oacute; ter como finalidade exclusiva
controla-lo acceso autorizado &aacute; aplicaci&oacute;n.
</p>
<p>Se nos rexistramos como <b>estudiante</b> aparecer&aacute;senos
outra pantalla na que seleccionaremo-los cursos &oacute;s que nos
desexamos inscribir coa indicaci&oacute;n de que se enviou &aacute;
direcci&oacute;n de correo electr&oacute;nico coa que nos rexistramos
unha notificaci&oacute;n de alta na base de datos. Seguidamente e tras
preme-lo bot&oacute;n 'Aceptar', aparecer&aacute;seno-la &uacute;ltima
fiestra cun ligaz&oacute;n que nos redireccionar&aacute; &oacute;
'campus', finalizando
aqu&iacute; o proceso de rexistro como usuario.
</p>
<p>
No caso de efectua-lo rexistro como <b>profesor</b>,tras ter cuberto
os datos personales aparecer&aacute;senos outra p&aacute;xina na que
h&aacute;senos de solicitar unha serie de datos obrigatorios, como son:
</p>
<ul>
  <li><b>Titulo:</b> Este campo identificar&aacute; &aacute; asignatura.</li>
  <li><b>Facultade:</b> Aquela &aacute; que pertence a asignatura. Esta
seleccionarase entre as que aparecen no men&uacute;
despleg&aacute;bel.</li>
  <li><b>C&oacute;digo do curso:</b> C&oacute;digo asignado para a
identificaci&oacute;n do curso.</li>
  <li><b>Titular:</b> Aqu&iacute; farase consta-lo que
ser&aacute; o titular ou encargado de coordina-lo curso.</li>
  <li><b>Lingua:</b> Nesta &uacute;ltimo campo faremos consta-lo
idioma que hase utilizar &oacute; longo do curso.</li>
</ul>
<br>
<p>Unha vez cubertos todo-los campos, premerase o bot&oacute;n
'Validar', aparecendo unha nova p&aacute;xina na que se nos indica que
se creou a web do curso c&oacute; c&oacute;digo que introduxemos na
p&aacute;xina anterior. Nesta p&aacute;xina apareceranos un
ligaz&oacute;n que nos levar&aacute; directamente &oacute; curso que
acabamos de crear.
</p>
</body>
</html>

--- NEW FILE: EducUser.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<b>Papeis (roles)</b>
<p>Os papeis (roles) non tienen ninguna funci&oacute;n
inform&aacute;tica. Non otorgan ning&uacute;n dereito sobre o sistema.
Vostede pode modificalos facendo clic sobre 'modificar' debaixo do
'rol/papel' o despois introducindo toda-las letras da
descripci&oacute;n da funci&oacute;n desexada: profesor, asistente,
tutor, visitante, documentalista, experto, moderador... Isto s&oacute;
servir&aacute; para indicar p&uacute;blicamente que rol (papel) que
desenvolve no curso.</p>
<hr><b>Dereitos de administraci&oacute;n</b>
<p>Os dereitos de administraci&oacute;n, po-la contra, ref&iacute;rense
&oacute; sistema inform&aacute;tico. Actualmente, p&oacute;dese
escoller entre <b>todos</b> (modificar todo, suprimir todo, agregar
todo) e <b>ning&uacute;n</b> (ademais do dereito de visita-la web,
publicar mensaxes no foro e traballos via a p&aacute;xina 'traballos').</p>
<p>Para permitires a un co-titular, un asistente, un tutor ou quien
sexa se-lo co-administrar da web con vostede, debe inscribilo
previamente no seu curso ou asegurarse que xa est&aacute; inscrito e
despois modifica-los dereitos que lle corresponden facendo clic sobre
'modificar' debaixo de 'dereitos de administraci&oacute;n' e marcando
'todos'.</p>
<hr><b>Co-titulares</b>
<p>Para facer que figure o nombre dun co-titular na cabeceira do curso,
utilice a p&aacute;xina 'Modifica-la informaci&oacute;n sobre o curso'
(nas ferramientas de cor laranxa). Esta modificaci&oacute;n da
cabeceira do curso non inscribe autom&aacute;ticamente a este
co-titular como usuario do curso. Tr&aacute;tase de d&uacute;as
acci&oacute;ns distintas.</p>
<hr><b>Agregar un usuario</b>
<p>Para agregar un usuario &oacute; seu curso, comprobe primero se xa
est&aacute; inscrito no iCampus utilizando o motor de b&uacute;squeda.
Se xa est&aacute; inscrito, marque a caxeti&ntilde;a que aparece
&aacute; beira do seu nome e valide. Se todav&iacute;a non est&aacute;
inscrito agr&eacute;gueo manualmente. Nos dous casos, a persoa
recibir&aacute; un email de confirmaci&oacute;n da s&uacute;a
inscripci&oacute;n contendo o seu nome de usuario e o seu contrasinal,
excepto no caso de que vostede non introducira o seu email.</p>
</body>
</html>

--- NEW FILE: EducWork.html ---
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<p>O m&oacute;dulo de xesti&oacute;n de traballos asem&eacute;llase no
seu funcionameno a xesti&oacute;n dos documentos nun ordenador.<br>
<br>
Vostede pode introducir traballos de calquera tipo (HTML, Word,
Powerpoint, Excel, Acrobat, Flash, Quicktime, etc). Te&ntilde;a en
conta, sen embargo, o feito de que os profesores deben de
dispo&ntilde;er das ferramentas axeitadas para poder consultalos.
Te&ntilde;a tam&eacute;n coidado de non enviar traballos infectados
con virus. &Eacute; recomend&aacute;bel comprobar primeiro cun programa
antivirus que os traballos non estean infectados antes de colocalos en
miguel.<br>
</p>
<p>Os traballos pres&eacute;ntanse en pantalla por orde
alfab&eacute;tica.<br>
<b>Consellos:</b> se vostede desexa que os traballos sexan ordenados
de xeito diferente, pode facelos preceder dun n&uacute;mero e a
partires dese intre ordenaranse seguindo est&aacute; base. </p>
<p>Vostede pode:<br>
</p>
<h4>Cargar a distancia un traballo neste m&oacute;dulo</h4>
<ul>
  <li>Seleccione o traballo no seu ordenador coa axuda do bot&oacute;n
"Buscar" <input type="submit" value="Buscar" name="submit2"> &aacute;
beira dereita da pantalla.</li>
  <li>Faga a carga a distancia coa axuda do bot&oacute;n "cargar a
distancia" <input type="submit" value="cargar" a="" distancia=""
 name="submit2"> .</li>
</ul>
<h4>Cambia-lo nome dun traballo (ou dun directorio)</h4>
<ul>
  <li>Prema o bot&oacute;n <img
 src="file:///home/droggo/Proyectos/migueloo/migueloo/modules/gettext/gl_GL/help_html/%3C?php"
 echo="" $urlserver/miguel/image/filemanager="" ;="" ?="">/renommer.gif
width=20 height=20 align=baseline&gt; na columna "Cambiar nome".</li>
  <li>Introduza o novo nome na zona prevista que aparecer&aacute;
arriba &aacute; esquerda.</li>
  <li>Validar facendo clic en "OK" <input type="submit" value="OK"
 name="submit24"> . </li>
</ul>
<h4>Suprimir un traballo (ou un directorio)</h4>
<ul>
  <li>Prema o bot&oacute;n <img
 src="file:///home/droggo/Proyectos/migueloo/migueloo/modules/gettext/gl_GL/help_html/%3C?php"
 echo="" $urlserver/miguel/image/filemanager="" ;="" ?="">/supprimer.gif
width=20 height=20&gt; na columna "Suprimir".</li>
</ul>
<h4>Facer que un traballo sexa invisible para os estudiantes (ou un
directorio)</h4>
<ul>
  <li>Prema o bot&oacute;n <img
 src="file:///home/droggo/Proyectos/migueloo/migueloo/modules/gettext/gl_GL/help_html/%3C?php"
 echo="" $urlserver/miguel/image/filemanager="" ;="" ?="">/visible.gif
width=20
height=20&gt; na columna "Visible/invisible".</li>
  <li>O traballo (ou o directorio) segue a existir, pero xa non
&eacute; visible para os estudiantes.</li>
  <li>Si desexa que este elemento volva a ser visible, prema outra vez
o bot&oacute;n <img
 src="file:///home/droggo/Proyectos/migueloo/migueloo/modules/gettext/gl_GL/help_html/%3C?php"
 echo="" $urlserver/miguel/image/filemanager="" ;="" ?="">/invisible.gif
width=24 height=20&gt; na columna "Visible/invisible".</li>
</ul>
<h4>Se cumpre o prazo de entrega en non desexa que o estudiante cambie
o documento</h4>
<ul>
  <li>Prema o bot&oacute;n <img
 src="file:///home/droggo/Proyectos/migueloo/migueloo/modules/gettext/gl_GL/help_html/Sin_traducir/%3C?php"
 echo="" $urlserver/miguel/image/filemanager="" ;="" ?="">/invisible.gif
width=24 height=20&gt; na columna "Entregado/Non entregado"</li>
</ul>
<h4>Agregar ou modificar un comentario a un traballo (ou a un
directorio)</h4>
<ul>
  <li>Prema o bot&oacute;n <img
 src="file:///home/droggo/Proyectos/migueloo/migueloo/modules/gettext/gl_GL/help_html/%3C?php"
 echo="" $urlserver/miguel/image/filemanager="" ;="" ?="">/comment.gif
width=20
height=20&gt; na columna "Comentario".</li>
  <li>Introduza o novo comentario na zona prevista que aparecer&aacute;
arriba &aacute; esquierda.</li>
  <li>Valide facendo clic en "OK" <input type="submit" value="OK"
 name="submit2"> .</li>
</ul>
<p>Se desexa suprimir un comentario, prema o bot&oacute;n <img
 src="file:///home/droggo/Proyectos/migueloo/migueloo/modules/gettext/gl_GL/help_html/%3C?php"
 echo="" $urlserver/miguel/image/filemanager="" ;="" ?="">/comment.gif
width=20 height=20&gt;, "borra-lo antigo comentario da zona" e valide
facendo clic en "OK" <input type="submit" value="OK" name="submit22">
.</p>
<hr>
<p>Vostede pode tam&eacute;n organiza-lo contido do m&oacute;dulo de
traballos gardando os traballos en directorios. Para facelo vostede
debe:</p>
<h4><b>Crear un directorio</b></h4>
<ul>
  <li>Prema a funci&oacute;n "<img
 src="file:///home/droggo/Proyectos/migueloo/migueloo/modules/gettext/gl_GL/help_html/%3C?php"
 echo="" $urlserver/miguel/image/filemanager="" ;="" ?="">/dossier.gif
width=20
height=20&gt;crear un directorio" arriba &aacute; esquerda da pantalla.</li>
  <li>Introduza o nome do seu novo directorio na zona prevista arriba
&aacute; esquerda da pantalla.</li>
  <li>Valide facendo clic en "OK" <input type="submit" value="OK"
 name="submit23"> .</li>
</ul>
<h4>Desplazar un traballo (ou un directorio)</h4>
<ul>
  <li>Prema o bot&oacute;n <img
 src="file:///home/droggo/Proyectos/migueloo/migueloo/modules/gettext/gl_GL/help_html/%3C?php"
 echo="" $urlserver/miguel/image/filemanager="" ;="" ?="">/deplacer.gif
width=34 height=16&gt; na columna "desplazar".</li>
  <li>Escolla o directorio &oacute; que vostede quere desplaza-lo
traballo ou directorio no men&uacute; de selecci&oacute;n previsto que
aparecer&aacute; arriba &aacute; esquerda. (Nota: a palabra "raiz" en
dito men&uacute; representa a raiz (base) do seu m&oacute;dulo de
traballos).</li>
  <li>Valide facendo clic en "OK" <input type="submit" value="OK"
 name="submit232"> .</li>
</ul>
<center>
<p></p>
</center>
</body>
</html>



From nobody at sheep.berlios.de  Mon Aug 23 17:19:01 2004
From: nobody at sheep.berlios.de (chet)
Date: Mon, 23 Aug 2004 17:19:01 +0200
Subject: [Migueloo-cvs] migueloo/modules/gettext/gl_ES/LC_MESSAGES base_footer.po,NONE,1.1 base_header.po,NONE,1.1 common.po,NONE,1.1 errors.po,NONE,1.1 setup.po,NONE,1.1
Message-ID: <200408231519.i7NFJ1628748@bat.berlios.de>

Update of /cvsroot/migueloo/migueloo/modules/gettext/gl_ES/LC_MESSAGES
In directory sheep:/tmp/cvs-serv25836/gl_ES/LC_MESSAGES

Added Files:
	base_footer.po base_header.po common.po errors.po setup.po 
Log Message:
Traducci?n al gallego (por Manuel Freire)

--- NEW FILE: base_footer.po ---
(This appears to be a binary file; contents omitted.)

--- NEW FILE: base_header.po ---
(This appears to be a binary file; contents omitted.)

--- NEW FILE: common.po ---
(This appears to be a binary file; contents omitted.)

--- NEW FILE: errors.po ---
msgid ""
msgstr ""
"Project-Id-Version: 1\n"
"POT-Creation-Date: 1\n"
"PO-Revision-Date: 2004-08-13 16:40\n"
"Last-Translator: Manuel R. Freire Santos <droggof at yahoo.es>\n"
"Language-Team:  Miguel <Miguel>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=ISO-8859-15\n"
"Content-Transfer-Encoding: 8bit\n"

#: prueba.php:23
msgid "bad referer"
msgstr "Parece que vostede accedeu a esta p?xina deliberadamente ou que est? a usar un navegador web que non "
"nos permite saber se verdadeiramente ocorreu un erro ou non, as? que o erro te?ricamente solicitado ser? "
"amosado pero non constar? no rexistro de erros."
"<br>\nSe verdadeiramente ocorreu un erro, por favor, env?enos (?s desenvolvedores de Miguel) un <a " "href=\"mailto:e-learning-desarrollo at listas.hispalinux.es\">email<\a> explicando a s?a situaci?n de tal xeito que a " "poidamos reproducir e arranxar, ou contacte co administrador."

#: prueba.php:24
msgid "given error code wasn't recognized"
msgstr "Esta ? unha p?xina que mostra erros, pero o c?digo do erro facilitado non foi reco?ecido, as? que non podemos "
"dicirlle o que sucedeu, no suposto de que realmente houbera alg?n problema."
"<br>\nSe este ? o seu caso, por favor, env?enos (?s desenvolvedores de Miguel) un <a " "href=\"mailto:e-learning-desarrollo at listas.hispalinux.es\">email</a> explicando a s?a situaci?n de tal xeito que a " "poidamos reproducir e arranxar, ou contacte co administrador."

#: prueba.php:25
msgid "no error code was given"
msgstr "Esta ? unha p?xina que mostra erros, pero nos se facilitou ning?n c?digo de erro, as? que non podemos "
"decirlle o que sucedeu, no suposto de que realmente houbera alg?n problema."
"Por favor, env?enos (?s desenvolvedores de Miguel) un <a "
"href=\"mailto:e-learning-desarrollo at listas.hispalinux.es\">email</a> explicando a s?a situaci?n de tal xeito que a "
"poidamos reproducir e arranxar, ou contacte co administrador."

#: prueba.php:26
msgid "unable to connect to the db"
msgstr "? ATENCI?N ! O SISTEMA NON PUIDO CONECTAR CO SERVIDOR DA BASE DE DATOS "
"<br>\nSe se trata do primeiro uso, lea INSTALL.es.txt e despois vaia ? asistente web de instalaci?n"

#: prueba.php:27
msgid "unable to select the main miguel db"
msgstr "? ATENCI?N ! O SISTEMA NON PUIDO SELECCIONAR O SERVIDOR DA BASE DE DATOS "
"<br>\nSe se trata do primeiro uso, lea INSTALL.es.txt e despois vaia ? asistente web de instalaci?n"

#: prueba.php:28
msgid "someone not allowed to see the content of the page"
msgstr "? ATENCI?N ! Vostede non ten permiso para ve-la p?xina solicitada. Por favor, acceda c?s permisos "
"axeitados."

#: prueba.php:29
msgid "a requested file couldn't be read"
msgstr "? ATENCI?N ! O arquivo solicitado non puido ser lido. <br>\nPor favor, env?enos (?s desenvolvedores de "
"Miguel) un <a href=\"mailto:e-learning-desarrollo at listas.hispalinux.es\">email</a> explicando a s?a situaci?n de tal " "xeito que a podamos reproducir e arranxar."

#: prueba.php:30
msgid "session lost in a course"
msgstr "? ATENCI?N ! Cerrouse a s?a sesi?n, por favor volva ? p?xina principal do curso e actualice a pantalla."

#: prueba.php:31
msgid "cours doesn't exist"
msgstr "? ATENCI?N ! Este curso non existe."

#: prueba.php:32
msgid "config file couldn't be included"
msgstr "? ATENCI?N ! O arquivo de configuraci?n non puido ser lido. Contacte co administrador, ou se Vd. ? o "
"administrador, ou ben reinstale miguel, restaure o ficheiro de configuraci?n ou delle os permisos adecuados"


--- NEW FILE: setup.po ---
(This appears to be a binary file; contents omitted.)



